addpath('/home/mrstats/andmar/sfw/gpml/gpml-matlab-v3.5'); startup;

X = [ 2.08397042775073, -0.821018066101379, -0.617870699182597, ...
     -1.18382260886069, 0.274087442277144,  0.599441729295593, ...
     1.76889791920444, -0.465645549031928, 0.588852784375935, ...
     -0.832982214438054, -0.512106527960363, 0.277883144210116, ...
     -0.0658704269222113, -0.821412363806325, 0.185399443778088, ...
     -0.858296174995998, 0.370786630037059, -1.40986916241664, ...
     -0.144668412325022, -0.553299615220374]';
 
y = [4.54920374633170, 0.371985574437271, 0.711307965514790, ...
    -0.0132128936184299, 2.25547325533819, 1.00991574929573, ...
    3.74467593796503, 0.424592771793202, 1.32283365229581, ...
    0.278298293510020, 0.267229130945574, 2.20011228672383, ...
    1.20060998330897, 0.439971697236094, 2.62858043351126, ...
    0.503774817336353, 1.94252531382056, 0.579133950013327,...
    0.670874423968554, 0.377353755100965]';

X = [X ones(size(X,1),1) (1:size(X,1))'];

%y = y-mean(y);

inffunc  = @infExact;
%meanfunc = @meanConst;    hyp0.mean = 0;
meanfunc = @meanZero;     hyp0.mean = [];
likfunc  = @likGauss;     hyp0.lik  = 0;%-0.6428;%0;
%covfunc  = @covSEiso;     hyp0.cov  = zeros(2,1);%[1.196, 1.2764,]';%zeros(2,1);
covfunc  = @covSEard;     hyp0.cov  = zeros(size(X,2)+1,1);%[1.196, 1.2764,]';%zeros(2,1);

hyp = hyp0;

[hyp,nlmls] = minimize(hyp0, @gp, 100, inffunc, meanfunc, covfunc, likfunc, X, y);
[nlml, dnlml, post] = gp(hyp,inffunc,meanfunc,covfunc,likfunc, X, y)
%[yhat, s2] = gp(hyp,inffunc,meanfunc,covfunc,likfunc, Xtr, y, Xte, zeros(Ns,1));
        