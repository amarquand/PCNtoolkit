<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module Index &mdash; Predictive Clinical Neuroscience Toolkit 0.20 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/pages/css/pcntoolkit_tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/pages/css/pcntoolkit.css" type="text/css" />
      <link rel="stylesheet" href="_static/pages/css/pcntoolkit_nomaxwidth.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Gaussian Process Regression" href="pages/normative_modelling_walkthrough.html" />
    <link rel="prev" title="PCNtoolkit Background" href="pages/pcntoolkit_background.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/pcn-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pages/installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pages/pcntoolkit_background.html">PCNtoolkit Background</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Function &amp; Class Docs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Module Index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pages/normative_modelling_walkthrough.html">Gaussian Process Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/HBR_NormativeModel_FCONdata_Tutorial.html">Hierarchical Bayesian Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/apply_normative_models.html">Braincharts: transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/BLR_normativemodel_protocol.html">Bayesian Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/visualizations.html">Visualization of normative modeling outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/post_hoc_analysis.html">Post-hoc analysis on normative modeling outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/other_predictive_models.html">Predictive modeling using deviation scores</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Useful Stuff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pages/FAQs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/citing.html">How to cite PCNtoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Predictive Clinical Neuroscience Toolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Module Index</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/modindex.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-bayesreg">
<span id="module-index"></span><h1>Module Index<a class="headerlink" href="#module-bayesreg" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="bayesreg.BLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayesreg.</span></span><span class="sig-name descname"><span class="pre">BLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bayesian linear regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>B = BLR()
hyp = B.estimate(hyp0, X, y)
ys,s2 = B.predict(hyp, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = ( log(beta), log(alpha) )  # hyp is a list or numpy array
</pre></div>
</div>
<p>The implementation and notation mostly follows Bishop (2006).
The hyperparameter beta is the noise precision and alpha is the precision
over lengthscale parameters. This can be either a scalar variable (a
common lengthscale for all input variables), or a vector of length D (a
different lengthscale for each input variable, derived using an automatic
relevance determination formulation). These are estimated using conjugate
gradient optimisation of the marginal likelihood.</p>
<p>Reference:
Bishop (2006) Pattern Recognition and Machine Learning, Springer</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.dloglik">
<span class="sig-name descname"><span class="pre">dloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.dloglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.dloglik" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Function to estimate the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates</p></li>
<li><p><strong>y</strong> – responses</p></li>
<li><p><strong>optimizer</strong> – optimisation algorithm (‘cg’,’powell’,’nelder-mead’,’l0bfgs-b’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.loglik">
<span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.loglik" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.penalized_loglik">
<span class="sig-name descname"><span class="pre">penalized_loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L1'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.penalized_loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.penalized_loglik" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute the penalized log (marginal) likelihood</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates</p></li>
<li><p><strong>y</strong> – responses</p></li>
<li><p><strong>Xv</strong> – covariates for heteroskedastic noise</p></li>
<li><p><strong>l</strong> – regularisation penalty</p></li>
<li><p><strong>norm</strong> – type of regulariser (L1 or L2)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.post" title="Permalink to this definition"></a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma_a) and precision (Lambda_a).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates</p></li>
<li><p><strong>y</strong> – responses</p></li>
<li><p><strong>Xv</strong> – covariates for heteroskedastic noise</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_groups_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_covariates_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.predict" title="Permalink to this definition"></a></dt>
<dd><p>Function to make predictions from the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates for training data</p></li>
<li><p><strong>y</strong> – responses for training data</p></li>
<li><p><strong>Xs</strong> – covariates for test data</p></li>
<li><p><strong>var_covariates_test</strong> – test covariates for heteroskedastic noise</p></li>
</ul>
</dd>
</dl>
<p>This always returns Gaussian predictions, i.e.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.predict_and_adjust">
<span class="sig-name descname"><span class="pre">predict_and_adjust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_groups_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_groups_adapt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.predict_and_adjust"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.predict_and_adjust" title="Permalink to this definition"></a></dt>
<dd><p>Function to transfer the model to a new site. This is done by
first making predictions on the adaptation data given by X,
adjusting by the residuals with respect to y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates for adaptation (i.e. calibration) data</p></li>
<li><p><strong>y</strong> – responses for adaptation data</p></li>
<li><p><strong>Xs</strong> – covariate data (for which predictions should be adjusted)</p></li>
<li><p><strong>ys</strong> – true response variables (to be adjusted)</p></li>
<li><p><strong>var_groups_test</strong> – variance groups (e.g. sites) for test data</p></li>
<li><p><strong>var_groups_adapt</strong> – variance groups for adaptation data</p></li>
</ul>
</dd>
</dl>
<p>There are two possible ways of using this function, depending on
whether ys or Xs is specified</p>
<p>If ys is specified, this is applied directly to the data, which is
assumed to be in the input space (i.e. not warped). In this case
the adjusted true data points are returned in the same space</p>
<p>Alternatively, Xs is specified, then the predictions are made and
adjusted. In this case the predictive variance are returned in the
warped (i.e. Gaussian) space.</p>
<p>This function needs to know which sites are associated with which
data points, which provided by var_groups_xxx, which is a list or
array of scalar ids .</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-gp"></span><dl class="py class">
<dt class="sig sig-object py" id="gp.CovBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for covariance functions.</p>
<p>All covariance functions must define the following methods:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CovFunction.get_n_params()
CovFunction.cov()
CovFunction.xcov()
CovFunction.dcov()
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovBase.cov">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase.cov" title="Permalink to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovBase.dcov">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase.dcov" title="Permalink to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovBase.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.get_n_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase.get_n_params" title="Permalink to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovLin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovLin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovLin" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Linear covariance function (no hyperparameters)</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovLin.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovLin.cov" title="Permalink to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovLin.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovLin.dcov" title="Permalink to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovLin.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovLin.get_n_params" title="Permalink to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovSqExp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovSqExp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExp" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Ordinary squared exponential covariance function.
The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = ( log(ell), log(sf) )
</pre></div>
</div>
<p>where ell is a lengthscale parameter and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExp.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExp.cov" title="Permalink to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExp.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExp.dcov" title="Permalink to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExp.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExp.get_n_params" title="Permalink to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovSqExpARD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovSqExpARD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExpARD" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Squared exponential covariance function with ARD
The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = (log(ell_1, ..., log_ell_D), log(sf))
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExpARD.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExpARD.cov" title="Permalink to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExpARD.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExpARD.dcov" title="Permalink to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExpARD.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExpARD.get_n_params" title="Permalink to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovSum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovSum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfuncnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSum" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Sum of covariance functions. These are passed in as a cell array and
intialised automatically. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C = CovSum(x,(CovLin, CovSqExpARD))
C = CovSum.cov(x, )
</pre></div>
</div>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = ( log(ell_1, ..., log_ell_D), log(sf2) )
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSum.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSum.cov" title="Permalink to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSum.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSum.dcov" title="Permalink to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSum.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSum.get_n_params" title="Permalink to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.GPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">GPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gaussian process regression</p>
<p>Estimation and prediction of Gaussian process regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>G = GPR()
hyp = B.estimate(hyp0, cov, X, y)
ys, ys2 = B.predict(hyp, cov, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters</p></li>
<li><p><strong>cov</strong> – covariance function</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = ( log(sn), (cov function params) )  # hyp is a list or array
</pre></div>
</div>
<p>The implementation and notation  follows Rasmussen and Williams (2006).
As in the gpml toolbox, these parameters are estimated using conjugate
gradient optimisation of the marginal likelihood. Note that there is no
explicit mean function, thus the gpr routines are limited to modelling
zero-mean processes.</p>
<p>Reference:
C. Rasmussen and C. Williams (2006) Gaussian Processes for Machine Learning</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.dloglik">
<span class="sig-name descname"><span class="pre">dloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.dloglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.dloglik" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cg'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.loglik">
<span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.loglik" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.post" title="Permalink to this definition"></a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.predict" title="Permalink to this definition"></a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-normative"></span><dl class="py function">
<dt class="sig sig-object py" id="normative.estimate">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Estimate a normative model</p>
<p>This will estimate a model in one of two settings according to
theparticular parameters specified (see below)</p>
<ul class="simple">
<li><p>under k-fold cross-validation.
requires respfile, covfile and cvfolds&gt;=2</p></li>
<li><p>estimating a training dataset then applying to a second test dataset.
requires respfile, covfile, testcov and testresp.</p></li>
<li><p>estimating on a training dataset ouput of forward maps mean and se.
requires respfile, covfile and testcov</p></li>
</ul>
<p>The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (nifti or cifti). Ascii data should be in
tab or space delimited format with the number of subjects in rows and the
number of variables in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>estimate(covfile, respfile, [extra_arguments])
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>respfile</strong> – response variables for the normative model</p></li>
<li><p><strong>covfile</strong> – covariates used to predict the response variable</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>cvfolds</strong> – Number of cross-validation folds</p></li>
<li><p><strong>testcov</strong> – Test covariates</p></li>
<li><p><strong>testresp</strong> – Test responses</p></li>
<li><p><strong>alg</strong> – Algorithm for normative model</p></li>
<li><p><strong>configparam</strong> – Parameters controlling the estimation algorithm</p></li>
<li><p><strong>saveoutput</strong> – Save the output to disk? Otherwise returned as arrays</p></li>
<li><p><strong>outputsuffix</strong> – Text string to add to the output filenames</p></li>
<li><p><strong>inscale</strong> – Scaling approach for input covariates, could be ‘None’ (Default),
‘standardize’, ‘minmax’, or ‘robminmax’.</p></li>
<li><p><strong>outscale</strong> – Scaling approach for output responses, could be ‘None’ (Default),
‘standardize’, ‘minmax’, or ‘robminmax’.</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>yhat - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
<li><p>nm - normative model</p></li>
<li><p>Z - deviance scores</p></li>
<li><p>Rho - Pearson correlation between true and predicted responses</p></li>
<li><p>pRho - parametric p-value for this correlation</p></li>
<li><p>rmse - root mean squared error between true/predicted responses</p></li>
<li><p>smse - standardised mean squared error</p></li>
</ul>
</dd>
</dl>
<p>The outputsuffix may be useful to estimate multiple normative models in the
same directory (e.g. for custom cross-validation schemes)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.evaluate">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Yhat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlZ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xz_tr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Rho',</span> <span class="pre">'RMSE',</span> <span class="pre">'SMSE',</span> <span class="pre">'EXPV',</span> <span class="pre">'MSLL']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Compute error metrics
This function will compute error metrics based on a set of predictions Yhat
and a set of true response variables Y, namely:</p>
<ul class="simple">
<li><p>Rho: Pearson correlation</p></li>
<li><p>RMSE: root mean squared error</p></li>
<li><p>SMSE: standardized mean squared error</p></li>
<li><p>EXPV: explained variance</p></li>
</ul>
<p>If the predictive variance is also specified the log loss will be computed
(which also takes into account the predictive variance). If the mean and
standard deviation are also specified these will be used to standardize
this, yielding the mean standardized log loss</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y</strong> – N x P array of true response variables</p></li>
<li><p><strong>Yhat</strong> – N x P array of predicted response variables</p></li>
<li><p><strong>S2</strong> – predictive variance</p></li>
<li><p><strong>mY</strong> – mean of the training set</p></li>
<li><p><strong>sY</strong> – standard deviation of the training set</p></li>
</ul>
</dd>
<dt class="field-even">Returns metrics</dt>
<dd class="field-even"><p>evaluation metrics</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.extend">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#extend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.extend" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.fit">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.get_args">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.get_args" title="Permalink to this definition"></a></dt>
<dd><p>Parse command line arguments</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.load_response_vars">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">load_response_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#load_response_vars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.load_response_vars" title="Permalink to this definition"></a></dt>
<dd><p>load response variables (of any data type)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.main">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.main" title="Permalink to this definition"></a></dt>
<dd><p>Parse arguments and estimate model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.predict">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.predict" title="Permalink to this definition"></a></dt>
<dd><p>Make predictions on the basis of a pre-estimated normative model
If only the covariates are specified then only predicted mean and variance
will be returned. If the test responses are also specified then quantities
That depend on those will also be returned (Z scores and error metrics)</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>predict(covfile, [extra_arguments])
</pre></div>
</div>
<p>where the variables are defined below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covfile</strong> – test covariates used to predict the response variable</p></li>
<li><p><strong>respfile</strong> – test response variables for the normative model</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>model_path</strong> – Directory containing the normative model and metadata.
When using parallel prediction, do not pass the model path. It will be
automatically decided.</p></li>
<li><p><strong>outputsuffix</strong> – Text string to add to the output filenames</p></li>
<li><p><strong>batch_size</strong> – batch size (for use with normative_parallel)</p></li>
<li><p><strong>job_id</strong> – batch id</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>Yhat - predictive mean</p></li>
<li><p>S2 - predictive variance</p></li>
<li><p>Z - Z scores</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.save_results">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Yhat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskvol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputsuffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.save_results" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.transfer">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">transfer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testresp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#transfer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.transfer" title="Permalink to this definition"></a></dt>
<dd><p>Transfer learning on the basis of a pre-estimated normative model by using
the posterior distribution over the parameters as an informed prior for
new data. currently only supported for HBR.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>transfer(covfile, respfile [extra_arguments])
</pre></div>
</div>
<p>where the variables are defined below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covfile</strong> – test covariates used to predict the response variable</p></li>
<li><p><strong>respfile</strong> – test response variables for the normative model</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>testcov</strong> – Test covariates</p></li>
<li><p><strong>testresp</strong> – Test responses</p></li>
<li><p><strong>model_path</strong> – Directory containing the normative model and metadata</p></li>
<li><p><strong>trbefile</strong> – Training batch effects file</p></li>
<li><p><strong>batch_size</strong> – batch size (for use with normative_parallel)</p></li>
<li><p><strong>job_id</strong> – batch id</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>Yhat - predictive mean</p></li>
<li><p>S2 - predictive variance</p></li>
<li><p>Z - Z scores</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-normative_parallel"></span><dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.bashwrap_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">bashwrap_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normative_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#bashwrap_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.bashwrap_nm" title="Permalink to this definition"></a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>bashwrap_nm(processing_dir, python_path, normative_path, job_name, covfile_path, respfile_path)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>python_path</strong> – Full path to the python distribution</p></li>
<li><p><strong>normative_path</strong> – Full path to the normative.py</p></li>
<li><p><strong>job_name</strong> – Name for the bash script that is the output of this function</p></li>
<li><p><strong>covfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the responsefile</p></li>
<li><p><strong>respfile_path</strong> – Full path to a .txt that contains all features (subjects x features)</p></li>
<li><p><strong>cv_folds</strong> – Number of cross validations</p></li>
<li><p><strong>testcovfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the testresponse file</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to a .txt file that contains all test features</p></li>
<li><p><strong>alg</strong> – which algorithm to use</p></li>
<li><p><strong>configparam</strong> – configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><p>A bash.sh file containing the commands for normative modelling saved to the processing directory (written to disk).</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.collect_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">collect_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputsuffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_estimate'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#collect_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.collect_nm" title="Permalink to this definition"></a></dt>
<dd><p>Function to checks and collects all batches.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>collect_nm(processing_dir, job_name)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing directory</p></li>
<li><p><strong>collect</strong> – If True data is checked for failed batches and collected; if False data is just checked</p></li>
<li><p><strong>binary</strong> – Results in pkl format</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><p>Text files containing all results accross all batches the combined output (written to disk).</p>
</dd>
<dt class="field-odd">Returns 0</dt>
<dd class="field-odd"><p>if batches fail</p>
</dd>
<dt class="field-even">Returns 1</dt>
<dd class="field-even"><p>if bathches complete successfully</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.delete_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">delete_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#delete_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.delete_nm" title="Permalink to this definition"></a></dt>
<dd><p>This function deletes all processing for normative modelling and just keeps the combined output.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>collect_nm(processing_dir)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing directory.</p></li>
<li><p><strong>binary</strong> – Results in pkl format.</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.execute_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">execute_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normative_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#execute_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.execute_nm" title="Permalink to this definition"></a></dt>
<dd><p>Execute parallel normative models
This function is a mother function that executes all parallel normative
modelling routines. Different specifications are possible using the sub-
functions.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>execute_nm(processing_dir, python_path, job_name, covfile_path, respfile_path, batch_size, memory, duration)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>python_path</strong> – Full path to the python distribution</p></li>
<li><p><strong>normative_path</strong> – Full path to the normative.py. If None (default) then it will automatically retrieves the path from the installed packeage.</p></li>
<li><p><strong>job_name</strong> – Name for the bash script that is the output of this function</p></li>
<li><p><strong>covfile_path</strong> – Full path to a .txt file that contains all covariats (subjects x covariates) for the responsefile</p></li>
<li><p><strong>respfile_path</strong> – Full path to a .txt that contains all features (subjects x features)</p></li>
<li><p><strong>batch_size</strong> – Number of features in each batch</p></li>
<li><p><strong>memory</strong> – Memory requirements written as string for example 4gb or 500mb</p></li>
<li><p><strong>duation</strong> – The approximate duration of the job, a string with HH:MM:SS for example 01:01:01</p></li>
<li><p><strong>cv_folds</strong> – Number of cross validations</p></li>
<li><p><strong>testcovfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the test response file</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to a .txt file that contains all test features</p></li>
<li><p><strong>log_path</strong> – Path for saving log files</p></li>
<li><p><strong>binary</strong> – If True uses binary format for response file otherwise it is text</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.qsub_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">qsub_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#qsub_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.qsub_nm" title="Permalink to this definition"></a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub command.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>qsub_nm(job_path, log_path, memory, duration)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>job_path</strong> – Full path to the job.sh file.</p></li>
<li><p><strong>memory</strong> – Memory requirements written as string for example 4gb or 500mb.</p></li>
<li><p><strong>duation</strong> – The approximate duration of the job, a string with HH:MM:SS for example 01:01:01.</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><p>Submission of the job to the (torque) cluster.</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.rerun_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">rerun_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#rerun_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.rerun_nm" title="Permalink to this definition"></a></dt>
<dd><p>This function reruns all failed batched in processing_dir after collect_nm has identified he failed batches.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rerun_nm(processing_dir, memory, duration)
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing directory.</p></li>
<li><p><strong>memory</strong> – Memory requirements written as string, for example 4gb or 500mb.</p></li>
<li><p><strong>duration</strong> – The approximate duration of the job, a string with HH:MM:SS for example 01:01:01.</p></li>
<li><p><strong>new_memory</strong> – If you want to change the memory you have to indicate it here.</p></li>
<li><p><strong>new_duration</strong> – If you want to change the duration you have to indicate it here.</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><p>Re-runs failed batches.</p>
<p>written by (primarily) T Wolfers, (adapted) S Rutherford.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.sbatch_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">sbatch_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#sbatch_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.sbatch_nm" title="Permalink to this definition"></a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sbatch_nm(job_path, log_path)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>job_path</strong> – Full path to the job.sh file</p></li>
<li><p><strong>log_path</strong> – The logs are currently stored in the working dir</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><p>Submission of the job to the (torque) cluster.</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.sbatchwrap_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">sbatchwrap_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normative_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#sbatchwrap_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.sbatchwrap_nm" title="Permalink to this definition"></a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sbatchwrap_nm(processing_dir, python_path, normative_path, job_name, covfile_path, respfile_path, memory, duration)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>python_path</strong> – Full path to the python distribution</p></li>
<li><p><strong>normative_path</strong> – Full path to the normative.py</p></li>
<li><p><strong>job_name</strong> – Name for the bash script that is the output of this function</p></li>
<li><p><strong>covfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the responsefile</p></li>
<li><p><strong>respfile_path</strong> – Full path to a .txt that contains all features (subjects x features)</p></li>
<li><p><strong>cv_folds</strong> – Number of cross validations</p></li>
<li><p><strong>testcovfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the testresponse file</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to a .txt file that contains all test features</p></li>
<li><p><strong>alg</strong> – which algorithm to use</p></li>
<li><p><strong>configparam</strong> – configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><p>A bash.sh file containing the commands for normative modelling saved to the processing directory (written to disk).</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) S Rutherford</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.split_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">split_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#split_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.split_nm" title="Permalink to this definition"></a></dt>
<dd><p>This function prepares the input files for normative_parallel.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>split_nm(processing_dir, respfile_path, batch_size, binary, testrespfile_path)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>respfile_path</strong> – Full path to the responsefile.txt (subjects x features)</p></li>
<li><p><strong>batch_size</strong> – Number of features in each batch</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to the test responsefile.txt (subjects x features)</p></li>
<li><p><strong>binary</strong> – If True binary file</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><p>The creation of a folder struture for batch-wise processing.</p>
</dd>
</dl>
<p>witten by (primarily) T Wolfers (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<span class="target" id="module-trendsurf"></span><dl class="py function">
<dt class="sig sig-object py" id="trendsurf.create_basis">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">create_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#create_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.create_basis" title="Permalink to this definition"></a></dt>
<dd><p>Create a (polynomial) basis set</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.estimate">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveoutput</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Estimate a trend surface model</p>
<p>This will estimate a trend surface model, independently for each subject.
This is currently fit using a polynomial model of a specified degree.
The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (currently nifti only). Ascii data should be in
tab or space delimited format with the number of voxels in rows and the
number of subjects in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>estimate(filename, maskfile, basis)
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – 4-d nifti file containing the images to be estimated</p></li>
<li><p><strong>maskfile</strong> – nifti mask used to apply to the data</p></li>
<li><p><strong>basis</strong> – model order for the interpolating polynomial</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>yhat - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
<li><p>trendcoeff - coefficients from the trend surface model</p></li>
<li><p>negloglik - Negative log marginal likelihood</p></li>
<li><p>hyp - hyperparameters</p></li>
<li><p>explainedvar - explained variance</p></li>
<li><p>rmse - standardised mean squared error</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.get_args">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.get_args" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.load_data">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.load_data" title="Permalink to this definition"></a></dt>
<dd><p>load 4d nifti data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.main">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.write_nii">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">write_nii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">examplenii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#write_nii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.write_nii" title="Permalink to this definition"></a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<span class="target" id="module-rfa"></span><dl class="py class">
<dt class="sig sig-object py" id="rfa.GPRRFA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rfa.</span></span><span class="sig-name descname"><span class="pre">GPRRFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Random Feature Approximation for Gaussian Process Regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>R = GPRRFA()
hyp = R.estimate(hyp0, X, y)
ys,s2 = R.predict(hyp, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = [ log(sn), log(ell), log(sf) ]  # hyp is a numpy array
</pre></div>
</div>
<p>where sn^2 is the noise variance, ell are lengthscale parameters and
sf^2 is the signal variance. This provides an approximation to the
covariance function:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>k(x,z) = x&#39;*z + sn2*exp(0.5*(x-z)&#39;*Lambda*(x-z))
</pre></div>
</div>
<p>where Lambda = diag((ell_1^2, … ell_D^2))</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.dloglik">
<span class="sig-name descname"><span class="pre">dloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.dloglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.dloglik" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lbfgs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.get_n_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.get_n_params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.loglik">
<span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.loglik" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.post" title="Permalink to this definition"></a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma) and precision (iSigma).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.predict" title="Permalink to this definition"></a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-fileio"></span><dl class="py function">
<dt class="sig sig-object py" id="fileio.alphanum_key">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">alphanum_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#alphanum_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.alphanum_key" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.create_mask">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">create_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#create_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.create_mask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.file_extension">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">file_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_extension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.file_extension" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.file_stem">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">file_stem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_stem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.file_stem" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.file_type">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">file_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.file_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_ascii">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_ascii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_ascii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_ascii" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_cifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_cifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmtmp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_cifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_cifti" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_nifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_nifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_nifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_nifti" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_pd">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_pd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_pd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.predictive_interval">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">predictive_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s2_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#predictive_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.predictive_interval" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_ascii">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_ascii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_ascii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_ascii" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_cifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_cifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volatlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_cifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_cifti" title="Permalink to this definition"></a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_nifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_nifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">examplenii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_nifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_nifti" title="Permalink to this definition"></a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_pd">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_pd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_pd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.sort_nicely">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">sort_nicely</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#sort_nicely"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.sort_nicely" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.tryint">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">tryint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#tryint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.tryint" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.vol2vec">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">vol2vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#vol2vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.vol2vec" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<span class="target" id="module-util"></span></div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pages/pcntoolkit_background.html" class="btn btn-neutral float-left" title="PCNtoolkit Background" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pages/normative_modelling_walkthrough.html" class="btn btn-neutral float-right" title="Gaussian Process Regression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Andre F. Marquand.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>