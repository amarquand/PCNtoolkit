

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Module Index &#8212; Spatial methods for neuroimaging 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Spatial methods for neuroimaging" href="index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Spatial methods for neuroimaging"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Spatial methods for neuroimaging 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Spatial methods for neuroimaging</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/modindex.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-bayesreg">
<span id="module-index"></span><h1>Module Index<a class="headerlink" href="#module-bayesreg" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="bayesreg.BLR">
<em class="property">class </em><code class="descclassname">bayesreg.</code><code class="descname">BLR</code><span class="sig-paren">(</span><em>hyp=None</em>, <em>X=None</em>, <em>y=None</em>, <em>n_iter=1000</em>, <em>tol=0.001</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Bayesian linear regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">BLR</span><span class="p">()</span>
<span class="n">hyp</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">hyp0</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ys</span><span class="p">,</span><span class="n">s2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">hyp</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Xs</span><span class="p">)</span>
</pre></div>
</div>
<p>where the variables are</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hyp</strong> &#8211; vector of hyperparmaters.</li>
<li><strong>X</strong> &#8211; N x D data array</li>
<li><strong>y</strong> &#8211; 1D Array of targets (length N)</li>
<li><strong>Xs</strong> &#8211; Nte x D array of test cases</li>
<li><strong>hyp0</strong> &#8211; starting estimates for hyperparameter optimisation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>ys - predictive mean</li>
<li>s2 - predictive variance</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p>The hyperparameters are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">hyp</span> <span class="o">=</span> <span class="p">(</span> <span class="n">log</span><span class="p">(</span><span class="n">beta</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="p">)</span>  <span class="c1"># hyp is a list or numpy array</span>
</pre></div>
</div>
<p>The implementation and notation mostly follows Bishop (2006).
The hyperparameter beta is the noise precision and alpha is the precision
over lengthscale parameters. This can be either a scalar variable (a
common lengthscale for all input variables), or a vector of length D (a
different lengthscale for each input variable, derived using an automatic
relevance determination formulation). These are estimated using conjugate
gradient optimisation of the marginal likelihood.</p>
<p>Reference:
Bishop (2006) Pattern Recognition and Machine Learning, Springer</p>
<p>Written by A. Marquand</p>
<dl class="method">
<dt id="bayesreg.BLR.dloglik">
<code class="descname">dloglik</code><span class="sig-paren">(</span><em>hyp</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.dloglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="method">
<dt id="bayesreg.BLR.estimate">
<code class="descname">estimate</code><span class="sig-paren">(</span><em>hyp0</em>, <em>X</em>, <em>y</em>, <em>optimizer='cg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="method">
<dt id="bayesreg.BLR.loglik">
<code class="descname">loglik</code><span class="sig-paren">(</span><em>hyp</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.loglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="method">
<dt id="bayesreg.BLR.post">
<code class="descname">post</code><span class="sig-paren">(</span><em>hyp</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma) and precision (iSigma).</p>
</dd></dl>

<dl class="method">
<dt id="bayesreg.BLR.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>hyp</em>, <em>X</em>, <em>y</em>, <em>Xs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-gp"></span><dl class="class">
<dt id="gp.CovBase">
<em class="property">class </em><code class="descclassname">gp.</code><code class="descname">CovBase</code><span class="sig-paren">(</span><em>x=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base class for covariance functions.</p>
<p>All covariance functions must define the following methods:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CovFunction</span><span class="o">.</span><span class="n">get_n_params</span><span class="p">()</span>
<span class="n">CovFunction</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
<span class="n">CovFunction</span><span class="o">.</span><span class="n">xcov</span><span class="p">()</span>
<span class="n">CovFunction</span><span class="o">.</span><span class="n">dcov</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="gp.CovBase.cov">
<code class="descname">cov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovBase.dcov">
<code class="descname">dcov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovBase.get_n_params">
<code class="descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.get_n_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.CovLin">
<em class="property">class </em><code class="descclassname">gp.</code><code class="descname">CovLin</code><span class="sig-paren">(</span><em>x=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovLin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal"><span class="pre">gp.CovBase</span></code></a></p>
<p>Linear covariance function (no hyperparameters)</p>
<dl class="method">
<dt id="gp.CovLin.cov">
<code class="descname">cov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovLin.cov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gp.CovLin.dcov">
<code class="descname">dcov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovLin.dcov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gp.CovLin.get_n_params">
<code class="descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovLin.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.CovSqExp">
<em class="property">class </em><code class="descclassname">gp.</code><code class="descname">CovSqExp</code><span class="sig-paren">(</span><em>x=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal"><span class="pre">gp.CovBase</span></code></a></p>
<p>Ordinary squared exponential covariance function.
The hyperparameters are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="p">(</span> <span class="n">log</span><span class="p">(</span><span class="n">ell</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">sf2</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>where ell is a lengthscale parameter and sf2 is the signal variance</p>
<dl class="method">
<dt id="gp.CovSqExp.cov">
<code class="descname">cov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExp.cov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gp.CovSqExp.dcov">
<code class="descname">dcov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExp.dcov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gp.CovSqExp.get_n_params">
<code class="descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExp.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.CovSqExpARD">
<em class="property">class </em><code class="descclassname">gp.</code><code class="descname">CovSqExpARD</code><span class="sig-paren">(</span><em>x=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExpARD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal"><span class="pre">gp.CovBase</span></code></a></p>
<p>Squared exponential covariance function with ARD
The hyperparameters are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">ell_1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">log_ell_D</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">sf2</span><span class="p">))</span>
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="method">
<dt id="gp.CovSqExpARD.cov">
<code class="descname">cov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExpARD.cov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gp.CovSqExpARD.dcov">
<code class="descname">dcov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExpARD.dcov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gp.CovSqExpARD.get_n_params">
<code class="descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExpARD.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.CovSum">
<em class="property">class </em><code class="descclassname">gp.</code><code class="descname">CovSum</code><span class="sig-paren">(</span><em>x=None</em>, <em>covfuncnames=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal"><span class="pre">gp.CovBase</span></code></a></p>
<p>Sum of covariance functions. These are passed in as a cell array and
intialised automatically. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">CovSum</span><span class="p">(</span><span class="n">x</span><span class="p">,(</span><span class="n">CovLin</span><span class="p">,</span> <span class="n">CovSqExpARD</span><span class="p">))</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">CovSum</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
<p>The hyperparameters are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="p">(</span> <span class="n">log</span><span class="p">(</span><span class="n">ell_1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">log_ell_D</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">sf2</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="method">
<dt id="gp.CovSum.cov">
<code class="descname">cov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSum.cov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gp.CovSum.dcov">
<code class="descname">dcov</code><span class="sig-paren">(</span><em>theta</em>, <em>x</em>, <em>i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSum.dcov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gp.CovSum.get_n_params">
<code class="descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSum.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.GPR">
<em class="property">class </em><code class="descclassname">gp.</code><code class="descname">GPR</code><span class="sig-paren">(</span><em>hyp=None</em>, <em>covfunc=None</em>, <em>X=None</em>, <em>y=None</em>, <em>n_iter=1000</em>, <em>tol=0.001</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Gaussian process regression</p>
<p>Estimation and prediction of Gaussian process regression models</p>
<p>Basic usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">GPR</span><span class="p">()</span>
<span class="n">hyp</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">hyp0</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ys</span><span class="p">,</span> <span class="n">ys2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">hyp</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Xs</span><span class="p">)</span>
</pre></div>
</div>
<p>where the variables are</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hyp</strong> &#8211; vector of hyperparmaters</li>
<li><strong>cov</strong> &#8211; covariance function</li>
<li><strong>X</strong> &#8211; N x D data array</li>
<li><strong>y</strong> &#8211; 1D Array of targets (length N)</li>
<li><strong>Xs</strong> &#8211; Nte x D array of test cases</li>
<li><strong>hyp0</strong> &#8211; starting estimates for hyperparameter optimisation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>ys - predictive mean</li>
<li>ys2 - predictive variance</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p>The hyperparameters are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">hyp</span> <span class="o">=</span> <span class="p">(</span> <span class="n">log</span><span class="p">(</span><span class="n">sn2</span><span class="p">),</span> <span class="p">(</span><span class="n">cov</span> <span class="n">function</span> <span class="n">params</span><span class="p">)</span> <span class="p">)</span>  <span class="c1"># hyp is a list or array</span>
</pre></div>
</div>
<p>The implementation and notation  follows Rasmussen and Williams (2006).
As in the gpml toolbox, these parameters are estimated using conjugate
gradient optimisation of the marginal likelihood. Note that there is no
explicit mean function, thus the gpr routines are limited to modelling
zero-mean processes.</p>
<p>Reference:
C. Rasmussen and C. Williams (2006) Gaussian Processes for Machine Learning</p>
<p>Written by A. Marquand</p>
<dl class="method">
<dt id="gp.GPR.dloglik">
<code class="descname">dloglik</code><span class="sig-paren">(</span><em>hyp</em>, <em>covfunc</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.dloglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="method">
<dt id="gp.GPR.estimate">
<code class="descname">estimate</code><span class="sig-paren">(</span><em>hyp0</em>, <em>covfunc</em>, <em>X</em>, <em>y</em>, <em>optimizer='cg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="method">
<dt id="gp.GPR.loglik">
<code class="descname">loglik</code><span class="sig-paren">(</span><em>hyp</em>, <em>covfunc</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.loglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="method">
<dt id="gp.GPR.post">
<code class="descname">post</code><span class="sig-paren">(</span><em>hyp</em>, <em>covfunc</em>, <em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
</dd></dl>

<dl class="method">
<dt id="gp.GPR.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>hyp</em>, <em>X</em>, <em>y</em>, <em>Xs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-normative"></span><dl class="function">
<dt id="normative.estimate">
<code class="descclassname">normative.</code><code class="descname">estimate</code><span class="sig-paren">(</span><em>respfile</em>, <em>covfile</em>, <em>maskfile=None</em>, <em>cvfolds=None</em>, <em>testcov=None</em>, <em>testresp=None</em>, <em>outputsuffix=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate a normative model</p>
<p>This will estimate a model in one of two settings according to the
particular parameters specified (see below):</p>
<ul class="simple">
<li>under k-fold cross-validation</li>
<li>estimating a training dataset then applying to a second test dataset</li>
</ul>
<p>The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (nifti or cifti). Ascii data should be in
tab or space delimited format with the number of subjects in rows and the
number of variables in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">estimate</span><span class="p">(</span><span class="n">respfile</span><span class="p">,</span> <span class="n">covfile</span><span class="p">,</span> <span class="p">[</span><span class="n">extra_arguments</span><span class="p">])</span>
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>respfile</strong> &#8211; response variables for the normative model</li>
<li><strong>covfile</strong> &#8211; covariates used to predict the response variable</li>
<li><strong>maskfile</strong> &#8211; mask used to apply to the data (nifti only)</li>
<li><strong>cvfolds</strong> &#8211; Number of cross-validation folds</li>
<li><strong>testcov</strong> &#8211; Test covariates</li>
<li><strong>testresp</strong> &#8211; Test responses</li>
<li><strong>outputsuffix</strong> &#8211; Text string to add to the outpug filenames</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Outputs:</th><td class="field-body"><ul class="first last simple">
<li>yhat - predictive mean</li>
<li>ys2 - predictive variance</li>
<li>Z - deviance scores</li>
<li>Rho - Pearson correlation between true and predicted responses</li>
<li>pRho - parametric p-value for this correlation</li>
<li>rmse - root mean squared error between true/predicted responses</li>
<li>smse - standardised mean squared error</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The outputsuffix may be useful to estimate multiple normative models in the
same directory (e.g. for custom cross-validation schemes)</p>
</dd></dl>

<dl class="function">
<dt id="normative.get_args">
<code class="descclassname">normative.</code><code class="descname">get_args</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.get_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse command line arguments</p>
</dd></dl>

<dl class="function">
<dt id="normative.load_response_vars">
<code class="descclassname">normative.</code><code class="descname">load_response_vars</code><span class="sig-paren">(</span><em>datafile</em>, <em>maskfile=None</em>, <em>vol=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#load_response_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.load_response_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>load response variables (of any data type)</p>
</dd></dl>

<dl class="function">
<dt id="normative.main">
<code class="descclassname">normative.</code><code class="descname">main</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse arguments and estimate model</p>
</dd></dl>

<span class="target" id="module-trendsurf"></span><dl class="function">
<dt id="trendsurf.create_basis">
<code class="descclassname">trendsurf.</code><code class="descname">create_basis</code><span class="sig-paren">(</span><em>X</em>, <em>basis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#create_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.create_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a (polynomial) basis set</p>
</dd></dl>

<dl class="function">
<dt id="trendsurf.estimate">
<code class="descclassname">trendsurf.</code><code class="descname">estimate</code><span class="sig-paren">(</span><em>filename</em>, <em>maskfile</em>, <em>basis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate a trend surface model</p>
<p>This will estimate a trend surface model, independently for each subject.
This is currently fit using a polynomial model of a specified degree.
The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (currently nifti only). Ascii data should be in
tab or space delimited format with the number of voxels in rows and the
number of subjects in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">estimate</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">maskfile</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> &#8211; 4-d nifti file containing the images to be estimated</li>
<li><strong>maskfile</strong> &#8211; nifti mask used to apply to the data</li>
<li><strong>basis</strong> &#8211; model order for the interpolating polynomial</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Outputs:</th><td class="field-body"><ul class="first last simple">
<li>yhat - predictive mean</li>
<li>ys2 - predictive variance</li>
<li>trendcoeff - coefficients from the trend surface model</li>
<li>negloglik - Negative log marginal likelihood</li>
<li>hyp - hyperparameters</li>
<li>explainedvar - explained variance</li>
<li>rmse - standardised mean squared error</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="trendsurf.get_args">
<code class="descclassname">trendsurf.</code><code class="descname">get_args</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.get_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="trendsurf.load_data">
<code class="descclassname">trendsurf.</code><code class="descname">load_data</code><span class="sig-paren">(</span><em>datafile</em>, <em>maskfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>load 4d nifti data</p>
</dd></dl>

<dl class="function">
<dt id="trendsurf.main">
<code class="descclassname">trendsurf.</code><code class="descname">main</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="trendsurf.write_nii">
<code class="descclassname">trendsurf.</code><code class="descname">write_nii</code><span class="sig-paren">(</span><em>data</em>, <em>filename</em>, <em>examplenii</em>, <em>mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#write_nii"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.write_nii" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Spatial methods for neuroimaging"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Spatial methods for neuroimaging 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Andre F. Marquand.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>