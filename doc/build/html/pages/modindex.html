

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module Index &mdash; Predictive Clinical Neuroscience Toolkit 0.20 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/pages/css/pcntoolkit_tabs.css" />
      <link rel="stylesheet" type="text/css" href="../_static/pages/css/pcntoolkit.css" />
      <link rel="stylesheet" type="text/css" href="../_static/pages/css/pcntoolkit_nomaxwidth.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=0144e382"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DEMO ON NORMATIVE MODELING" href="normative_modelling_walkthrough.html" />
    <link rel="prev" title="PCNtoolkit Background" href="pcntoolkit_background.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/pcn-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pcntoolkit_background.html">PCNtoolkit Background</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Function &amp; Class Docs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Module Index</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#bayesreg.BLR"><code class="docutils literal notranslate"><span class="pre">BLR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bayesreg.BLR.dloglik"><code class="docutils literal notranslate"><span class="pre">BLR.dloglik()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bayesreg.BLR.estimate"><code class="docutils literal notranslate"><span class="pre">BLR.estimate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bayesreg.BLR.loglik"><code class="docutils literal notranslate"><span class="pre">BLR.loglik()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bayesreg.BLR.penalized_loglik"><code class="docutils literal notranslate"><span class="pre">BLR.penalized_loglik()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bayesreg.BLR.post"><code class="docutils literal notranslate"><span class="pre">BLR.post()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bayesreg.BLR.predict"><code class="docutils literal notranslate"><span class="pre">BLR.predict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bayesreg.BLR.predict_and_adjust"><code class="docutils literal notranslate"><span class="pre">BLR.predict_and_adjust()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gp.CovBase"><code class="docutils literal notranslate"><span class="pre">CovBase</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovBase.cov"><code class="docutils literal notranslate"><span class="pre">CovBase.cov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovBase.dcov"><code class="docutils literal notranslate"><span class="pre">CovBase.dcov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovBase.get_n_params"><code class="docutils literal notranslate"><span class="pre">CovBase.get_n_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gp.CovLin"><code class="docutils literal notranslate"><span class="pre">CovLin</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovLin.cov"><code class="docutils literal notranslate"><span class="pre">CovLin.cov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovLin.dcov"><code class="docutils literal notranslate"><span class="pre">CovLin.dcov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovLin.get_n_params"><code class="docutils literal notranslate"><span class="pre">CovLin.get_n_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gp.CovSqExp"><code class="docutils literal notranslate"><span class="pre">CovSqExp</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovSqExp.cov"><code class="docutils literal notranslate"><span class="pre">CovSqExp.cov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovSqExp.dcov"><code class="docutils literal notranslate"><span class="pre">CovSqExp.dcov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovSqExp.get_n_params"><code class="docutils literal notranslate"><span class="pre">CovSqExp.get_n_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gp.CovSqExpARD"><code class="docutils literal notranslate"><span class="pre">CovSqExpARD</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovSqExpARD.cov"><code class="docutils literal notranslate"><span class="pre">CovSqExpARD.cov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovSqExpARD.dcov"><code class="docutils literal notranslate"><span class="pre">CovSqExpARD.dcov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovSqExpARD.get_n_params"><code class="docutils literal notranslate"><span class="pre">CovSqExpARD.get_n_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gp.CovSum"><code class="docutils literal notranslate"><span class="pre">CovSum</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovSum.cov"><code class="docutils literal notranslate"><span class="pre">CovSum.cov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovSum.dcov"><code class="docutils literal notranslate"><span class="pre">CovSum.dcov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.CovSum.get_n_params"><code class="docutils literal notranslate"><span class="pre">CovSum.get_n_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gp.GPR"><code class="docutils literal notranslate"><span class="pre">GPR</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gp.GPR.dloglik"><code class="docutils literal notranslate"><span class="pre">GPR.dloglik()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.GPR.estimate"><code class="docutils literal notranslate"><span class="pre">GPR.estimate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.GPR.loglik"><code class="docutils literal notranslate"><span class="pre">GPR.loglik()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.GPR.post"><code class="docutils literal notranslate"><span class="pre">GPR.post()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gp.GPR.predict"><code class="docutils literal notranslate"><span class="pre">GPR.predict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#normative.entrypoint"><code class="docutils literal notranslate"><span class="pre">entrypoint()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.estimate"><code class="docutils literal notranslate"><span class="pre">estimate()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.evaluate"><code class="docutils literal notranslate"><span class="pre">evaluate()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.extend"><code class="docutils literal notranslate"><span class="pre">extend()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.fit"><code class="docutils literal notranslate"><span class="pre">fit()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.get_args"><code class="docutils literal notranslate"><span class="pre">get_args()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.load_response_vars"><code class="docutils literal notranslate"><span class="pre">load_response_vars()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.merge"><code class="docutils literal notranslate"><span class="pre">merge()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.save_results"><code class="docutils literal notranslate"><span class="pre">save_results()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.transfer"><code class="docutils literal notranslate"><span class="pre">transfer()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative.tune"><code class="docutils literal notranslate"><span class="pre">tune()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.bashwrap_nm"><code class="docutils literal notranslate"><span class="pre">bashwrap_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.check_job_status"><code class="docutils literal notranslate"><span class="pre">check_job_status()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.check_jobs"><code class="docutils literal notranslate"><span class="pre">check_jobs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.collect_nm"><code class="docutils literal notranslate"><span class="pre">collect_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.delete_nm"><code class="docutils literal notranslate"><span class="pre">delete_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.entrypoint"><code class="docutils literal notranslate"><span class="pre">entrypoint()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.execute_nm"><code class="docutils literal notranslate"><span class="pre">execute_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.qsub_nm"><code class="docutils literal notranslate"><span class="pre">qsub_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.rerun_nm"><code class="docutils literal notranslate"><span class="pre">rerun_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.retrieve_jobs"><code class="docutils literal notranslate"><span class="pre">retrieve_jobs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.sbatch_nm"><code class="docutils literal notranslate"><span class="pre">sbatch_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.sbatchrerun_nm"><code class="docutils literal notranslate"><span class="pre">sbatchrerun_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.sbatchwrap_nm"><code class="docutils literal notranslate"><span class="pre">sbatchwrap_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#normative_parallel.split_nm"><code class="docutils literal notranslate"><span class="pre">split_nm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#trendsurf.create_basis"><code class="docutils literal notranslate"><span class="pre">create_basis()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#trendsurf.entrypoint"><code class="docutils literal notranslate"><span class="pre">entrypoint()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#trendsurf.estimate"><code class="docutils literal notranslate"><span class="pre">estimate()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#trendsurf.get_args"><code class="docutils literal notranslate"><span class="pre">get_args()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#trendsurf.load_data"><code class="docutils literal notranslate"><span class="pre">load_data()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#trendsurf.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#trendsurf.write_nii"><code class="docutils literal notranslate"><span class="pre">write_nii()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#rfa.GPRRFA"><code class="docutils literal notranslate"><span class="pre">GPRRFA</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rfa.GPRRFA.dloglik"><code class="docutils literal notranslate"><span class="pre">GPRRFA.dloglik()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfa.GPRRFA.estimate"><code class="docutils literal notranslate"><span class="pre">GPRRFA.estimate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfa.GPRRFA.get_n_params"><code class="docutils literal notranslate"><span class="pre">GPRRFA.get_n_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfa.GPRRFA.loglik"><code class="docutils literal notranslate"><span class="pre">GPRRFA.loglik()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfa.GPRRFA.post"><code class="docutils literal notranslate"><span class="pre">GPRRFA.post()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfa.GPRRFA.predict"><code class="docutils literal notranslate"><span class="pre">GPRRFA.predict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.alphanum_key"><code class="docutils literal notranslate"><span class="pre">alphanum_key()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.create_mask"><code class="docutils literal notranslate"><span class="pre">create_mask()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.file_extension"><code class="docutils literal notranslate"><span class="pre">file_extension()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.file_stem"><code class="docutils literal notranslate"><span class="pre">file_stem()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.file_type"><code class="docutils literal notranslate"><span class="pre">file_type()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.load_ascii"><code class="docutils literal notranslate"><span class="pre">load_ascii()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.load_cifti"><code class="docutils literal notranslate"><span class="pre">load_cifti()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.load_nifti"><code class="docutils literal notranslate"><span class="pre">load_nifti()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.load_pd"><code class="docutils literal notranslate"><span class="pre">load_pd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.predictive_interval"><code class="docutils literal notranslate"><span class="pre">predictive_interval()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.save"><code class="docutils literal notranslate"><span class="pre">save()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.save_ascii"><code class="docutils literal notranslate"><span class="pre">save_ascii()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.save_cifti"><code class="docutils literal notranslate"><span class="pre">save_cifti()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.save_nifti"><code class="docutils literal notranslate"><span class="pre">save_nifti()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.save_pd"><code class="docutils literal notranslate"><span class="pre">save_pd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.sort_nicely"><code class="docutils literal notranslate"><span class="pre">sort_nicely()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.tryint"><code class="docutils literal notranslate"><span class="pre">tryint()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fileio.vol2vec"><code class="docutils literal notranslate"><span class="pre">vol2vec()</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="normative_modelling_walkthrough.html"><strong>DEMO ON NORMATIVE MODELING</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="HBR_NormativeModel_FCONdata_Tutorial.html">Predictive Clinical Neuroscience Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="HBR_NormativeModel_FCONdata_Tutorial.html#hierarchical-bayesian-regression-normative-modelling-and-transfer-onto-unseen-site">Hierarchical Bayesian Regression Normative Modelling and Transfer onto unseen site.</a></li>
<li class="toctree-l1"><a class="reference internal" href="apply_normative_models.html">Using lifespan models to make predictions on new data</a></li>
<li class="toctree-l1"><a class="reference internal" href="BLR_normativemodel_protocol.html">Predictive Clinical Neuroscience Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="BLR_normativemodel_protocol.html#the-normative-modeling-framework-for-computational-psychiatry-protocol">The Normative Modeling Framework for Computational Psychiatry Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="BLR_normativemodel_protocol.html#data-preparation">Data Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="BLR_normativemodel_protocol.html#algorithm-modeling">Algorithm &amp; Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="BLR_normativemodel_protocol.html#evaluation-interpretation">Evaluation &amp; Interpretation</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualizations.html">Visualization of normative modeling outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="post_hoc_analysis.html">Post-hoc analysis on normative modeling outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_predictive_models.html">Load Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_predictive_models.html#create-train-test-splits">Create Train/Test Splits</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_predictive_models.html#principal-component-regression-bbs">Principal Component Regression (BBS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_predictive_models.html#connectome-predictive-modelling">Connectome Predictive Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_predictive_models.html#lasso-linear-regression-l1-regularization">Lasso (Linear Regression + L1 Regularization)</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_predictive_models.html#ridge-linear-regression-l2-regularization">Ridge (Linear Regression + L2 Regularization)</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_predictive_models.html#elastic-net-linear-regression-l1-l2-regularization">Elastic Net (Linear Regression + L1/L2 Regularization)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Useful Stuff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="FAQs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">How to cite PCNtoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Predictive Clinical Neuroscience Toolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Module Index</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pages/modindex.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-bayesreg">
<span id="module-index"></span><h1>Module Index<a class="headerlink" href="#module-bayesreg" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="bayesreg.BLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayesreg.</span></span><span class="sig-name descname"><span class="pre">BLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bayesreg.html#BLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bayesian linear regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>B = BLR()
hyp = B.estimate(hyp0, X, y)
ys,s2 = B.predict(hyp, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = ( log(beta), log(alpha) )  # hyp is a list or numpy array
</pre></div>
</div>
<p>The implementation and notation mostly follows Bishop (2006).
The hyperparameter beta is the noise precision and alpha is the precision
over lengthscale parameters. This can be either a scalar variable (a
common lengthscale for all input variables), or a vector of length D (a
different lengthscale for each input variable, derived using an automatic
relevance determination formulation). These are estimated using conjugate
gradient optimisation of the marginal likelihood.</p>
<p>Reference:
Bishop (2006) Pattern Recognition and Machine Learning, Springer</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.dloglik">
<span class="sig-name descname"><span class="pre">dloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bayesreg.html#BLR.dloglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.dloglik" title="Link to this definition"></a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bayesreg.html#BLR.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.estimate" title="Link to this definition"></a></dt>
<dd><p>Function to estimate the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates</p></li>
<li><p><strong>y</strong> – responses</p></li>
<li><p><strong>optimizer</strong> – optimisation algorithm (‘cg’,’powell’,’nelder-mead’,’l0bfgs-b’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.loglik">
<span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bayesreg.html#BLR.loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.loglik" title="Link to this definition"></a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.penalized_loglik">
<span class="sig-name descname"><span class="pre">penalized_loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L1'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bayesreg.html#BLR.penalized_loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.penalized_loglik" title="Link to this definition"></a></dt>
<dd><p>Function to compute the penalized log (marginal) likelihood</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates</p></li>
<li><p><strong>y</strong> – responses</p></li>
<li><p><strong>Xv</strong> – covariates for heteroskedastic noise</p></li>
<li><p><strong>l</strong> – regularisation penalty</p></li>
<li><p><strong>norm</strong> – type of regulariser (L1 or L2)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bayesreg.html#BLR.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.post" title="Link to this definition"></a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma_a) and precision (Lambda_a).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates</p></li>
<li><p><strong>y</strong> – responses</p></li>
<li><p><strong>Xv</strong> – covariates for heteroskedastic noise</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_groups_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_covariates_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bayesreg.html#BLR.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.predict" title="Link to this definition"></a></dt>
<dd><p>Function to make predictions from the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates for training data</p></li>
<li><p><strong>y</strong> – responses for training data</p></li>
<li><p><strong>Xs</strong> – covariates for test data</p></li>
<li><p><strong>var_covariates_test</strong> – test covariates for heteroskedastic noise</p></li>
</ul>
</dd>
</dl>
<p>This always returns Gaussian predictions, i.e.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.predict_and_adjust">
<span class="sig-name descname"><span class="pre">predict_and_adjust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_groups_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_groups_adapt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/bayesreg.html#BLR.predict_and_adjust"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.predict_and_adjust" title="Link to this definition"></a></dt>
<dd><p>Function to transfer the model to a new site. This is done by
first making predictions on the adaptation data given by X,
adjusting by the residuals with respect to y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – hyperparameter vector</p></li>
<li><p><strong>X</strong> – covariates for adaptation (i.e. calibration) data</p></li>
<li><p><strong>y</strong> – responses for adaptation data</p></li>
<li><p><strong>Xs</strong> – covariate data (for which predictions should be adjusted)</p></li>
<li><p><strong>ys</strong> – true response variables (to be adjusted)</p></li>
<li><p><strong>var_groups_test</strong> – variance groups (e.g. sites) for test data</p></li>
<li><p><strong>var_groups_adapt</strong> – variance groups for adaptation data</p></li>
</ul>
</dd>
</dl>
<p>There are two possible ways of using this function, depending on
whether ys or Xs is specified</p>
<p>If ys is specified, this is applied directly to the data, which is
assumed to be in the input space (i.e. not warped). In this case
the adjusted true data points are returned in the same space</p>
<p>Alternatively, Xs is specified, then the predictions are made and
adjusted. In this case the predictive variance are returned in the
warped (i.e. Gaussian) space.</p>
<p>This function needs to know which sites are associated with which
data points, which provided by var_groups_xxx, which is a list or
array of scalar ids .</p>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-gp">
<dt class="sig sig-object py" id="gp.CovBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for covariance functions.</p>
<p>All covariance functions must define the following methods:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CovFunction.get_n_params()
CovFunction.cov()
CovFunction.xcov()
CovFunction.dcov()
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovBase.cov">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovBase.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase.cov" title="Link to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovBase.dcov">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovBase.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase.dcov" title="Link to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovBase.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovBase.get_n_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase.get_n_params" title="Link to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovLin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovLin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovLin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovLin" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">CovBase</span></code></a></p>
<p>Linear covariance function (no hyperparameters)</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovLin.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovLin.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovLin.cov" title="Link to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovLin.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovLin.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovLin.dcov" title="Link to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovLin.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovLin.get_n_params" title="Link to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovSqExp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovSqExp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovSqExp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExp" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">CovBase</span></code></a></p>
<p>Ordinary squared exponential covariance function.
The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = ( log(ell), log(sf) )
</pre></div>
</div>
<p>where ell is a lengthscale parameter and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExp.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovSqExp.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExp.cov" title="Link to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExp.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovSqExp.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExp.dcov" title="Link to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExp.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExp.get_n_params" title="Link to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovSqExpARD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovSqExpARD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovSqExpARD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExpARD" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">CovBase</span></code></a></p>
<p>Squared exponential covariance function with ARD
The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = (log(ell_1, ..., log_ell_D), log(sf))
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExpARD.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovSqExpARD.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExpARD.cov" title="Link to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExpARD.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovSqExpARD.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExpARD.dcov" title="Link to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExpARD.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExpARD.get_n_params" title="Link to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovSum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovSum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfuncnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovSum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSum" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">CovBase</span></code></a></p>
<p>Sum of covariance functions. These are passed in as a cell array and
intialised automatically. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C = CovSum(x,(CovLin, CovSqExpARD))
C = CovSum.cov(x, )
</pre></div>
</div>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = ( log(ell_1, ..., log_ell_D), log(sf2) )
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSum.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovSum.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSum.cov" title="Link to this definition"></a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSum.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#CovSum.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSum.dcov" title="Link to this definition"></a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSum.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSum.get_n_params" title="Link to this definition"></a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.GPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">GPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#GPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gaussian process regression</p>
<p>Estimation and prediction of Gaussian process regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>G = GPR()
hyp = B.estimate(hyp0, cov, X, y)
ys, ys2 = B.predict(hyp, cov, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters</p></li>
<li><p><strong>cov</strong> – covariance function</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = ( log(sn), (cov function params) )  # hyp is a list or array
</pre></div>
</div>
<p>The implementation and notation  follows Rasmussen and Williams (2006).
As in the gpml toolbox, these parameters are estimated using conjugate
gradient optimisation of the marginal likelihood. Note that there is no
explicit mean function, thus the gpr routines are limited to modelling
zero-mean processes.</p>
<p>Reference:
C. Rasmussen and C. Williams (2006) Gaussian Processes for Machine Learning</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.dloglik">
<span class="sig-name descname"><span class="pre">dloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#GPR.dloglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.dloglik" title="Link to this definition"></a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cg'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#GPR.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.estimate" title="Link to this definition"></a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.loglik">
<span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#GPR.loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.loglik" title="Link to this definition"></a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#GPR.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.post" title="Link to this definition"></a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gp.html#GPR.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.predict" title="Link to this definition"></a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<dl class="py function" id="module-normative">
<dt class="sig sig-object py" id="normative.entrypoint">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">entrypoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#entrypoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.entrypoint" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.estimate">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.estimate" title="Link to this definition"></a></dt>
<dd><p>Estimate a normative model</p>
<p>This will estimate a model in one of two settings according to
theparticular parameters specified (see below)</p>
<ul class="simple">
<li><p>under k-fold cross-validation.
requires respfile, covfile and cvfolds&gt;=2</p></li>
<li><p>estimating a training dataset then applying to a second test dataset.
requires respfile, covfile, testcov and testresp.</p></li>
<li><p>estimating on a training dataset ouput of forward maps mean and se.
requires respfile, covfile and testcov</p></li>
</ul>
<p>The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (nifti or cifti). Ascii data should be in
tab or space delimited format with the number of subjects in rows and the
number of variables in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>estimate(covfile, respfile, [extra_arguments])
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>respfile</strong> – response variables for the normative model</p></li>
<li><p><strong>covfile</strong> – covariates used to predict the response variable</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>cvfolds</strong> – Number of cross-validation folds</p></li>
<li><p><strong>testcov</strong> – Test covariates</p></li>
<li><p><strong>testresp</strong> – Test responses</p></li>
<li><p><strong>alg</strong> – Algorithm for normative model</p></li>
<li><p><strong>configparam</strong> – Parameters controlling the estimation algorithm</p></li>
<li><p><strong>saveoutput</strong> – Save the output to disk? Otherwise returned as arrays</p></li>
<li><p><strong>outputsuffix</strong> – Text string to add to the output filenames</p></li>
<li><p><strong>inscaler</strong> – Scaling approach for input covariates, could be ‘None’ (Default),
‘standardize’, ‘minmax’, or ‘robminmax’.</p></li>
<li><p><strong>outscaler</strong> – Scaling approach for output responses, could be ‘None’ (Default),
‘standardize’, ‘minmax’, or ‘robminmax’.</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>yhat - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
<li><p>nm - normative model</p></li>
<li><p>Z - deviance scores</p></li>
<li><p>Rho - Pearson correlation between true and predicted responses</p></li>
<li><p>pRho - parametric p-value for this correlation</p></li>
<li><p>rmse - root mean squared error between true/predicted responses</p></li>
<li><p>smse - standardised mean squared error</p></li>
</ul>
</dd>
</dl>
<p>The outputsuffix may be useful to estimate multiple normative models in the
same directory (e.g. for custom cross-validation schemes)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.evaluate">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Yhat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlZ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xz_tr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Rho',</span> <span class="pre">'RMSE',</span> <span class="pre">'SMSE',</span> <span class="pre">'EXPV',</span> <span class="pre">'MSLL']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.evaluate" title="Link to this definition"></a></dt>
<dd><p>Compute error metrics
This function will compute error metrics based on a set of predictions Yhat
and a set of true response variables Y, namely:</p>
<ul class="simple">
<li><p>Rho: Pearson correlation</p></li>
<li><p>RMSE: root mean squared error</p></li>
<li><p>SMSE: standardized mean squared error</p></li>
<li><p>EXPV: explained variance</p></li>
</ul>
<p>If the predictive variance is also specified the log loss will be computed
(which also takes into account the predictive variance). If the mean and
standard deviation are also specified these will be used to standardize
this, yielding the mean standardized log loss</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y</strong> – N x P array of true response variables</p></li>
<li><p><strong>Yhat</strong> – N x P array of predicted response variables</p></li>
<li><p><strong>S2</strong> – predictive variance</p></li>
<li><p><strong>mY</strong> – mean of the training set</p></li>
<li><p><strong>sY</strong> – standard deviation of the training set</p></li>
</ul>
</dd>
<dt class="field-even">Returns metrics<span class="colon">:</span></dt>
<dd class="field-even"><p>evaluation metrics</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.extend">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#extend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.extend" title="Link to this definition"></a></dt>
<dd><p>This function extends an existing HBR model with data from new sites/scanners.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>transfer(covfile, respfile, trbefile, model_path, output_path, inputsuffix [extra_arguments])
</pre></div>
</div>
<p>where the variables are defined below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covfile</strong> – covariates for new data</p></li>
<li><p><strong>respfile</strong> – response variables for new data</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>model_path</strong> – Directory containing the normative model and metadata</p></li>
<li><p><strong>trbefile</strong> – file address to batch effects file for new data</p></li>
<li><p><strong>batch_size</strong> – batch size (for use with normative_parallel)</p></li>
<li><p><strong>job_id</strong> – batch id</p></li>
<li><p><strong>output_path</strong> – the path for saving the  the extended model</p></li>
<li><p><strong>inputsuffix</strong> – The suffix for the input models (default=’extend’)</p></li>
<li><p><strong>informative_prior</strong> – use initial model prior or learn from scratch (default is False).</p></li>
<li><p><strong>generation_factor</strong> – generation factor refers to the number of samples generated for each</p></li>
</ul>
</dd>
</dl>
<p>combination of covariates and batch effects. Default is 10.</p>
<p>All outputs are written to disk in the same format as the input.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.fit">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.fit" title="Link to this definition"></a></dt>
<dd><p>Fits a normative model to the data.</p>
<p>Parameters:
covfile (str): The path to the covariates file.
respfile (str): The path to the response variables file.
maskfile (str, optional): The path to the mask file. Defaults to None.
alg (str, optional): The algorithm to use. Defaults to ‘gpr’.
savemodel (bool, optional): Whether to save the model. Defaults to True.
outputsuffix (str, optional): The suffix to append to the output files. Defaults to ‘fit’.
inscaler (str, optional): The scaler to use for the input data. Defaults to ‘None’.
outscaler (str, optional): The scaler to use for the output data. Defaults to ‘None’.</p>
<p>Returns:
None</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.get_args">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.get_args" title="Link to this definition"></a></dt>
<dd><p>Parse command line arguments for normative modeling</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – command line arguments</p>
</dd>
<dt class="field-even">Returns respfile<span class="colon">:</span></dt>
<dd class="field-even"><p>response variables for the normative model</p>
</dd>
<dt class="field-odd">Returns maskfile<span class="colon">:</span></dt>
<dd class="field-odd"><p>mask used to apply to the data (nifti only)</p>
</dd>
<dt class="field-even">Returns covfile<span class="colon">:</span></dt>
<dd class="field-even"><p>covariates used to predict the response variable</p>
</dd>
<dt class="field-odd">Returns cvfolds<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of cross-validation folds</p>
</dd>
<dt class="field-even">Returns testcov<span class="colon">:</span></dt>
<dd class="field-even"><p>Test covariates</p>
</dd>
<dt class="field-odd">Returns testresp<span class="colon">:</span></dt>
<dd class="field-odd"><p>Test responses</p>
</dd>
<dt class="field-even">Returns func<span class="colon">:</span></dt>
<dd class="field-even"><p>Function to call</p>
</dd>
<dt class="field-odd">Returns alg<span class="colon">:</span></dt>
<dd class="field-odd"><p>Algorithm for normative model</p>
</dd>
<dt class="field-even">Returns configparam<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters controlling the estimation algorithm</p>
</dd>
<dt class="field-odd">Returns kw_args<span class="colon">:</span></dt>
<dd class="field-odd"><p>Additional keyword arguments</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.load_response_vars">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">load_response_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#load_response_vars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.load_response_vars" title="Link to this definition"></a></dt>
<dd><p>Load response variables from file. This will load the data and mask it if
necessary. If the data is in ascii format it will be converted into a numpy
array. If the data is in neuroimaging format it will be reshaped into a
2D array (subjects x variables) and a mask will be created if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datafile</strong> – File containing the response variables</p></li>
<li><p><strong>maskfile</strong> – Mask file (nifti only)</p></li>
<li><p><strong>vol</strong> – If True, load the data as a 4D volume (nifti only)</p></li>
</ul>
</dd>
<dt class="field-even">Returns Y<span class="colon">:</span></dt>
<dd class="field-even"><p>Response variables</p>
</dd>
<dt class="field-odd">Returns volmask<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mask file (nifti only)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.main">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.main" title="Link to this definition"></a></dt>
<dd><p>Parse arguments and estimate model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.merge">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.merge" title="Link to this definition"></a></dt>
<dd><p>This function extends an existing HBR model with data from new sites/scanners.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>merge(model_path1, model_path2 [extra_arguments])
</pre></div>
</div>
<p>where the variables are defined below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covfile</strong> – Not required. Always set to None.</p></li>
<li><p><strong>respfile</strong> – Not required. Always set to None.</p></li>
<li><p><strong>model_path1</strong> – Directory containing the model and metadata (1st model)</p></li>
<li><p><strong>model_path2</strong> – Directory containing the  model and metadata (2nd model)</p></li>
<li><p><strong>batch_size</strong> – batch size (for use with normative_parallel)</p></li>
<li><p><strong>job_id</strong> – batch id</p></li>
<li><p><strong>output_path</strong> – the path for saving the  the extended model</p></li>
<li><p><strong>generation_factor</strong> – see below</p></li>
</ul>
</dd>
</dl>
<p>The generation factor refers tothe number of samples generated for each
combination of covariates and batch effects. Default is 10.</p>
<p>All outputs are written to disk in the same format as the input.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.predict">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.predict" title="Link to this definition"></a></dt>
<dd><p>Make predictions on the basis of a pre-estimated normative model
If only the covariates are specified then only predicted mean and variance
will be returned. If the test responses are also specified then quantities
That depend on those will also be returned (Z scores and error metrics)</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>predict(covfile, [extra_arguments])
</pre></div>
</div>
<p>where the variables are defined below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covfile</strong> – test covariates used to predict the response variable</p></li>
<li><p><strong>respfile</strong> – test response variables for the normative model</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>model_path</strong> – Directory containing the normative model and metadata.
When using parallel prediction, do not pass the model path. It will be
automatically decided.</p></li>
<li><p><strong>outputsuffix</strong> – Text string to add to the output filenames</p></li>
<li><p><strong>inputsuffix</strong> – Defaults to ‘fit’. Needs to be specified carefully for proper functioning. Should be set to the outputsuffix of the fitted model.</p></li>
<li><p><strong>batch_size</strong> – batch size (for use with normative_parallel)</p></li>
<li><p><strong>job_id</strong> – batch id, ‘None’ when non-parallel module is used.</p></li>
<li><p><strong>fold</strong> – which cross-validation fold to use (default = 0)</p></li>
<li><p><strong>fold</strong> – list of model IDs to predict (if not specified all are computed)</p></li>
<li><p><strong>return_y</strong> – return the (transformed) response variable (default = False)</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>Yhat - predictive mean</p></li>
<li><p>S2 - predictive variance</p></li>
<li><p>Z - Z scores</p></li>
<li><p>Y - response variable (if return_y is True)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.save_results">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Yhat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskvol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputsuffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.save_results" title="Link to this definition"></a></dt>
<dd><p>Writes the results of the normative model to disk.</p>
<p>Parameters:
respfile (str): The response variables file.
Yhat (np.array): The predicted response variables.
S2 (np.array): The predictive variance.
maskvol (np.array): The mask volume.
Z (np.array, optional): The latent variable. Defaults to None.
Y (np.array, optional): The observed response variables. Defaults to None.
outputsuffix (str, optional): The suffix to append to the output files. Defaults to None.
results (dict, optional): The results of the normative model. Defaults to None.
save_path (str, optional): The directory to save the results to. Defaults to ‘’.</p>
<p>Returns:
None</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.transfer">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">transfer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testresp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#transfer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.transfer" title="Link to this definition"></a></dt>
<dd><p>Transfer learning on the basis of a pre-estimated normative model by using
the posterior distribution over the parameters as an informed prior for
new data. currently only supported for HBR.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>transfer(covfile, respfile, trbefile, model_path, output_path, inputsuffix [extra_arguments])
</pre></div>
</div>
<p>where the variables are defined below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covfile</strong> – transfer covariates used to predict the response variable</p></li>
<li><p><strong>respfile</strong> – transfer response variables for the normative model</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>trbefile</strong> – Training batch effects file</p></li>
<li><p><strong>testcov</strong> – Test covariates</p></li>
<li><p><strong>testresp</strong> – Test responses</p></li>
<li><p><strong>model_path</strong> – Directory containing the normative model and metadata</p></li>
<li><p><strong>output_path</strong> – Address to output directory to save the transferred models</p></li>
<li><p><strong>inputsuffix</strong> – The suffix for the inout models (default=’estimate’)</p></li>
<li><p><strong>batch_size</strong> – batch size (for use with normative_parallel)</p></li>
<li><p><strong>job_id</strong> – batch id</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>Yhat - predictive mean</p></li>
<li><p>S2 - predictive variance</p></li>
<li><p>Z - Z scores</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative.tune">
<span class="sig-prename descclassname"><span class="pre">normative.</span></span><span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative.html#tune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative.tune" title="Link to this definition"></a></dt>
<dd><p>This function tunes an existing HBR model with real data.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tune(covfile, respfile [extra_arguments])
</pre></div>
</div>
<p>where the variables are defined below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covfile</strong> – covariates for new data</p></li>
<li><p><strong>respfile</strong> – response variables for new data</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>model_path</strong> – Directory containing the normative model and metadata</p></li>
<li><p><strong>trbefile</strong> – file address to batch effects file for new data</p></li>
<li><p><strong>batch_size</strong> – batch size (for use with normative_parallel)</p></li>
<li><p><strong>job_id</strong> – batch id</p></li>
<li><p><strong>output_path</strong> – the path for saving the  the extended model</p></li>
<li><p><strong>informative_prior</strong> – use initial model prior or learn from scracth (default is False).</p></li>
<li><p><strong>generation_factor</strong> – see below</p></li>
</ul>
</dd>
</dl>
<p>generation factor refers to the number of samples generated for each
combination of covariates and batch effects. Default is 10.</p>
<p>All outputs are written to disk in the same format as the input.</p>
</dd></dl>

<dl class="py function" id="module-normative_parallel">
<dt class="sig sig-object py" id="normative_parallel.bashwrap_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">bashwrap_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normative_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#bashwrap_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.bashwrap_nm" title="Link to this definition"></a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>bashwrap_nm(processing_dir, python_path, normative_path, job_name, covfile_path, respfile_path)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>python_path</strong> – Full path to the python distribution</p></li>
<li><p><strong>normative_path</strong> – Full path to the normative.py</p></li>
<li><p><strong>job_name</strong> – Name for the bash script that is the output of this function</p></li>
<li><p><strong>covfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the responsefile</p></li>
<li><p><strong>respfile_path</strong> – Full path to a .txt that contains all features (subjects x features)</p></li>
<li><p><strong>cv_folds</strong> – Number of cross validations</p></li>
<li><p><strong>testcovfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the testresponse file</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to a .txt file that contains all test features</p></li>
<li><p><strong>alg</strong> – which algorithm to use</p></li>
<li><p><strong>configparam</strong> – configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>A bash.sh file containing the commands for normative modelling saved to the processing directory (written to disk).</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.check_job_status">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">check_job_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#check_job_status"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.check_job_status" title="Link to this definition"></a></dt>
<dd><p>A utility function to count the tasks with different status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jobs</strong> – List of job ids.</p></li>
<li><p><strong>cluster_spec</strong> – type of cluster, either ‘torque’ or ‘slurm’.</p></li>
</ul>
</dd>
</dl>
<p>:return returns the number of taks athat are queued, running, completed etc</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.check_jobs">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">check_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#check_jobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.check_jobs" title="Link to this definition"></a></dt>
<dd><p>A utility function for chacking the status of submitted jobs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jobs</strong> – list of job ids.</p></li>
<li><p><strong>cluster_spec</strong> – type of cluster, either ‘torque’ or ‘slurm’.</p></li>
<li><p><strong>delay</strong> – the delay (in sec) between two consequative checks, defaults to 60.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.collect_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">collect_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputsuffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#collect_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.collect_nm" title="Link to this definition"></a></dt>
<dd><p>Function to checks and collects all batches.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>collect_nm(processing_dir, job_name)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing directory</p></li>
<li><p><strong>collect</strong> – If True data is checked for failed batches and collected; if False data is just checked</p></li>
<li><p><strong>binary</strong> – Results in pkl format</p></li>
</ul>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>Text or pkl files containing all results accross all batches the combined output (written to disk).</p>
</dd>
<dt class="field-odd">Returns 0<span class="colon">:</span></dt>
<dd class="field-odd"><p>if batches fail</p>
</dd>
<dt class="field-even">Returns 1<span class="colon">:</span></dt>
<dd class="field-even"><p>if bathches complete successfully</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.delete_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">delete_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#delete_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.delete_nm" title="Link to this definition"></a></dt>
<dd><p>This function deletes all processing for normative modelling and just keeps the combined output.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>collect_nm(processing_dir)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing directory.</p></li>
<li><p><strong>binary</strong> – Results in pkl format.</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.entrypoint">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">entrypoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#entrypoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.entrypoint" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.execute_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">execute_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normative_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#execute_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.execute_nm" title="Link to this definition"></a></dt>
<dd><p>Execute parallel normative models
This function is a mother function that executes all parallel normative
modelling routines. Different specifications are possible using the sub-
functions.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>execute_nm(processing_dir, python_path, job_name, covfile_path, respfile_path, batch_size, memory, duration)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>python_path</strong> – Full path to the python distribution</p></li>
<li><p><strong>normative_path</strong> – Full path to the normative.py. If None (default) then it will automatically retrieves the path from the installed packeage.</p></li>
<li><p><strong>job_name</strong> – Name for the bash script that is the output of this function</p></li>
<li><p><strong>covfile_path</strong> – Full path to a .txt file that contains all covariats (subjects x covariates) for the responsefile</p></li>
<li><p><strong>respfile_path</strong> – Full path to a .txt that contains all features (subjects x features)</p></li>
<li><p><strong>batch_size</strong> – Number of features in each batch</p></li>
<li><p><strong>memory</strong> – Memory requirements written as string for example 4gb or 500mb</p></li>
<li><p><strong>duation</strong> – The approximate duration of the job, a string with HH:MM:SS for example 01:01:01</p></li>
<li><p><strong>cv_folds</strong> – Number of cross validations</p></li>
<li><p><strong>testcovfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the test response file</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to a .txt file that contains all test features</p></li>
<li><p><strong>log_path</strong> – Path for saving log files</p></li>
<li><p><strong>binary</strong> – If ‘True’ (string not boolean) uses binary format for response file otherwise it is text, defaulted to ‘False’.</p></li>
<li><p><strong>cluster_spec</strong> – ‘torque’ for PBS Torque and ‘slurm’ for Slurm clusters.</p></li>
<li><p><strong>interactive</strong> – If False (default) the user should manually
rerun the failed jobs or collect the results.
If ‘auto’ the job status are checked until all
jobs are completed then the failed jobs are rerun
and the results are automaticallu collectted.
Using ‘query’ is similar to ‘auto’ unless it
asks for user verification thius is immune to
endless loop in the case of bugs in the code.</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia
The documentation is adapated by S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.main">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.main" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.qsub_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">qsub_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#qsub_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.qsub_nm" title="Link to this definition"></a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub command.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>qsub_nm(job_path, log_path, memory, duration)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>job_path</strong> – Full path to the job.sh file.</p></li>
<li><p><strong>memory</strong> – Memory requirements written as string for example 4gb or 500mb.</p></li>
<li><p><strong>duation</strong> – The approximate duration of the job, a string with HH:MM:SS for example 01:01:01.</p></li>
</ul>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>Submission of the job to the (torque) cluster.</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.rerun_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">rerun_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#rerun_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.rerun_nm" title="Link to this definition"></a></dt>
<dd><p>This function reruns all failed batched in processing_dir after collect_nm has identified the failed batches.
Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rerun_nm(processing_dir, log_path, memory, duration)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing directory</p></li>
<li><p><strong>memory</strong> – Memory requirements written as string for example 4gb or 500mb.</p></li>
<li><p><strong>duration</strong> – The approximate duration of the job, a string with HH:MM:SS for example 01:01:01.</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.retrieve_jobs">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">retrieve_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#retrieve_jobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.retrieve_jobs" title="Link to this definition"></a></dt>
<dd><p>A utility function to retrieve task status from the outputs of qstat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cluster_spec</strong> – type of cluster, either ‘torque’ or ‘slurm’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dictionary of jobs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.sbatch_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">sbatch_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#sbatch_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.sbatch_nm" title="Link to this definition"></a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sbatch_nm(job_path)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>job_path</strong> – Full path to the job.sh file</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>Submission of the job to the slurm cluster.</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.sbatchrerun_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">sbatchrerun_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#sbatchrerun_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.sbatchrerun_nm" title="Link to this definition"></a></dt>
<dd><p>This function reruns all failed batched in processing_dir after collect_nm has identified he failed batches.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rerun_nm(processing_dir, memory, duration)
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing directory.</p></li>
<li><p><strong>memory</strong> – Memory requirements written as string, for example 4gb or 500mb.</p></li>
<li><p><strong>duration</strong> – The approximate duration of the job, a string with HH:MM:SS for example 01:01:01.</p></li>
<li><p><strong>new_memory</strong> – If you want to change the memory you have to indicate it here.</p></li>
<li><p><strong>new_duration</strong> – If you want to change the duration you have to indicate it here.</p></li>
</ul>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>Re-runs failed batches.</p>
<p>written by (primarily) T Wolfers, (adapted) S Rutherford.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.sbatchwrap_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">sbatchwrap_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normative_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#sbatchwrap_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.sbatchwrap_nm" title="Link to this definition"></a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sbatchwrap_nm(processing_dir, python_path, normative_path, job_name, covfile_path, respfile_path, memory, duration)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>python_path</strong> – Full path to the python distribution</p></li>
<li><p><strong>normative_path</strong> – Full path to the normative.py</p></li>
<li><p><strong>job_name</strong> – Name for the bash script that is the output of this function</p></li>
<li><p><strong>covfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the responsefile</p></li>
<li><p><strong>respfile_path</strong> – Full path to a .txt that contains all features (subjects x features)</p></li>
<li><p><strong>cv_folds</strong> – Number of cross validations</p></li>
<li><p><strong>testcovfile_path</strong> – Full path to a .txt file that contains all covariates (subjects x covariates) for the testresponse file</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to a .txt file that contains all test features</p></li>
<li><p><strong>alg</strong> – which algorithm to use</p></li>
<li><p><strong>configparam</strong> – configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>A bash.sh file containing the commands for normative modelling saved to the processing directory (written to disk).</p>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) S Rutherford</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.split_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">split_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normative_parallel.html#split_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.split_nm" title="Link to this definition"></a></dt>
<dd><p>This function prepares the input files for normative_parallel.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>split_nm(processing_dir, respfile_path, batch_size, binary, testrespfile_path)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>respfile_path</strong> – Full path to the responsefile.txt (subjects x features)</p></li>
<li><p><strong>batch_size</strong> – Number of features in each batch</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to the test responsefile.txt (subjects x features)</p></li>
<li><p><strong>binary</strong> – If True binary file</p></li>
</ul>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>The creation of a folder struture for batch-wise processing.</p>
</dd>
</dl>
<p>witten by (primarily) T Wolfers (adapted) SM Kia, (adapted) S Rutherford.</p>
</dd></dl>

<dl class="py function" id="module-trendsurf">
<dt class="sig sig-object py" id="trendsurf.create_basis">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">create_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trendsurf.html#create_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.create_basis" title="Link to this definition"></a></dt>
<dd><p>Create a basis set</p>
<p>This will create a basis set for the trend surface model. This is
currently fit using a polynomial model of a specified degree. The models
are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (currently nifti only). Ascii data should be in
tab or space delimited format with the number of voxels in rows and the
number of subjects in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – covariates</p></li>
<li><p><strong>basis</strong> – model order for the interpolating polynomial</p></li>
<li><p><strong>mask</strong> – mask used to apply to the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Phi - basis set</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.entrypoint">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">entrypoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trendsurf.html#entrypoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.entrypoint" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.estimate">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveoutput</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trendsurf.html#estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.estimate" title="Link to this definition"></a></dt>
<dd><p>Estimate a trend surface model</p>
<p>This will estimate a trend surface model, independently for each subject.
This is currently fit using a polynomial model of a specified degree.
The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (currently nifti only). Ascii data should be in
tab or space delimited format with the number of voxels in rows and the
number of subjects in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>estimate(filename, maskfile, basis)
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – 4-d nifti file containing the images to be estimated</p></li>
<li><p><strong>maskfile</strong> – nifti mask used to apply to the data</p></li>
<li><p><strong>basis</strong> – model order for the interpolating polynomial</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>yhat - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
<li><p>trendcoeff - coefficients from the trend surface model</p></li>
<li><p>negloglik - Negative log marginal likelihood</p></li>
<li><p>hyp - hyperparameters</p></li>
<li><p>explainedvar - explained variance</p></li>
<li><p>rmse - standardised mean squared error</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.get_args">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trendsurf.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.get_args" title="Link to this definition"></a></dt>
<dd><p>Parse command line arguments</p>
<p>This will parse the command line arguments for the trend surface model.
The arguments are:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – 4-d nifti file containing the images to be estimated</p></li>
<li><p><strong>maskfile</strong> – nifti mask used to apply to the data</p></li>
<li><p><strong>basis</strong> – model order for the interpolating polynomial</p></li>
<li><p><strong>covfile</strong> – file containing covariates</p></li>
<li><p><strong>ard</strong> – use ARD</p></li>
<li><p><strong>outputall</strong> – output all measures</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>filename - 4-d nifti file containing the images to be estimated</p></li>
<li><p>maskfile - nifti mask used to apply to the data</p></li>
<li><p>basis - model order for the interpolating polynomial</p></li>
<li><p>covfile - file containing covariates</p></li>
<li><p>ard - use ARD</p></li>
<li><p>outputall - output all measures</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.load_data">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trendsurf.html#load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.load_data" title="Link to this definition"></a></dt>
<dd><p>Load data from disk</p>
<p>This will load data from disk, either in nifti or ascii format. If the
data are in ascii format, they should be in tab or space delimited format
with the number of voxels in rows and the number of subjects in columns.
Neuroimaging data will be reshaped into the appropriate format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datafile</strong> – 4-d nifti file containing the images to be estimated</p></li>
<li><p><strong>maskfile</strong> – nifti mask used to apply to the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>dat - data in vectorised form</p></li>
<li><p>world - voxel coordinates</p></li>
<li><p>mask - mask used to apply to the data</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.main">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trendsurf.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.main" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.write_nii">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">write_nii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">examplenii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/trendsurf.html#write_nii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.write_nii" title="Link to this definition"></a></dt>
<dd><p>Write data to nifti file</p>
<p>This will write data to a nifti file, using the header information from
an example nifti file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – data to be written</p></li>
<li><p><strong>filename</strong> – name of file to be written</p></li>
<li><p><strong>examplenii</strong> – example nifti file</p></li>
<li><p><strong>mask</strong> – mask used to apply to the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Phi - basis set</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-rfa">
<dt class="sig sig-object py" id="rfa.GPRRFA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rfa.</span></span><span class="sig-name descname"><span class="pre">GPRRFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rfa.html#GPRRFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Random Feature Approximation for Gaussian Process Regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>R = GPRRFA()
hyp = R.estimate(hyp0, X, y)
ys,s2 = R.predict(hyp, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = [ log(sn), log(ell), log(sf) ]  # hyp is a numpy array
</pre></div>
</div>
<p>where sn^2 is the noise variance, ell are lengthscale parameters and
sf^2 is the signal variance. This provides an approximation to the
covariance function:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>k(x,z) = x&#39;*z + sn2*exp(0.5*(x-z)&#39;*Lambda*(x-z))
</pre></div>
</div>
<p>where Lambda = diag((ell_1^2, … ell_D^2))</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.dloglik">
<span class="sig-name descname"><span class="pre">dloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rfa.html#GPRRFA.dloglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.dloglik" title="Link to this definition"></a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lbfgs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rfa.html#GPRRFA.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.estimate" title="Link to this definition"></a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rfa.html#GPRRFA.get_n_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.get_n_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.loglik">
<span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rfa.html#GPRRFA.loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.loglik" title="Link to this definition"></a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rfa.html#GPRRFA.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.post" title="Link to this definition"></a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma) and precision (iSigma).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rfa.html#GPRRFA.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.predict" title="Link to this definition"></a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<dl class="py function" id="module-fileio">
<dt class="sig sig-object py" id="fileio.alphanum_key">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">alphanum_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#alphanum_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.alphanum_key" title="Link to this definition"></a></dt>
<dd><p>Turn a string into a list of numbers</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>alphanum_key(s)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> – string to convert</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.create_mask">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">create_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#create_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.create_mask" title="Link to this definition"></a></dt>
<dd><p>Create a mask from a data array or a nifti file</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>create_mask(data_array, mask, verbose)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_array</strong> – numpy array containing the data to write out</p></li>
<li><p><strong>mask</strong> – nifti image containing a mask for the image</p></li>
<li><p><strong>verbose</strong> – verbose output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.file_extension">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">file_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#file_extension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.file_extension" title="Link to this definition"></a></dt>
<dd><p>Determine the file extension of a file (e.g. .nii.gz)</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>file_extension(filename)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> – name of the file to check</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.file_stem">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">file_stem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#file_stem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.file_stem" title="Link to this definition"></a></dt>
<dd><p>Determine the file stem of a file (e.g. /path/to/file.nii.gz -&gt; file)</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>file_stem(filename)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> – name of the file to check</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.file_type">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">file_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#file_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.file_type" title="Link to this definition"></a></dt>
<dd><p>Determine the file type of a file</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>file_type(filename)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> – name of the file to check</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load" title="Link to this definition"></a></dt>
<dd><p>Load a numpy array from a file</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>load(filename, mask, text, vol)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – name of the file to load</p></li>
<li><p><strong>mask</strong> – nifti image containing a mask for the image</p></li>
<li><p><strong>text</strong> – whether to write out a text file</p></li>
<li><p><strong>vol</strong> – whether to load the image as a volume</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_ascii">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_ascii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#load_ascii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_ascii" title="Link to this definition"></a></dt>
<dd><p>Load an ascii file into a numpy array</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>load_ascii(filename)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> – name of the file to load</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_cifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_cifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmtmp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#load_cifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_cifti" title="Link to this definition"></a></dt>
<dd><p>Load a cifti file into a numpy array</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>load_cifti(filename, vol, mask, rmtmp)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – name of the file to load</p></li>
<li><p><strong>vol</strong> – whether to load the image as a volume</p></li>
<li><p><strong>mask</strong> – nifti image containing a mask for the image</p></li>
<li><p><strong>rmtmp</strong> – whether to remove temporary files</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_nifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_nifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#load_nifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_nifti" title="Link to this definition"></a></dt>
<dd><p>Load a nifti file into a numpy array</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>load_nifti(datafile, mask, vol, verbose)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datafile</strong> – name of the file to load</p></li>
<li><p><strong>mask</strong> – nifti image containing a mask for the image</p></li>
<li><p><strong>vol</strong> – whether to load the image as a volume</p></li>
<li><p><strong>verbose</strong> – verbose output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_pd">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#load_pd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_pd" title="Link to this definition"></a></dt>
<dd><p>Load a csv file into a pandas dataframe</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>load_pd(filename)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> – name of the file to load</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.predictive_interval">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">predictive_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s2_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#predictive_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.predictive_interval" title="Link to this definition"></a></dt>
<dd><p>Calculates a predictive interval for the forward model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save" title="Link to this definition"></a></dt>
<dd><p>Save a numpy array to a file</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>save(data, filename, example, mask, text, dtype)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy array containing the data to write out</p></li>
<li><p><strong>filename</strong> – where to store it</p></li>
<li><p><strong>example</strong> – example file to copy the geometry from</p></li>
<li><p><strong>mask</strong> – nifti image containing a mask for the image</p></li>
<li><p><strong>text</strong> – whether to write out a text file</p></li>
<li><p><strong>dtype</strong> – data type for the output image (if different from the image)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_ascii">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_ascii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#save_ascii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_ascii" title="Link to this definition"></a></dt>
<dd><p>Save a numpy array to an ascii file</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>save_ascii(data, filename)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy array containing the data to write out</p></li>
<li><p><strong>filename</strong> – where to store it</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_cifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_cifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volatlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#save_cifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_cifti" title="Link to this definition"></a></dt>
<dd><p>Save a cifti file from a numpy array</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>save_cifti(data, filename, example, mask, vol, volatlas)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy array containing the data to write out</p></li>
<li><p><strong>filename</strong> – where to store it</p></li>
<li><p><strong>example</strong> – example file to copy the geometry from</p></li>
<li><p><strong>mask</strong> – nifti image containing a mask for the image</p></li>
<li><p><strong>vol</strong> – whether to load the image as a volume</p></li>
<li><p><strong>volatlas</strong> – atlas to use for the volume</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_nifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_nifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">examplenii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#save_nifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_nifti" title="Link to this definition"></a></dt>
<dd><p>Write output to nifti</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>save_nifti(data, filename mask, dtype)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy array containing the data to write out</p></li>
<li><p><strong>filename</strong> – where to store it</p></li>
<li><p><strong>examplenii</strong> – nifti to copy the geometry and data type from</p></li>
<li><p><strong>dtype</strong> – data type for the output image (if different from the image)</p></li>
</ul>
</dd>
<dt class="field-even">Mask<span class="colon">:</span></dt>
<dd class="field-even"><p>nifti image containing a mask for the image</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_pd">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#save_pd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_pd" title="Link to this definition"></a></dt>
<dd><p>Save a pandas dataframe to a csv file</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>save_pd(data, filename)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – pandas dataframe containing the data to write out</p></li>
<li><p><strong>filename</strong> – where to store it</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.sort_nicely">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">sort_nicely</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#sort_nicely"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.sort_nicely" title="Link to this definition"></a></dt>
<dd><p>Sort a list of strings in a natural way</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sort_nicely(l)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>l</strong> – list of strings to sort</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.tryint">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">tryint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#tryint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.tryint" title="Link to this definition"></a></dt>
<dd><p>Try to convert a string to an integer</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tryint(s)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> – string to convert</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.vol2vec">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">vol2vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fileio.html#vol2vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.vol2vec" title="Link to this definition"></a></dt>
<dd><p>Vectorise a 3d image</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vol2vec(dat, mask, verbose)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> – numpy array containing the data to write out</p></li>
<li><p><strong>mask</strong> – nifti image containing a mask for the image</p></li>
<li><p><strong>verbose</strong> – verbose output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-util"></span></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pcntoolkit_background.html" class="btn btn-neutral float-left" title="PCNtoolkit Background" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="normative_modelling_walkthrough.html" class="btn btn-neutral float-right" title="DEMO ON NORMATIVE MODELING" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Andre F. Marquand.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>