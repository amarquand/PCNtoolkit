<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GPR tutorial &mdash; Predictive Clinical Neuroscience Toolkit 0.20 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/pages/css/pcntoolkit_tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/pages/css/pcntoolkit.css" type="text/css" />
      <link rel="stylesheet" href="../_static/pages/css/pcntoolkit_nomaxwidth.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hierarchical Bayesian Regression" href="HBR_NormativeModel_FCONdata_Tutorial.html" />
    <link rel="prev" title="Module Index" href="../modindex.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/pcn-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pcntoolkit_background.html">PCNtoolkit Background</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Function &amp; Class Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modindex.html">Module Index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Gaussian Process Regression</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#background-story">Background Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-0-load-data-and-install-the-pcntoolkit"><strong>Task 0:</strong> Load data and install the pcntoolkit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-1-format-input-data"><strong>TASK 1:</strong> Format input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-2-prepare-the-covariate-normsample-and-testresponse-normsample-file"><strong>TASK 2:</strong> Prepare the covariate_normsample and testresponse_normsample file.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-3-estimate-normative-model"><strong>TASK 3:</strong> Estimate normative model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-4-estimate-the-forward-model-of-the-normative-model"><strong>TASK 4:</strong> Estimate the forward model of the normative model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-5-visualize-forward-model"><strong>TASK 5:</strong> Visualize forward model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-6-apply-the-normative-model-to-nordans-data-and-the-dementia-patients"><strong>TASK 6:</strong> Apply the normative model to Nordan’s data and the dementia patients.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-7-in-which-hyppocampal-subfield-s-does-nordan-deviate-extremely"><strong>TASK 7:</strong> In which hyppocampal subfield(s) does Nordan deviate extremely?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-8-optional-implement-a-function-that-calculates-percentage-change"><strong>TASK 8 (OPTIONAL):</strong> Implement a function that calculates percentage change.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-9-optional-visualize-percent-change"><strong>TASK 9 (OPTIONAL):</strong> Visualize percent change</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="HBR_NormativeModel_FCONdata_Tutorial.html">Hierarchical Bayesian Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="apply_normative_models.html">Braincharts: transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="BLR_normativemodel_protocol.html">Bayesian Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualizations.html">Visualization of normative modeling outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="post_hoc_analysis.html">Post-hoc analysis on normative modeling outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_predictive_models.html">Predictive modeling using deviation scores</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Useful Stuff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="FAQs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">How to cite PCNtoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Predictive Clinical Neuroscience Toolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>GPR tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pages/normative_modelling_walkthrough.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="gaussian-process-regression">
<h1>Gaussian Process Regression<a class="headerlink" href="#gaussian-process-regression" title="Permalink to this headline"></a></h1>
<p>Created by</p>
<p>Mariam Zabihi <a class="reference external" href="https://twitter.com/m_zabihi">&#64;m_zabihi</a></p>
<p>Saige Rutherford <a class="reference external" href="https://twitter.com/being_saige">&#64;being_saige</a></p>
<p>Thomas Wolfers <a class="reference external" href="https://twitter.com/ThomasWolfers">&#64;ThomasWolfers</a>
_______________________________________________________________________________</p>
<a class="reference external image-reference" href="https://colab.research.google.com/github/predictive-clinical-neuroscience/PCNtoolkit-demo/blob/main/tutorials/CPC_2020/normative_modelling_walkthrough.ipynb"><img alt="https://colab.research.google.com/assets/colab-badge.svg" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<div class="section" id="background-story">
<h2>Background Story<a class="headerlink" href="#background-story" title="Permalink to this headline"></a></h2>
<p>Morten and Ingrid are concerned about the health of their father,
Nordan. He recently turned 65 years. A few months ago he could not find
his way home. Together, they visit a neurologist/psychiatrist to conduct
a number of cognitive tests. However, those tests were inconclusive.
While Nordan has a relatively low IQ it could not explain his trouble
returning home.</p>
<p>Recently, the family heard about a new screening technique called
normative modeling with which one can place individuals in reference to
a population norm on for instance measures such as brain volume. Nordan
would like to undertake this procedure to better know what is going on
and to potentially find targets for treatment. Therefore, the family
booked an appointment with you, the normative modeling specialist. To
find out what is going on you compare Nordan’s hyppocampus to the norm
and to a group of persons with Dementia disorders, who have a similar
IQ, age as well as the same sex as Nordan.</p>
<p>Do your best to get as far as you can. However, you do not need to feel
bad if you cannot complete everything during the tutorial.</p>
</div>
<div class="section" id="task-0-load-data-and-install-the-pcntoolkit">
<h2><strong>Task 0:</strong> Load data and install the pcntoolkit<a class="headerlink" href="#task-0-load-data-and-install-the-pcntoolkit" title="Permalink to this headline"></a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#install normative modeling</span>
<span class="o">!</span> pip uninstall -y Theano-PyMC  # conflicts with Theano on some environments
<span class="o">!</span> pip install <span class="nv">pcntoolkit</span><span class="o">==</span><span class="m">0</span>.20
</pre></div>
</div>
<p><strong>Option 1:</strong> Connect your Google Drive account, and load data from
Google Drive. Having Google Drive connected will allow you to save any
files created back to your Drive folder. This step will require you to
download the csv files from
<a class="reference external" href="https://github.com/predictive-clinical-neuroscience/PCNtoolkit-demo/tree/main/data">Github</a>
to your computer, and then make a folder in your Google Drive account
and upload the csv files to this folder.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>

<span class="c1">#change dir to data on your google drive</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;drive/My Drive/name-of-folder-where-you-uploaded-csv-files-from-Github/&#39;</span><span class="p">)</span> <span class="c1">#Change this path to match the path to your data in Google Drive</span>

<span class="c1"># code by T. Wolfers</span>
</pre></div>
</div>
<p><strong>Option 2:</strong> Import the files directly from Github, and skip adding
them to Google Drive.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>wget -nc https://raw.githubusercontent.com/predictive-clinical-neuroscience/PCNtoolkit-demo/master/tutorials/CPC_2020/data/camcan_demographics.csv
<span class="o">!</span>wget -nc https://raw.githubusercontent.com/predictive-clinical-neuroscience/PCNtoolkit-demo/master/tutorials/CPC_2020/data/camcan_demographics_nordan.csv
<span class="o">!</span>wget -nc https://raw.githubusercontent.com/predictive-clinical-neuroscience/PCNtoolkit-demo/master/tutorials/CPC_2020/data/camcan_features.csv
<span class="o">!</span>wget -nc https://raw.githubusercontent.com/predictive-clinical-neuroscience/PCNtoolkit-demo/master/tutorials/CPC_2020/data/camcan_features_nordan.csv

<span class="c1"># code by S. Rutherford</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>--2022-02-17 15:03:58--  https://raw.githubusercontent.com/predictive-clinical-neuroscience/PCNtoolkit-demo/master/tutorials/CPC_2020/data/camcan_demographics.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.110.133, 185.199.108.133, 185.199.111.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.110.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 17484 (17K) [text/plain]
Saving to: ‘camcan_demographics.csv’

camcan_demographics 100%[===================&gt;]  17.07K  --.-KB/s    in 0.001s

2022-02-17 15:03:58 (12.9 MB/s) - ‘camcan_demographics.csv’ saved [17484/17484]

--2022-02-17 15:03:58--  https://raw.githubusercontent.com/predictive-clinical-neuroscience/PCNtoolkit-demo/master/tutorials/CPC_2020/data/camcan_demographics_nordan.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 332 [text/plain]
Saving to: ‘camcan_demographics_nordan.csv’

camcan_demographics 100%[===================&gt;]     332  --.-KB/s    in 0s

2022-02-17 15:03:58 (15.5 MB/s) - ‘camcan_demographics_nordan.csv’ saved [332/332]

--2022-02-17 15:03:58--  https://raw.githubusercontent.com/predictive-clinical-neuroscience/PCNtoolkit-demo/master/tutorials/CPC_2020/data/camcan_features.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 188944 (185K) [text/plain]
Saving to: ‘camcan_features.csv’

camcan_features.csv 100%[===================&gt;] 184.52K  --.-KB/s    in 0.05s

2022-02-17 15:03:58 (3.88 MB/s) - ‘camcan_features.csv’ saved [188944/188944]

--2022-02-17 15:03:58--  https://raw.githubusercontent.com/predictive-clinical-neuroscience/PCNtoolkit-demo/master/tutorials/CPC_2020/data/camcan_features_nordan.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1695 (1.7K) [text/plain]
Saving to: ‘camcan_features_nordan.csv’

camcan_features_nor 100%[===================&gt;]   1.66K  --.-KB/s    in 0s

2022-02-17 15:03:59 (25.3 MB/s) - ‘camcan_features_nordan.csv’ saved [1695/1695]
</pre></div>
</div>
</div>
<div class="section" id="task-1-format-input-data">
<h2><strong>TASK 1:</strong> Format input data<a class="headerlink" href="#task-1-format-input-data" title="Permalink to this headline"></a></h2>
<p>You have four files. The features and demographics file for the
normsample and two files of the same name for Nordan your test sample.
As one of your coworkers has done the preporcessing and quality control
there are more subjects in the demographics file than in the features
file of the norm sample. Please select the overlap of participants
between those two files.</p>
<p><em>Question for your understanding:</em></p>
<ol class="arabic simple">
<li><p>Why do we have to select the overlap between participants in terms of
featrues and demographics?</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># read in the files.</span>
<span class="n">norm_demographics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;camcan_demographics.csv&#39;</span><span class="p">,</span>
                                <span class="n">sep</span><span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
                                <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">norm_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;camcan_features.csv&#39;</span><span class="p">,</span>
                            <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
                            <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># check columns through print [there are other better options]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">norm_demographics</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">norm_features</span><span class="p">)</span>

<span class="c1"># find overlap in terms of participants between norm_sample_features and</span>
<span class="c1"># norm_sample_demographics</span>

<span class="n">norm_demographics_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">norm_demographics</span><span class="p">,</span> <span class="n">norm_features</span><span class="p">],</span>
                                       <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                                       <span class="n">join</span> <span class="o">=</span> <span class="s1">&#39;inner&#39;</span><span class="p">)</span> <span class="c1"># inner checks overlap</span>
                                                       <span class="c1"># outer combines</span>
<span class="nb">print</span><span class="p">(</span><span class="n">norm_demographics_features</span><span class="p">)</span>

<span class="c1"># code by T. Wolfers</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>             age sex_name  sex  IQ_random
paricipants
CC110033      24     MALE    1         73
CC110037      18     MALE    1        103
CC110045      24   FEMALE    0        124
CC110056      22   FEMALE    0        124
CC110062      20     MALE    1        126
...          ...      ...  ...        ...
CC722542      79     MALE    1        116
CC722651      79   FEMALE    0        128
CC722891      84   FEMALE    0        129
CC723197      80   FEMALE    0         96
CC723395      86   FEMALE    0        145

[707 rows x 4 columns]
              left_Hippocampal_tail  ...  right_Whole_hippocampus
participants                         ...
CC110033                 482.768229  ...              3531.764896
CC110037                 595.269259  ...              3835.426137
CC110045                 655.847194  ...              3681.494304
CC110056                 561.345626  ...              3461.373764
CC110062                 756.521166  ...              4782.407821
...                             ...  ...                      ...
CC722542                 467.896808  ...              3284.108783
CC722651                 406.326167  ...              3210.272905
CC722891                 393.430481  ...              2423.675065
CC723197                 475.929914  ...              3043.146264
CC723395                 444.301617  ...              2988.001288

[651 rows x 26 columns]
          age sex_name  sex  ...  right_fimbria  right_HATA  right_Whole_hippocampus
CC110033   24     MALE    1  ...      87.127463   73.589184              3531.764896
CC110037   18     MALE    1  ...      99.657823   60.920924              3835.426137
CC110045   24   FEMALE    0  ...      69.436808   59.323542              3681.494304
CC110056   22   FEMALE    0  ...      60.505521   51.726283              3461.373764
CC110062   20     MALE    1  ...      92.215816   85.484454              4782.407821
...       ...      ...  ...  ...            ...         ...                      ...
CC722542   79     MALE    1  ...      46.144212   43.966509              3284.108783
CC722651   79   FEMALE    0  ...      68.730322   59.699644              3210.272905
CC722891   84   FEMALE    0  ...      27.913196   38.629828              2423.675065
CC723197   80   FEMALE    0  ...      51.893458   65.474967              3043.146264
CC723395   86   FEMALE    0  ...      68.335159   62.081225              2988.001288

[650 rows x 30 columns]
</pre></div>
</div>
</div>
<div class="section" id="task-2-prepare-the-covariate-normsample-and-testresponse-normsample-file">
<h2><strong>TASK 2:</strong> Prepare the covariate_normsample and testresponse_normsample file.<a class="headerlink" href="#task-2-prepare-the-covariate-normsample-and-testresponse-normsample-file" title="Permalink to this headline"></a></h2>
<p>As mentioned in the introductory presentation those files need a
specific format and the entries need to be seperated by spaces. Use
whatever method you know to prepare those files based on the data
provided in TASK 1. Save those files in .txt format in your drive. Also
get rid of the column names and participant IDs.</p>
<p>Given that we only have limited time in this practical we have to make a
selection for the features based on your prior knowledge. With the
information in mind that Nordan does not remember his way home, which
subfield of the hyppocampus is probably a good target for the
investigations? Select a maximum of four hyppocampal regions as
features.</p>
<p>NOTE: Normative modeling is a screening tool we just make this selection
due to time constraints, in reality we build these models on millions of
putative biomarkers that are not restricted to brain imaging.</p>
<p><em>Qestions for your understanding:</em></p>
<ol class="arabic simple" start="2">
<li><p>What is the requirement for the features in terms of variable
properties (e.g. dicotomous or continous)? 3) What is the requirement
for the covariates in terms of these properties? 4) What are the
requirements for both together? 5) How does this depent on the
algorithm used?</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># perpare covariate_normsample for sex and age</span>
<span class="n">covariate_normsample</span> <span class="o">=</span> <span class="n">norm_demographics_features</span><span class="p">[[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span>
                                                   <span class="s1">&#39;age&#39;</span><span class="p">]]</span>

<span class="n">covariate_normsample</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;covariate_normsample.txt&#39;</span><span class="p">,</span>
                            <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>
                            <span class="n">header</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># perpare features_normsample for relevant hyppocampal subfields</span>
<span class="n">features_normsample</span> <span class="o">=</span> <span class="n">norm_demographics_features</span><span class="p">[[</span><span class="s1">&#39;left_CA1&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;left_CA3&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;right_CA1&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;right_CA3&#39;</span><span class="p">]]</span>

<span class="n">features_normsample</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;features_normsample.txt&#39;</span><span class="p">,</span>
                           <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>
                           <span class="n">header</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># code by T. Wolfers</span>
</pre></div>
</div>
</div>
<div class="section" id="task-3-estimate-normative-model">
<h2><strong>TASK 3:</strong> Estimate normative model<a class="headerlink" href="#task-3-estimate-normative-model" title="Permalink to this headline"></a></h2>
<p>Once you have prepared and saved all the necessary files. Look at the
pcntoolkit for running normative modeling. Select an appropritate method
set up the toolkit and run your analyses using 2-fold cross validation
in the normsample. Change the output suffix from estimate to ’_2fold’.</p>
<p>HINT: You primarily need the estimate function.</p>
<p>SUGGESTION: While this process is running you can go to the next TASK 4,
you will have no doubt when it is correctly running.</p>
<p><em>Question for your understaning:</em></p>
<ol class="arabic simple" start="6">
<li><p>What does cvfolds mean and why do we use it? 7) What is the output of
the estimate function and what does it mean?</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pcntoolkit</span> <span class="k">as</span> <span class="nn">pcn</span>

<span class="c1"># run normative modeling using 2-fold cross-validation</span>

<span class="n">pcn</span><span class="o">.</span><span class="n">normative</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">covfile</span> <span class="o">=</span> <span class="s1">&#39;covariate_normsample.txt&#39;</span><span class="p">,</span>
                       <span class="n">respfile</span> <span class="o">=</span> <span class="s1">&#39;features_normsample.txt&#39;</span><span class="p">,</span>
                       <span class="n">cvfolds</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                       <span class="n">alg</span> <span class="o">=</span> <span class="s1">&#39;gpr&#39;</span><span class="p">,</span>
                       <span class="n">outputsuffix</span> <span class="o">=</span> <span class="s1">&#39;_2fold&#39;</span><span class="p">)</span>

<span class="c1"># code by T. Wolfers</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Processing data in features_normsample.txt
Estimating model  1 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 1856.502251
         Iterations: 40
         Function evaluations: 99
         Gradient evaluations: 99
Estimating model  2 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 1596.239263
         Iterations: 42
         Function evaluations: 93
         Gradient evaluations: 93
Estimating model  3 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 1862.316698
         Iterations: 47
         Function evaluations: 104
         Gradient evaluations: 104
Estimating model  4 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 1587.950935
         Iterations: 30
         Function evaluations: 64
         Gradient evaluations: 64
Estimating model  1 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 1916.461484
         Iterations: 44
         Function evaluations: 94
         Gradient evaluations: 87
Estimating model  2 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 1611.661888
         Iterations: 34
         Function evaluations: 85
         Gradient evaluations: 85
Estimating model  3 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 1912.665851
         Iterations: 61
         Function evaluations: 133
         Gradient evaluations: 126
Estimating model  4 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 1619.045647
         Iterations: 43
         Function evaluations: 110
         Gradient evaluations: 105
Evaluating the model ...
Writing outputs ...
</pre></div>
</div>
</div>
<div class="section" id="task-4-estimate-the-forward-model-of-the-normative-model">
<h2><strong>TASK 4:</strong> Estimate the forward model of the normative model<a class="headerlink" href="#task-4-estimate-the-forward-model-of-the-normative-model" title="Permalink to this headline"></a></h2>
<p>In order to visulize the normative trajectories you first need to run
the forward model. To this end you need to set up an appropriate
covariate_forwardmodel file that covers the age range appropriately for
both sexes. Save this file as .txt . Then you can input the files you
made in TASK 1 as well as the file you made now and run the forward
model using the appropriate specifications.</p>
<p><em>Question for your understaning:</em></p>
<ol class="arabic simple" start="8">
<li><p>What is yhat and ys2? 9) Why does the output of the forward model
does not inlcude the Z-scores?</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create covariate_forwardmodel.txt file</span>
<span class="n">covariate_forwardmodel</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                          <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span>
                                  <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]}</span>
<span class="n">covariate_forwardmodel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">covariate_forwardmodel</span><span class="p">)</span>

<span class="n">covariate_forwardmodel</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;covariate_forwardmodel.txt&#39;</span><span class="p">,</span>
                           <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>
                           <span class="n">header</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># estimate forward model</span>
<span class="n">pcn</span><span class="o">.</span><span class="n">normative</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">covfile</span> <span class="o">=</span> <span class="s1">&#39;covariate_normsample.txt&#39;</span><span class="p">,</span>
                       <span class="n">respfile</span> <span class="o">=</span> <span class="s1">&#39;features_normsample.txt&#39;</span><span class="p">,</span>
                       <span class="n">testcov</span> <span class="o">=</span> <span class="s1">&#39;covariate_forwardmodel.txt&#39;</span><span class="p">,</span>
                       <span class="n">cvfolds</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">alg</span> <span class="o">=</span> <span class="s1">&#39;gpr&#39;</span><span class="p">,</span>
                       <span class="n">outputsuffix</span> <span class="o">=</span> <span class="s1">&#39;_forward&#39;</span><span class="p">)</span>

<span class="c1"># code by T. Wolfers</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Processing data in features_normsample.txt
Estimating model  1 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 3781.497401
         Iterations: 20
         Function evaluations: 61
         Gradient evaluations: 54
Estimating model  2 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 3201.761309
         Iterations: 39
         Function evaluations: 108
         Gradient evaluations: 108
Estimating model  3 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 3771.310488
         Iterations: 47
         Function evaluations: 181
         Gradient evaluations: 167
Estimating model  4 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 3200.837262
         Iterations: 40
         Function evaluations: 104
         Gradient evaluations: 104
Writing outputs ...
</pre></div>
</div>
</div>
<div class="section" id="task-5-visualize-forward-model">
<h2><strong>TASK 5:</strong> Visualize forward model<a class="headerlink" href="#task-5-visualize-forward-model" title="Permalink to this headline"></a></h2>
<p>Visualize the forward model of the normative model similar to the figure
below.</p>
<div class="figure align-default" id="id1">
<img alt="1-s2.0-S245190221830329X-gr2.jpg" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAcQBxAAD/4QDoRXhpZgAATU0AKgAAAAgABwESAAMAAAABAAEAAAEaAAUAAAABAAAAYgEbAAUAAAABAAAAagEoAAMAAAABAAIAAAExAAIAAAAcAAAAcgEyAAIAAAAUAAAAjodpAAQAAAABAAAAogAAAAAAAABxAAAAAQAAAHEAAAABQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzADIwMTk6MDE6MTAgMjE6MDA6MDYAAAOQBAACAAAAFAAAAMygAgAEAAAAAQAAAMmgAwAEAAAAAQAAAHIAAAAAMjAxODoxMjoxMSAxNDozNToxNwD/4RGtaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTg4MUU5QkVDMTRFOTExOEI3RkU1RDU4RURGM0Q0RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyRUM1RUY5ODQ5RkRFODExQTNBM0EyODcyMEY2OTA2NCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjJFQzVFRjk4NDlGREU4MTFBM0EzQTI4NzIwRjY5MDY0IiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wMS0xMFQyMTowMDowNiswNTozMCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTktMDEtMTBUMjE6MDA6MDYrMDU6MzAiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTEyLTExVDE0OjM1OjE3KzAxOjAwIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0iRUNJLVJHQi5pY2MiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIGRjOmZvcm1hdD0iaW1hZ2UvanBlZyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjpvcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MkVDNUVGOTg0OUZERTgxMUEzQTNBMjg3MjBGNjkwNjQiIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTQ4ODFFOUJFQzE0RTkxMThCN0ZFNUQ1OEVERjNENEUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MkVDNUVGOTg0OUZERTgxMUEzQTNBMjg3MjBGNjkwNjQiLz4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIiBzdEV2dDp3aGVuPSIyMDE4LTEyLTExVDE0OjM1OjE3KzAxOjAwIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjJFQzVFRjk4NDlGREU4MTFBM0EzQTI4NzIwRjY5MDY0IiBzdEV2dDphY3Rpb249ImNyZWF0ZWQiLz4gPHJkZjpsaSBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHN0RXZ0OmNoYW5nZWQ9Ii8iIHN0RXZ0OndoZW49IjIwMTktMDEtMTBUMjA6NTE6MDErMDU6MzAiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6N0QzQ0MyOERFQTE0RTkxMTlFRTJGRkMzQkZENTkzMUUiIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiLz4gPHJkZjpsaSBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHN0RXZ0OmNoYW5nZWQ9Ii8iIHN0RXZ0OndoZW49IjIwMTktMDEtMTBUMjA6NTE6MDErMDU6MzAiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6N0UzQ0MyOERFQTE0RTkxMTlFRTJGRkMzQkZENTkzMUUiIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiLz4gPHJkZjpsaSBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHN0RXZ0OmNoYW5nZWQ9Ii8iIHN0RXZ0OndoZW49IjIwMTktMDEtMTBUMjE6MDA6MDYrMDU6MzAiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6RTQ4ODFFOUJFQzE0RTkxMThCN0ZFNUQ1OEVERjNENEUiIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBpbWFnZS90aWZmIHRvIGltYWdlL2pwZWciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImRlcml2ZWQiIHN0RXZ0OnBhcmFtZXRlcnM9ImNvbnZlcnRlZCBmcm9tIGltYWdlL3RpZmYgdG8gaW1hZ2UvanBlZyIvPiA8cmRmOmxpIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyIgc3RFdnQ6Y2hhbmdlZD0iLyIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0xMFQyMTowMDowNiswNTozMCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpFNTg4MUU5QkVDMTRFOTExOEI3RkU1RDU4RURGM0Q0RSIgc3RFdnQ6YWN0aW9uPSJzYXZlZCIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD94cGFja2V0IGVuZD0idyI/PgD/7QBkUGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAACwcAVoAAxslRxwCAAACAAIcAj4ACDIwMTgxMjExHAI/AAsxNDM1MTcrMDEwMDhCSU0EJQAAAAAAEG8VJXtBp2YwhKsNALMYCvf/4gIsSUNDX1BST0ZJTEUAAQEAAAIcQURCRQIQAABtbnRyUkdCIFhZWiAHzwACABYADAADAA9hY3NwQVBQTAAAAABub25lAAAAAAAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLUFEQkUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApjcHJ0AAAA/AAAACRkZXNjAAABIAAAAGd3dHB0AAABiAAAABRia3B0AAABnAAAABRyVFJDAAABsAAAAA5nVFJDAAABwAAAAA5iVFJDAAAB0AAAAA5yWFlaAAAB4AAAABRnWFlaAAAB9AAAABRiWFlaAAACCAAAABR0ZXh0AAAAAChjKSAxOTk5IEFkb2JlIFN5c3RlbXMgSW5jLgBkZXNjAAAAAAAAAAxFQ0ktUkdCLmljYwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAAD23AABAAAAANM6WFlaIAAAAAAAAAAAAAAAAAAAAABjdXJ2AAAAAAAAAAEBzQAAY3VydgAAAAAAAAABAc0AAGN1cnYAAAAAAAAAAQHNAABYWVogAAAAAAAApngAAFH+AAAAAFhZWiAAAAAAAAAtlAAAmiAAABFdWFlaIAAAAAAAACLJAAAT4gAAwdD/wAARCAByAMkDAREAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9sAQwADAgICAgIDAgICAwMDAwQGBAQEBAQIBgYFBgkICgoJCAkJCgwPDAoLDgsJCQ0RDQ4PEBAREAoMEhMSEBMPEBAQ/9sAQwEDAwMEAwQIBAQIEAsJCxAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQ/90ABAAa/9oADAMBAAIRAxEAPwD9KKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgD//0P0ooAKACgAoAOvSgA74/CgAoATI9aAI2ubdDhp4wfQsKAEN1bH/AJbKfpQAC7tu9wg+poAVbm3f7k8bfRwaAJeoyOlAB060AFABQAUAFABQAUAFABQAUAFABQAUAf/R/SigAoAKADvjHPpQBheNNFHinw7e+Hk1e4sJLxAont8tIuGDfdBGQcEEZHB6ik9iZarQs6Fp91pGjWWj/aJbn7HAlubm6O6SXaANxAP16mjoNKyL/kO/+tuHPsuEH6c/rTGRQpYXG4wtFP5b7GO4SFWHY5zg0CumWFVV4RAO2BxQMcBnj1oAzbLxFoWpand6NY6tbT3thj7TAkm54s/3h7dPai6Emm7GXceOtBi8c2/w/mgum1K5tjcq/k5iwBkjd1zheuMZIGeaTeocyvY6A2trnIgRT6qAp/Mc0xgLZBzHJKnuJCf50AL5U6/cuc/76A/yIoAN10vVY3+jFf8AGgBPPK/6y2lX3wGH6c0AKLq3Jx5qqTxtb5T+RoAl6jI70AJmgBaADmgDmvHsvjmPRUb4fQ2cuom4TeLkgAQ87sZ4z936DOMmkyZX6HRQed5KG4CibaDIE+7ux82PbNMrdD6ACgD/0v0ooABzxQBG06r8iZdv7q9PxNAFe7mS1tJr3UJ1htreNpZNucKijJJPXoD0x+NAm7K5R8JeKNA8X6QuteG7jz7RpGj3GMoQy9QQ3I6g/iKW4JqWxtUxh0PTn0oA5nwf4D0DwEupPpM1yV1K5+1Tm5m3heuAOOnJ5OW5GScUlZCUbECfFHwdJ4suPBg1Ei8toBM0hx5B6HYHBOW5HQY5PcUlLUSkr2NseI9GbBW73g9CIXZT+IWqHc8x8HSeC/AnxFvtH0jRNTxqsRuJdavHPlpn5/KBZRhcgck5LADoAahPUzi+WTZ6amteGpphKmraa0wHlhxPGXx6A5zV3RppuZPifTPGup61oN74V8R29lpltcF9ShZcm5jJXhTg54DDHy/ezkkYpMUtdjqc8c9fWmUNWRHd40dWaMgOoOSpPTPpQA6gAHPSgBCFPDDII/OgCP7Jb5ysYT/c+Q/oRmgBPJlX7ly3sHG4f0P60AGbpesccg9m2n8jmgA+0Kv+shkT/gOcfiKAHpNFLxHKrewPNAD6ACgAwfQ0Af/T/SV5FjALH73RR1NAEfzzErI/ljqUB+bB9T6f5zQBMiqgwi7evSgCO6ktobaaW8aNbeNGaYyY2hAPm3Z4xjOc0MH5nCaV8SfhzBa3WjeBPJvp7G2kuodO060ZRKRyQmFC5LYBOMjIJqbroRzx+yWvAfjDxd410qS+vPCn/CPyRzGIC9MjFhgHKoQhI98gfWhNsak2a+sj+ydHvNc1rVtRuILKBriSK1AiyFBJChMN0HdjVA9DA0Txd8NtS0nR9buYreyfWXaKzTUV3TPIrFSNzZ7/AMWccgUk11C8VqzV0Xxl4P1zTdT8S+FhHqH9nLJFMba32zPsUtsXIBIPYdDnr1waBeO6LXgXxb/wm/hy38Qrpd1p3ns6CG4HzfKcbgeMg+vH0prUcXc3x7cdse31oHYa8Uco2yRq+eMMuf50aBocr43k8P8AhLw7eeJD4TjvXtgp8q0gVZGy2MlgMgDue1JtImTsjEg1PxFe+ItBh0nwxq1vomq2Auri7e+l32rkE7CrsVXHyjBHORjoanUWrZcsfAdp4EvvEHjPS9cv5Jb5XurxLqJbhW25Y7UTY2euBn246U7W1FyqOpk2/jH4i+ONA0jxB8PbfThbyXpjvEvE8tzEp5ADFht9SrE8j0NF2F3LY1LT4h2XjQeI/DFhZ61p95pyvZTXSW3meVI25Q6bSWOCpI47Ci9xqV7oxvhZeeL/AA7qV34R8U6rb3ej2kZNjqN05iuLiQsDt2SMWwMtnIBG0DODSjfqKN07M9QhvbO4lkgt7uGWSLHmIkgZkyMjIHTIq7mhNQAUAHU0AMeGKT/WRhvTcOlADfs4H+qlkT2DZH5NkUAIBdKRkxyj3+U/4fyoArfb73/nwm/OgD//1P0ljhRCXGS54Lnkn+lAHN2HgLTtO8c6h48jv717vULdbeSB5MwooC9B1/hHBJHXFK1tSeVLUj8e+OJPB+m/aNN0K6127WaOKS1tclolbPzOQp2jOMA4ySKG7bDlLlWg3xLrOnaboP8Aa/jzVF0vTZwsTWse4kmQcxuwG9uM5ChRgHOaL9xN2Wpn+GfhJ4L0DxPb+NfC3nWyG18qG2hlzAysv3+cscqcgFiOhFJR1ugjBbo7ODU9NuL2bTbfULWS7tQDPAkwMkYYZBZRyAR3IqrjumYN54V1258eWfimPxVcxaVBbNBLpQX5JWIbk84zyCTjOVFKzE03K/Q43WPDeva58cdOfVNEkufDGl2fnWrtABbwy7Ccg9AxkC8Hngcbealp3Ia9/XY7qO78B+DFe1jv9D0RbiRpmjM8Vv5jnGWwSOTge4xVaI091GBqHx3+FlvBcHS/GGn6zdxI7Ja6Y5u3eQA4X9wr4yeOelF+wr9jh/CXxT8Wf8JDfeJ/HVn4os9LktwkWl2nhfUruOMjbiQSRwFccMc7j1wQMVMXrqQnJO7Op1b456eumi68M+CfGGqSuyYSbw7qFlCUJ+95s0IQ9eADkk57VTfYpy00NGD43eB/lXUl1/SpSuSmoeHdQgAP1aAKw9xRe473RzmoftCeHIPH+maJDr2iW2hTQM13d6jObSRJMHAUTbOny4ABzk9MUr6ibfMdWPjB4Fn8Tab4X03WoNTn1RN0c9hKlxbp1ADOrEAnaenpzT5lsNyWx2caRRr5cSKiDI2qAAPwHSnsUvI8w8Ya74j1H4paF4L8LXlzpQi/4mGoz/Z90N1GAPl3DqAoZecDLAZ4qXe+hm9ZaHY2XjXwzrfiXUvBdvcNNqWnRiS5heI7CMgEBjwcblz7mnctNN2KWk/DDwnouu6n4i06K8hu9WbdJ5V08aL3OzYVxk9ck+2BxRy2FypGjDte8n07S/FgluLTBmtZmjnMWem4DEgz7tSBGX4p8fL4Hn0228RLbTNqk5t7c2+9HZsgElCGUD5hnLj71O9tBOVnY3hrkMPF9Y39p6mSAuo9y8e5cfUjHegq5atNRsL8FrG9gnA4PlSBsexx0phdFigYUALtb+6fyoA//9X9Iby9trKMSXMgBc7UCgs7t6Ko5P4UBcqCLUtS5uHaxtu0KMPOYf7Tg/J/uqc/7XagWrLtta29lCtvaQrDGuQFUfn9T65/WiwWK2saHo/iGybTda0+G8tmYP5Uq7lBHQ/Uf1NFrjdnozg9U+K9t4N8cXPhzxi+jaJoMdojadNJdL59w2FwscP3m6t8qpxjnqKlPUhN3scbqFt4m1/xoPGXwV8K6vZPcsz6jqGtRtYWl4u5CEVJv3+0lfmYQ4PykdKVtbktNvQPiH4p+PFhrGm+GLPWNLttV1hS0Nto+meYEXkc3VyxViCMnEKgDBJINOTYSlJaGZqfw/j1f4teHfCWtavr2tGGzF5q66zezXNrK23cwjQFYgMZXIjUZ7k4ATvzBd8x6JqPwl+B+oeGJhp/h7w1pFgzAnUtMgtoGUhu8wX14O7PXFN2ZckmrnR634f1eLwQNA+H+qR6dd29vFBZ3Ep3AIuAckA8lRjODyc+9O1loHLp7pxVj8MfH2v+JdRn+Inidp9Mm0wWASxmMa3BKgFinRcMCxOBubHGMgyotkRhJ7s9J8MeHrDwnoNn4f01pmtrKMxo0z7nbJzyfxJ7D6dKvyNErIu/2hZfbjp326D7WF84wCUeaE7NtPOM9+lA7q5zlvofjJ/HOoahqWs2l14ZmtVjt9OaIFlkwuScjpkMc5OcgYGAalLUnladx+q/DD4b62HXVvAXh673kEtLpsRbPY525BHqD3qrD5UzzLV/AGn+Adf03TNE1Dx0sfiC82rJpWoGKKxThVDjDCXaG6v0VTz6xZJ6EWUWds3gr4maSfM8P/F2e828GDxDpFvdIQO2+3Fu47ckt+NWXY4zx/dfGrRLCTXIPDvhPSp45Ee/1fTdTQPdoAAkbrcxRkDOODI+eMGpehEubc66D42+HLeGObxXoniLw2kiiT7Tf6Y8lqQeQ32q3MsODkEEuOO9O5SlbcveDrb4X3uv6j418Fa3peoXurjbPNZaglwp5ydoViFOQMigEknc6y80vS9RaB9Q061uTbOJoPOhV/KccBl3AkHHTGPzFFirIs9ucc5z/WmBVu9L0y+IkvLCCZx913jBYfRuopWCxW/sTyebDVb+3x1Uy+cv0xIGIH0IpisLnxFb8EWN+OvG63b8vmUn3yv4UAZP/CXy/wDQla7/AN+j/hQM/9b9D9R03ULbSb+50N459be2f7PcXhyPMIOAccKucfKoxQxNaaGP4G8Wvc6VJpni7XNLfxFpKM+qpDIoWAbjgt/CMAgNg4BJ5qU+4ovuZr/F2LX5ZLH4WeG7vxg8bGJ7+GVbbSonHUNdvkSEdxCshHene4XvsVdX0HxzfaXda38SfiG+k6VaxNPPpnhWNoPkAyQ13IDO/AIzGITn86Qbak/whm+EV5Ddy/DXSbe3uk2G9eSFvtjs2SDLM5Lyng/MWP8ASmmmCkmaHh/xX4ok8S6/p3iWwtFsLacLpn2ItNNImTy6oSV42n5guCSKL6gpO50bXerXOGtdEWLHR7yZUPPcLGH/ACJU0DZyfxDuviFaWdnDoekwasmoT/Zb6O2hKNFAwwSWZjwem7GBjNJ36EzcrEU3wg8DaT4KvPDt9faiuiK7385kucbWVQS+QvZV6Ht70cugnCKVjlfD+gP4h8f+H/Efgq41CfwZaac1mZRqUqGJkV18oqzBx0Q4HGADmptd3QkryViXxhp3iv4dWGveIdI8V3GuStdRXL2NzfSKbG0JbJwJMuSSi54GB0PNN6bCd4rc6K/vPFviTwNp/iT4U6xN9rvGR9t84YCPlXA8wHBDD8lOM8U9Wrot3cbo0bX4bCDxWnj06sX11rRbeVpYg0X3QpwqFPTA7YA4zT5eoctnc6T/AIqOPqumXPuWkh/TD0ytSjrXiweGNLm1nxFpc9tZ2yhpZ4pY5ETJwBgkNySPur3FK9gvYpXvi7w/r/hG5vrLXbnTLW9tJDDqLW8sSxAqf3gcgDI9iOlK90Ju6F+GDWcfg+wtLPxePEflhx9tLYZxuY4IzuXHI5ORjmmmEdih8Y/BGu+PPCw0bQdRht5I5vPkimXAnCjhd2CVOce3rRNXWgpxclobXgCw1zS/Bul6b4khtIb61gEMkdsf3SKpIQDHH3MA44z0oW2o4rSzIdc+F/w38SzNceIPAXh/ULiTrNcadE0h99+NxPv1p2Ksjgdf0XwP4E1+08PaF4+8XeEru8ge5jW1v3vLKONQfvRXYljQfIfuqvA9MGk3YiVoml4au/idrGlpr3g/4meH/FFmztH5eraI9m7MvUGW3cBT7mE+uO9Fxp82xqjx18RdM/d+IPg5qNwy8GbQdVtbyI+4E7W8n4FPxNFx3AfG/wAC2/7vxB/bfh64GR5Gr6PdQHPoH2GNz6bXINFxOSRs+HviR4D8VOkGheLdLurp13m0FyguVH+1ETvX8RRdDUlLY6XB9DTGf//X+4pfFPxI8axm28GeEm8N2EwIOs+I0KyhD/FDYxsJSx9ZWix3DDilqJ6lPw7+zl8NtIKT65preIrtDu36p+8iLZBz5GRGcEA5ZSQehFCjYlQS1On8F+AtE+Hg1abT9QuWh1Cf7U4uZAEgHPCgAADBPJyeOTximlYajysg8afETSvDmhXmpvaG9toUXzdwGGV22AhScupJ6gbP9qpbsEpJEnhPwv4Zn02PXLCyjjh1iKK5eKC3FrG4K5UNGoycA9HLAHmmrdASW6OqgggtolhtoY4ol4VUTao+mOlMdh0kiRDMjqn+8cUDIzdIfuCST02ocfnQBzms3/jA+J7DTbPQLWfw/dQyC/mnPzg88HDbQOnBBzk8CkyWaui2On6dp0Vp4esdPtrEZMa2rjy+TyQVHPPU0LyGrLYx4fh7okXi3UPGhsxJf6nb/ZZ45Zt0DIQoI2Fe4UA549utK2txcqvc6K3iazgS3tbGCKGNQqRxHaqjjgKFAH/6/WqWg7EhmkA+a1k+oKn+ZoGH2qPo6yr2IMZH8qAIb2DStYtZdN1CK2u7e5XZJBIAyyDvkenSgN9xDo2kvpLaH9gg/s9oDbm3CYjMR4K4GABzS02DRqxnweC/DmnaKNE0rRrO2hhjZLcNCspic5O75s5IY56/jRZWJcVsjnfA/h3UfDNhDoPi3xybjW7iaWW3EV62WiGOFjk4bHJzs43Y6AUlpuJK27Ot+y65b82+rxTL6XVuCx/4FGVH/jpp6laiG91qAEXGipMD3s7lST9RJsx+Zphc5DxE+t33jnRb9WsbbQreKWO+XUbAiUl9wYLIUKgEbRhWA4Od3SpauS1eVzstCsdC0/TktPDlvZQWKklI7QJ5YJOSfl4zzyfami9FsaFMCO6t7e8t5bS7gSaCdCkkcgyrqeCCD2OcUMLLqYGo/Dj4f6tpkei6p4K0S8soRiOG4sInWP3UFSVPuKEkhJJbEH/Cqvh3/wBCfZfrQM//0P0oGc8sfXrnB/GgDkPGWp+KNS0eew+Gc9u+rRSokkz7TFCo5K5Py7/YA4yc4yDUu72Jk7rQ2tP0iZ4Le48Qype3qqrOAMQRy45MceMDkcMctz1FNaDXmZrfD3w7/wAJnP47m8+S9nthayRySgwFAAN23HXaMY6d8d6Vri5Ve5k6H4d17wJofiCfTdWvvE15dStd2sVyvyRnBwgyw3HnnGAcAADrRsKzjdnSeG7nW9W0Ozv/ABDZtp19NHuntlIyhycZOSRkAHAPGQO2aaKjtqZvhrwpr+j+Kdc1nU/E76hY6g4NnaMn/HsM9Mk+mBx1xk80JO4opp3bOrxj/CmUV9QsYNTsLnTbrd5N3C8Em1ip2spU4I5BwetAMyvBng/SvAugxeHtGluZLaJ2kDXD73ZmPJJAAH4DFJKwkrG7TGM82PzDD5i+YBuKZ5A9cUXAfnHPpQBy7w+Ph8QFlS5sP+ESFrtaIj9952OO2Qc477dvbNTrcnVyKWtfFnwLoXiK78L69qBtLi0gWaSWaA+ScgEKuASWwQcBcdcHijmXUTmk7MzT8W/Dt346sfBOg6Rd3/2oK015bHbFErIHVwB95cEEnIAHTPSi+ugufU6HXPB15q3iHR9cg8R3lomlMWa2UsRNnscOox67g2R0xTa1Kcbu4up+BtG1TxPp/i++s0n1LS0KW8gd0CjJPK5IbBJIPHP4UWG43dzoPPcf623kH+0MMP05pjAXMGeZdh9Gyp/I0Ac7B4906fx7P8P10+9W7t7Rbk3DR5hxgHAPXocZ6buKXNfQnmu7G1PomkXUhmm02ATf89VTbIPo4+b9aLDsZevadr9jo15P4Rvrh9SjiZrW3upRJFJIOgJky3I/2gPpQ9hO9tCLw1dePDoVnP4m0zTTqDJm4igmMZQ5IH95SSoGfmA5x0FJX6gnK2pqf25HCMX+n31pz/HCXX8WjLKB9SKY7jf+El8O/wDQbsv+/i/40xn/0f0G8QR67caFfXaWzSzxW8j22mwS7TK+07Q8nUknHyjA9d1J7CexyXwI8CX/AIV8Pz6zr63kWq6zIZZ4LjjylVm2/L2Yg5Pfn2pRT3IpppanpRmLkrbqJCOrZwoqjQQQbjvnbzD16YA/D/HP4UAS4GMDj6UAL+FAHK6dqHj1/GurWOo6JaJ4egt1awuUceZLJ8o2nnv8/UDGB1BpXZMea4/wBrvirxBpM954t8NHRLuO6eOODJO+MAYbnnqSPQ4yOKEEW3udPTKCgAoA5m38A6Rb+Orjx/HdXpvrm2Fs0Rl/dBQAMgf8BHHTqcUrWdyeVXudNTKOX8EeBU8GNqrLrl9qX9qXZuj9qOfKzngepOeT3wKSQkrDfFfwy8H+NdSstV8Q6cZ57NSo2OUEik52vj7wzyPqaTjcTimdDZaZpunbfsFhb25WNIQY4gpEa8KuQOgxgDOKpaDSSMCx8V6vc+O73wlJ4UvIdOtLZZotTb/VSMQpKj5QO5HBLZU5GDST1EndnUUyg/lQAm0HggE/SgDD8V6/4f8ABWjTeI9Y82C2hKIWgQ7yWbAXCnnnnmjRCbSL2l3kWq6Zaarpl2z215ClxD5kfVHGRwMEcHnmgFrqWd9wn3oFYeqv/Q4/nQMpa9JqUujXsOj3K2WoPA62s1xGSkcmDtJwCMA49aGJ6rQr+DbfxHZ+GrG38WajBf6rGjLPcQ42tySv1+XAPHXmktNwSsrM0/sOm/8APlD/AN8imPlR/9L9JXlEeF5Lnoq9TQAwxvL80547RqePxPWgCbgDGBhenoKADuR3HX2oAKAOX8eSeP4rOx/4V/BYy3DXSC7F0QFEOOSM9Rnr39KTZMr9DqPf26UygoAKACgAoAKACgAoAKACgBOep54AJxzQAtAHL+ONE8Z6ydL/AOEQ8Sx6T9muhLeb13edH6Dg5xzwcA55IwKTTJkm7WOoPXpjPUfn+FMohu7W1v7d7W9tYriCTho5UDqw91NANXJEjSNVijRURFCqqjAAHReOABxgCjYVhtwbgW8ptBGZ9jeUJM7d+OM47ZxSew/Q5X4ax/ERNLupPiNNbteyXLPbpDszHF6EoMHnOBycdTSV+pMOa2p1TW8LncEAY/xKdp/MVRRH9lh/uT/9/wA0Af/T/SaOJIx8o+bue5oAdQADrQBy/g7wHa+Dr/Wr+21a+vDrNz9pZLh8rEcn7vvyRn0CiklbUlRS1OoplBQAUAFABQAUAFABQAUAFABQBy/h7SfG1n4q1y+17xBb3mjXTA6baohDwj34GOODydx546UknclJp3Z1FMoKACgAoAKACgAoAKAOY1zx9p2geLNG8JXFhey3GtZ8qaKLMaYOPmOfUHOOg5NJslys7WOnx70yj//U/SigAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAEKhiGKgsDwTyR680BYXBoA/9X9KKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoABQA7A9BQB//2Q==" />
<p class="caption"><span class="caption-text">1-s2.0-S245190221830329X-gr2.jpg</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</div>
<p>HINT: First create a function that calculates the confidence intervals
and then plot yhat, y2 of the forward model. Finally, plot the data of
individual participants.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># confidence interval calculation at x_forward</span>
<span class="k">def</span> <span class="nf">confidence_interval</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
  <span class="n">CI</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_forward</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>
  <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">xdot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_forward</span><span class="p">):</span>
    <span class="n">ci_inx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">xdot</span><span class="p">)</span>
    <span class="n">S2</span><span class="o">=</span><span class="n">s2</span><span class="p">[</span><span class="n">ci_inx</span><span class="p">]</span>
    <span class="n">S_hat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">S2</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=</span><span class="n">S2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">CI</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">=</span><span class="n">z</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">S_hat</span><span class="o">/</span><span class="n">n</span><span class="p">,</span><span class="mf">.5</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">CI</span>


<span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;left_CA1&#39;</span><span class="p">,</span><span class="s1">&#39;left_CA3&#39;</span><span class="p">,</span><span class="s1">&#39;right_CA1&#39;</span><span class="p">,</span><span class="s1">&#39;right_CA3&#39;</span><span class="p">]</span>
<span class="n">sex_covariates</span><span class="o">=</span><span class="p">[</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span><span class="s1">&#39;Male&#39;</span><span class="p">]</span>
<span class="c1"># Creating plots for Female and male</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">sex</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sex_covariates</span><span class="p">):</span>
<span class="c1">#forward model data</span>
    <span class="n">forward_yhat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;yhat_forward.txt&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">yhat_forward</span><span class="o">=</span><span class="n">forward_yhat</span><span class="o">.</span><span class="n">values</span>
    <span class="n">yhat_forward</span><span class="o">=</span><span class="n">yhat_forward</span><span class="p">[</span><span class="mi">7</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">7</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    <span class="n">x_forward</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>

<span class="c1"># Find the index of the data exclusively for one sex. Female:0, Male: 1</span>
    <span class="n">inx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">covariate_normsample</span><span class="o">.</span><span class="n">sex</span><span class="o">==</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span><span class="o">=</span><span class="n">covariate_normsample</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">inx</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># actual data</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;features_normsample.txt&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">inx</span><span class="p">]</span>
<span class="c1"># confidence Interval yhat+ z *(std/n^.5)--&gt;.95 % CI:z=1.96, 99% CI:z=2.58</span>
    <span class="n">s2</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ys2_2fold.txt&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">s2</span><span class="o">=</span><span class="n">s2</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">inx</span><span class="p">]</span>

    <span class="n">CI_95</span><span class="o">=</span><span class="n">confidence_interval</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mf">1.96</span><span class="p">)</span>
    <span class="n">CI_99</span><span class="o">=</span><span class="n">confidence_interval</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mf">2.58</span><span class="p">)</span>

<span class="c1"># Creat a trejactroy for each point</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">feature_names</span><span class="p">):</span>
         <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
         <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
         <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_forward</span><span class="p">,</span><span class="n">yhat_forward</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normative trejactory&#39;</span><span class="p">)</span>


         <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_forward</span><span class="p">,</span><span class="n">CI_95</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">yhat_forward</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95</span><span class="si">% c</span><span class="s1">onfidence interval&#39;</span><span class="p">)</span>
         <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_forward</span><span class="p">,</span><span class="o">-</span><span class="n">CI_95</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">yhat_forward</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>

         <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_forward</span><span class="p">,</span><span class="n">CI_99</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">yhat_forward</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;99</span><span class="si">% c</span><span class="s1">onfidence interval&#39;</span><span class="p">)</span>
         <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_forward</span><span class="p">,</span><span class="o">-</span><span class="n">CI_99</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">yhat_forward</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

         <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
         <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
         <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Normative trejectory of&#39;</span> <span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39; in &#39;</span><span class="o">+</span><span class="n">sex</span><span class="o">+</span><span class="s1">&#39; cohort&#39;</span><span class="p">)</span>
         <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
         <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># code by M. Zabihi</span>
</pre></div>
</div>
<img alt="../_images/normative_modelling_walkthrough_22_0.png" src="../_images/normative_modelling_walkthrough_22_0.png" />
<img alt="../_images/normative_modelling_walkthrough_22_1.png" src="../_images/normative_modelling_walkthrough_22_1.png" />
<img alt="../_images/normative_modelling_walkthrough_22_2.png" src="../_images/normative_modelling_walkthrough_22_2.png" />
<img alt="../_images/normative_modelling_walkthrough_22_3.png" src="../_images/normative_modelling_walkthrough_22_3.png" />
<img alt="../_images/normative_modelling_walkthrough_22_4.png" src="../_images/normative_modelling_walkthrough_22_4.png" />
<img alt="../_images/normative_modelling_walkthrough_22_5.png" src="../_images/normative_modelling_walkthrough_22_5.png" />
<img alt="../_images/normative_modelling_walkthrough_22_6.png" src="../_images/normative_modelling_walkthrough_22_6.png" />
<img alt="../_images/normative_modelling_walkthrough_22_7.png" src="../_images/normative_modelling_walkthrough_22_7.png" />
</div>
<div class="section" id="task-6-apply-the-normative-model-to-nordans-data-and-the-dementia-patients">
<h2><strong>TASK 6:</strong> Apply the normative model to Nordan’s data and the dementia patients.<a class="headerlink" href="#task-6-apply-the-normative-model-to-nordans-data-and-the-dementia-patients" title="Permalink to this headline"></a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in Nordan&#39;s as well as the patient&#39;s demographics and features</span>
<span class="n">demographics_nordan</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;camcan_demographics_nordan.csv&#39;</span><span class="p">,</span>
                                       <span class="n">sep</span><span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
                                       <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">features_nordan</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;camcan_features_nordan.csv&#39;</span><span class="p">,</span>
                            <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
                            <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># create a covariate file for Nordan&#39;s as well as the patient&#39;s demograhpics</span>
<span class="n">covariate_nordan</span> <span class="o">=</span> <span class="n">demographics_nordan</span><span class="p">[[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;age&#39;</span><span class="p">]]</span>
<span class="n">covariate_nordan</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;covariate_nordan.txt&#39;</span><span class="p">,</span>
                        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>
                        <span class="n">header</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># create the corresponding feature file</span>
<span class="n">features_nordan</span> <span class="o">=</span> <span class="n">features_nordan</span><span class="p">[[</span><span class="s1">&#39;left_CA1&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;left_CA3&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;right_CA1&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;right_CA3&#39;</span><span class="p">]]</span>

<span class="n">features_nordan</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;features_nordan.txt&#39;</span><span class="p">,</span>
                        <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>
                        <span class="n">header</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># apply normative modeling</span>
<span class="n">pcn</span><span class="o">.</span><span class="n">normative</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">covfile</span> <span class="o">=</span> <span class="s1">&#39;covariate_normsample.txt&#39;</span><span class="p">,</span>
                       <span class="n">respfile</span> <span class="o">=</span> <span class="s1">&#39;features_normsample.txt&#39;</span><span class="p">,</span>
                       <span class="n">testcov</span> <span class="o">=</span> <span class="s1">&#39;covariate_nordan.txt&#39;</span><span class="p">,</span>
                       <span class="n">testresp</span> <span class="o">=</span> <span class="s1">&#39;features_nordan.txt&#39;</span><span class="p">,</span>
                       <span class="n">cvfolds</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">alg</span> <span class="o">=</span> <span class="s1">&#39;gpr&#39;</span><span class="p">,</span>
                       <span class="n">outputsuffix</span> <span class="o">=</span> <span class="s1">&#39;_nordan&#39;</span><span class="p">)</span>

<span class="c1"># code by T. Wolfers</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Processing data in features_normsample.txt
Estimating model  1 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 3781.497401
         Iterations: 20
         Function evaluations: 61
         Gradient evaluations: 54
Estimating model  2 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 3201.761309
         Iterations: 39
         Function evaluations: 108
         Gradient evaluations: 108
Estimating model  3 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 3771.310488
         Iterations: 47
         Function evaluations: 181
         Gradient evaluations: 167
Estimating model  4 of 4
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Warning: Estimation of posterior distribution failed
Optimization terminated successfully.
         Current function value: 3200.837262
         Iterations: 40
         Function evaluations: 104
         Gradient evaluations: 104
Evaluating the model ...
Writing outputs ...
</pre></div>
</div>
</div>
<div class="section" id="task-7-in-which-hyppocampal-subfield-s-does-nordan-deviate-extremely">
<h2><strong>TASK 7:</strong> In which hyppocampal subfield(s) does Nordan deviate extremely?<a class="headerlink" href="#task-7-in-which-hyppocampal-subfield-s-does-nordan-deviate-extremely" title="Permalink to this headline"></a></h2>
<p>No coding necessary just create a presentation which includes
recommendations to Nordan and his family. Use i) |Z| &gt; 3.6 ii) |Z| &gt;
1.96 as definitions for extreme normative deviations.</p>
</div>
<div class="section" id="task-8-optional-implement-a-function-that-calculates-percentage-change">
<h2><strong>TASK 8 (OPTIONAL):</strong> Implement a function that calculates percentage change.<a class="headerlink" href="#task-8-optional-implement-a-function-that-calculates-percentage-change" title="Permalink to this headline"></a></h2>
<p>Percentage change = <img class="math" src="../_images/math/136499ff23ae31f75bf05de819b869f7cb8675a7.png" alt="\frac{x1 - x2}{|x2|}*100"/></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function that calculates percentage change</span>
<span class="k">def</span> <span class="nf">calculate_percentage_change</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
  <span class="n">percentage_change</span> <span class="o">=</span> <span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
  <span class="k">return</span> <span class="n">percentage_change</span>

<span class="c1"># code by T. Wolfers</span>
</pre></div>
</div>
</div>
<div class="section" id="task-9-optional-visualize-percent-change">
<h2><strong>TASK 9 (OPTIONAL):</strong> Visualize percent change<a class="headerlink" href="#task-9-optional-visualize-percent-change" title="Permalink to this headline"></a></h2>
<p>Plot the prercentage change in Yhat of the forward model in reference to
age 20. Do that for both sexes seperately.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">forward_yhat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;yhat_forward.txt&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># You can indicate here which hypocampal subfield you like to visualize</span>
<span class="n">hyppocampal_subfield</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">percentage_change_female</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">percentage_change_male</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">lengths</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">forward_yhat</span><span class="p">[</span><span class="n">hyppocampal_subfield</span><span class="p">])</span>
<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">forward_yhat</span><span class="p">[</span><span class="n">hyppocampal_subfield</span><span class="p">]:</span>
  <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
    <span class="n">loop_percentage_change_female</span> <span class="o">=</span> <span class="n">calculate_percentage_change</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span>
                                                                <span class="n">forward_yhat</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                                  <span class="n">hyppocampal_subfield</span><span class="p">])</span>
    <span class="n">percentage_change_female</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loop_percentage_change_female</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
    <span class="n">loop_percentage_change_male</span> <span class="o">=</span> <span class="n">calculate_percentage_change</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span>
                                                              <span class="n">forward_yhat</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span>
                                                                                <span class="n">hyppocampal_subfield</span><span class="p">])</span>
    <span class="n">percentage_change_male</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loop_percentage_change_male</span><span class="p">)</span>
  <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;30 compared to 20 years&#39;</span><span class="p">,</span>
         <span class="s1">&#39;40 compared to 20 years&#39;</span><span class="p">,</span>
         <span class="s1">&#39;50 compared to 20 years&#39;</span><span class="p">,</span>
         <span class="s1">&#39;60 compared to 20 years&#39;</span><span class="p">,</span>
         <span class="s1">&#39;70 compared to 20 years&#39;</span><span class="p">,</span>
         <span class="s1">&#39;80 compared to 20 years&#39;</span><span class="p">]</span>

<span class="c1"># females</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">percentage_change_female</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># males</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">percentage_change_male</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># code by T. Wolfers</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(-20.0, 2.0)
</pre></div>
</div>
<img alt="../_images/normative_modelling_walkthrough_32_1.png" src="../_images/normative_modelling_walkthrough_32_1.png" />
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../modindex.html" class="btn btn-neutral float-left" title="Module Index" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="HBR_NormativeModel_FCONdata_Tutorial.html" class="btn btn-neutral float-right" title="Hierarchical Bayesian Regression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Andre F. Marquand.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>