

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Module Index &mdash; Predictive Clinical Neuroscience Toolkit 0.20 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="_static/pages/css/pcntoolkit_tabs.css" type="text/css" />
  <link rel="stylesheet" href="_static/pages/css/pcntoolkit.css" type="text/css" />
  <link rel="stylesheet" href="_static/pages/css/pcntoolkit_nomaxwidth.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Updates" href="pages/updates.html" />
    <link rel="prev" title="PCNtoolkit Background" href="pages/pcntoolkit_background.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/pcn-logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pages/installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pages/pcntoolkit_background.html">PCNtoolkit Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/pcntoolkit_background.html#intro-to-normative-modelling">Intro to normative modelling</a></li>
</ul>
<p class="caption"><span class="caption-text">Function Docs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Module Index</a></li>
</ul>
<p class="caption"><span class="caption-text">Current Events</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pages/updates.html">Updates</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pages/tutorial_CPC2020.html">Gaussian Process Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/tutorial_ROIcorticalthickness.html">Bayesian Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/tutorial_HBR.html">Hierarchical Bayesian Regressian</a></li>
</ul>
<p class="caption"><span class="caption-text">Other Useful Stuff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pages/FAQs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/citing.html">How to cite PCNtoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="pages/acknowledgements.html">Acknowledgements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Predictive Clinical Neuroscience Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Module Index</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/modindex.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-bayesreg">
<span id="module-index"></span><h1>Module Index<a class="headerlink" href="#module-bayesreg" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="bayesreg.BLR">
<em class="property">class </em><code class="sig-prename descclassname">bayesreg.</code><code class="sig-name descname">BLR</code><span class="sig-paren">(</span><em class="sig-param">hyp=None</em>, <em class="sig-param">X=None</em>, <em class="sig-param">y=None</em>, <em class="sig-param">n_iter=100</em>, <em class="sig-param">tol=0.001</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">var_groups=None</em>, <em class="sig-param">warp=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bayesian linear regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>B = BLR()
hyp = B.estimate(hyp0, X, y)
ys,s2 = B.predict(hyp, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = ( log(beta), log(alpha) )  # hyp is a list or numpy array
</pre></div>
</div>
<p>The implementation and notation mostly follows Bishop (2006).
The hyperparameter beta is the noise precision and alpha is the precision
over lengthscale parameters. This can be either a scalar variable (a
common lengthscale for all input variables), or a vector of length D (a
different lengthscale for each input variable, derived using an automatic
relevance determination formulation). These are estimated using conjugate
gradient optimisation of the marginal likelihood.</p>
<p>Reference:
Bishop (2006) Pattern Recognition and Machine Learning, Springer</p>
<p>Written by A. Marquand</p>
<dl class="method">
<dt id="bayesreg.BLR.dloglik">
<code class="sig-name descname">dloglik</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.dloglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="method">
<dt id="bayesreg.BLR.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param">hyp0</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em>, <em class="sig-param">optimizer='cg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="method">
<dt id="bayesreg.BLR.loglik">
<code class="sig-name descname">loglik</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.loglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="method">
<dt id="bayesreg.BLR.post">
<code class="sig-name descname">post</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma_a) and precision (Lambda_a).</p>
</dd></dl>

<dl class="method">
<dt id="bayesreg.BLR.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em>, <em class="sig-param">Xs</em>, <em class="sig-param">var_groups_test=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-gp"></span><dl class="class">
<dt id="gp.CovBase">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovBase</code><span class="sig-paren">(</span><em class="sig-param">x=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for covariance functions.</p>
<p>All covariance functions must define the following methods:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CovFunction.get_n_params()
CovFunction.cov()
CovFunction.xcov()
CovFunction.dcov()
</pre></div>
</div>
<dl class="method">
<dt id="gp.CovBase.cov">
<em class="property">abstract </em><code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovBase.dcov">
<em class="property">abstract </em><code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovBase.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.get_n_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.CovLin">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovLin</code><span class="sig-paren">(</span><em class="sig-param">x=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovLin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Linear covariance function (no hyperparameters)</p>
<dl class="method">
<dt id="gp.CovLin.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovLin.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovLin.dcov">
<code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovLin.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovLin.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovLin.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.CovSqExp">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovSqExp</code><span class="sig-paren">(</span><em class="sig-param">x=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Ordinary squared exponential covariance function.
The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = ( log(ell), log(sf) )
</pre></div>
</div>
<p>where ell is a lengthscale parameter and sf2 is the signal variance</p>
<dl class="method">
<dt id="gp.CovSqExp.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExp.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovSqExp.dcov">
<code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExp.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovSqExp.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExp.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.CovSqExpARD">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovSqExpARD</code><span class="sig-paren">(</span><em class="sig-param">x=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExpARD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Squared exponential covariance function with ARD
The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = (log(ell_1, ..., log_ell_D), log(sf))
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="method">
<dt id="gp.CovSqExpARD.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExpARD.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovSqExpARD.dcov">
<code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExpARD.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovSqExpARD.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExpARD.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.CovSum">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovSum</code><span class="sig-paren">(</span><em class="sig-param">x=None</em>, <em class="sig-param">covfuncnames=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Sum of covariance functions. These are passed in as a cell array and
intialised automatically. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C = CovSum(x,(CovLin, CovSqExpARD))
C = CovSum.cov(x, )
</pre></div>
</div>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = ( log(ell_1, ..., log_ell_D), log(sf2) )
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="method">
<dt id="gp.CovSum.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSum.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovSum.dcov">
<code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">x</em>, <em class="sig-param">i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSum.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="method">
<dt id="gp.CovSum.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSum.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gp.GPR">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">GPR</code><span class="sig-paren">(</span><em class="sig-param">hyp=None</em>, <em class="sig-param">covfunc=None</em>, <em class="sig-param">X=None</em>, <em class="sig-param">y=None</em>, <em class="sig-param">n_iter=100</em>, <em class="sig-param">tol=0.001</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">warp=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gaussian process regression</p>
<p>Estimation and prediction of Gaussian process regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>G = GPR()
hyp = B.estimate(hyp0, cov, X, y)
ys, ys2 = B.predict(hyp, cov, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters</p></li>
<li><p><strong>cov</strong> – covariance function</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = ( log(sn), (cov function params) )  # hyp is a list or array
</pre></div>
</div>
<p>The implementation and notation  follows Rasmussen and Williams (2006).
As in the gpml toolbox, these parameters are estimated using conjugate
gradient optimisation of the marginal likelihood. Note that there is no
explicit mean function, thus the gpr routines are limited to modelling
zero-mean processes.</p>
<p>Reference:
C. Rasmussen and C. Williams (2006) Gaussian Processes for Machine Learning</p>
<p>Written by A. Marquand</p>
<dl class="method">
<dt id="gp.GPR.dloglik">
<code class="sig-name descname">dloglik</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">covfunc</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.dloglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="method">
<dt id="gp.GPR.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param">hyp0</em>, <em class="sig-param">covfunc</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em>, <em class="sig-param">optimizer='cg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="method">
<dt id="gp.GPR.loglik">
<code class="sig-name descname">loglik</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">covfunc</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.loglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="method">
<dt id="gp.GPR.post">
<code class="sig-name descname">post</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">covfunc</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
</dd></dl>

<dl class="method">
<dt id="gp.GPR.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em>, <em class="sig-param">Xs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-normative_parallel"></span><dl class="function">
<dt id="normative_parallel.bashwrap_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">bashwrap_nm</code><span class="sig-paren">(</span><em class="sig-param">processing_dir</em>, <em class="sig-param">python_path</em>, <em class="sig-param">normative_path</em>, <em class="sig-param">job_name</em>, <em class="sig-param">covfile_path</em>, <em class="sig-param">respfile_path</em>, <em class="sig-param">func='estimate'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#bashwrap_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.bashwrap_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><p>normative_path     -&gt; Full path to the normative.py</p></li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><p>alg                -&gt; which algorithm to use</p></li>
<li><p>configparam        -&gt; configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><ul class="simple">
<li><p>A bash.sh file containing the commands for normative modelling saved
to the processing directory (written to disk)</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers</p>
</dd></dl>

<dl class="function">
<dt id="normative_parallel.collect_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">collect_nm</code><span class="sig-paren">(</span><em class="sig-param">processing_dir</em>, <em class="sig-param">job_name</em>, <em class="sig-param">func='estimate'</em>, <em class="sig-param">collect=False</em>, <em class="sig-param">binary=False</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">outputsuffix='_estimate'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#collect_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.collect_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function checks and collects all batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir        -&gt; Full path to the processing directory</p></li>
<li><dl class="simple">
<dt>collect               -&gt; If True data is checked for failed batches</dt><dd><p>and collected; if False data is just checked</p>
</dd>
</dl>
</li>
<li><p>binary                -&gt; Results in pkl format?</p></li>
</ul>
</dd>
<dt class="field-even">Ouptuts</dt>
<dd class="field-even"><ul class="simple">
<li><p>Text files containing all results accross all batches the combined
output (written to disk)</p></li>
<li><p>returns 0 if batches fail, 1 otherwise</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="function">
<dt id="normative_parallel.delete_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">delete_nm</code><span class="sig-paren">(</span><em class="sig-param">processing_dir</em>, <em class="sig-param">binary=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#delete_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.delete_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function deletes all processing for normative modelling and just
keeps the combined output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir        -&gt; Full path to the processing directory</p></li>
<li><p>binary                -&gt; Results in pkl format?</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="function">
<dt id="normative_parallel.execute_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">execute_nm</code><span class="sig-paren">(</span><em class="sig-param">processing_dir</em>, <em class="sig-param">python_path</em>, <em class="sig-param">job_name</em>, <em class="sig-param">covfile_path</em>, <em class="sig-param">respfile_path</em>, <em class="sig-param">batch_size</em>, <em class="sig-param">memory</em>, <em class="sig-param">duration</em>, <em class="sig-param">normative_path=None</em>, <em class="sig-param">func='estimate'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#execute_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.execute_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is a mother function that executes all parallel normative
modelling routines. Different specifications are possible using the sub-
functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><dl class="simple">
<dt>normative_path     -&gt; Full path to the normative.py. If None (default)</dt><dd><p>then it will automatically retrieves the path from
the installed packeage.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>batch_size         -&gt; Number of features in each batch</p></li>
<li><dl class="simple">
<dt>memory             -&gt; Memory requirements written as string</dt><dd><p>for example 4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duation            -&gt; The approximate duration of the job, a string</dt><dd><p>with HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><p>log_path           -&gt; Pathfor saving log files</p></li>
<li><dl class="simple">
<dt>binary             -&gt; If True uses binary format for response file</dt><dd><p>otherwise it is text</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="function">
<dt id="normative_parallel.qsub_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">qsub_nm</code><span class="sig-paren">(</span><em class="sig-param">job_path</em>, <em class="sig-param">log_path</em>, <em class="sig-param">memory</em>, <em class="sig-param">duration</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#qsub_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.qsub_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<dl class="simple">
<dt>** Input:</dt><dd><ul class="simple">
<li><p>job_path      -&gt; Full path to the job.sh file</p></li>
<li><dl class="simple">
<dt>memory        -&gt; Memory requirements written as string for example</dt><dd><p>4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duation       -&gt; The approximate duration of the job, a string with</dt><dd><p>HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>Submission of the job to the (torque) cluster</p></li>
</ul>
</dd>
</dl>
<p>witten by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="function">
<dt id="normative_parallel.rerun_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">rerun_nm</code><span class="sig-paren">(</span><em class="sig-param">processing_dir</em>, <em class="sig-param">log_path</em>, <em class="sig-param">memory</em>, <em class="sig-param">duration</em>, <em class="sig-param">binary=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#rerun_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.rerun_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function reruns all failed batched in processing_dir after collect_nm
has identified he failed batches</p>
<ul class="simple">
<li><dl class="simple">
<dt>Input:</dt><dd><ul>
<li><p>processing_dir        -&gt; Full path to the processing directory</p></li>
<li><dl class="simple">
<dt>memory                -&gt; Memory requirements written as string</dt><dd><p>for example 4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duration               -&gt; The approximate duration of the job, a</dt><dd><p>string with HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="function">
<dt id="normative_parallel.sbatch_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">sbatch_nm</code><span class="sig-paren">(</span><em class="sig-param">job_path</em>, <em class="sig-param">log_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#sbatch_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.sbatch_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<dl class="simple">
<dt>** Input:</dt><dd><ul class="simple">
<li><p>job_path      -&gt; Full path to the job.sh file</p></li>
<li><p>log_path      -&gt; The logs are currently stored in the working dir</p></li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>Submission of the job to the (torque) cluster</p></li>
</ul>
</dd>
</dl>
<p>witten by (primarily) T Wolfers</p>
</dd></dl>

<dl class="function">
<dt id="normative_parallel.sbatchwrap_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">sbatchwrap_nm</code><span class="sig-paren">(</span><em class="sig-param">processing_dir</em>, <em class="sig-param">python_path</em>, <em class="sig-param">normative_path</em>, <em class="sig-param">job_name</em>, <em class="sig-param">covfile_path</em>, <em class="sig-param">respfile_path</em>, <em class="sig-param">memory</em>, <em class="sig-param">duration</em>, <em class="sig-param">func='estimate'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#sbatchwrap_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.sbatchwrap_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><p>normative_path     -&gt; Full path to the normative.py</p></li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><p>alg                -&gt; which algorithm to use</p></li>
<li><p>configparam        -&gt; configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><ul class="simple">
<li><p>A bash.sh file containing the commands for normative modelling saved
to the processing directory (written to disk)</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers</p>
</dd></dl>

<dl class="function">
<dt id="normative_parallel.split_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">split_nm</code><span class="sig-paren">(</span><em class="sig-param">processing_dir</em>, <em class="sig-param">respfile_path</em>, <em class="sig-param">batch_size</em>, <em class="sig-param">binary</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#split_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.split_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function prepares the input files for normative_parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir    -&gt; Full path to the folder of processing</p></li>
<li><dl class="simple">
<dt>respfile_path     -&gt; Full path to the responsefile.txt</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>batch_size        -&gt; Number of features in each batch</p></li>
<li><dl class="simple">
<dt>testrespfile_path -&gt; Full path to the test responsefile.txt</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>binary            -&gt; If True binary file</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><ul class="simple">
<li><p>The creation of a folder struture for batch-wise processing</p></li>
</ul>
</dd>
</dl>
<p>witten by (primarily) T Wolfers (adapted) SM Kia</p>
</dd></dl>

<span class="target" id="module-trendsurf"></span><dl class="function">
<dt id="trendsurf.create_basis">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">create_basis</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">basis</em>, <em class="sig-param">mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#create_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.create_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a (polynomial) basis set</p>
</dd></dl>

<dl class="function">
<dt id="trendsurf.estimate">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">maskfile</em>, <em class="sig-param">basis</em>, <em class="sig-param">ard=False</em>, <em class="sig-param">outputall=False</em>, <em class="sig-param">saveoutput=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate a trend surface model</p>
<p>This will estimate a trend surface model, independently for each subject.
This is currently fit using a polynomial model of a specified degree.
The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (currently nifti only). Ascii data should be in
tab or space delimited format with the number of voxels in rows and the
number of subjects in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>estimate(filename, maskfile, basis)
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – 4-d nifti file containing the images to be estimated</p></li>
<li><p><strong>maskfile</strong> – nifti mask used to apply to the data</p></li>
<li><p><strong>basis</strong> – model order for the interpolating polynomial</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>yhat - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
<li><p>trendcoeff - coefficients from the trend surface model</p></li>
<li><p>negloglik - Negative log marginal likelihood</p></li>
<li><p>hyp - hyperparameters</p></li>
<li><p>explainedvar - explained variance</p></li>
<li><p>rmse - standardised mean squared error</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="trendsurf.get_args">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">get_args</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.get_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="trendsurf.load_data">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">load_data</code><span class="sig-paren">(</span><em class="sig-param">datafile</em>, <em class="sig-param">maskfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>load 4d nifti data</p>
</dd></dl>

<dl class="function">
<dt id="trendsurf.main">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="trendsurf.write_nii">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">write_nii</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">filename</em>, <em class="sig-param">examplenii</em>, <em class="sig-param">mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#write_nii"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.write_nii" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<span class="target" id="module-rfa"></span><dl class="class">
<dt id="rfa.GPRRFA">
<em class="property">class </em><code class="sig-prename descclassname">rfa.</code><code class="sig-name descname">GPRRFA</code><span class="sig-paren">(</span><em class="sig-param">hyp=None</em>, <em class="sig-param">X=None</em>, <em class="sig-param">y=None</em>, <em class="sig-param">n_feat=None</em>, <em class="sig-param">n_iter=100</em>, <em class="sig-param">tol=0.001</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Random Feature Approximation for Gaussian Process Regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>R = GPRRFA()
hyp = R.estimate(hyp0, X, y)
ys,s2 = R.predict(hyp, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = [ log(sn), log(ell), log(sf) ]  # hyp is a numpy array
</pre></div>
</div>
<p>where sn^2 is the noise variance, ell are lengthscale parameters and
sf^2 is the signal variance. This provides an approximation to the
covariance function:</p>
<blockquote>
<div><p>k(x,z) = x’<a href="#id1"><span class="problematic" id="id2">*</span></a>z + sn2*exp(0.5*(x-z)’<a href="#id3"><span class="problematic" id="id4">*</span></a>Lambda*(x-z))</p>
</div></blockquote>
<p>where Lambda = diag((ell_1^2, … ell_D^2))</p>
<p>Written by A. Marquand</p>
<dl class="method">
<dt id="rfa.GPRRFA.dloglik">
<code class="sig-name descname">dloglik</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.dloglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="method">
<dt id="rfa.GPRRFA.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param">hyp0</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em>, <em class="sig-param">optimizer='lbfgs'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="method">
<dt id="rfa.GPRRFA.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><em class="sig-param">X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.get_n_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rfa.GPRRFA.loglik">
<code class="sig-name descname">loglik</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.loglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="method">
<dt id="rfa.GPRRFA.post">
<code class="sig-name descname">post</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma) and precision (iSigma).</p>
</dd></dl>

<dl class="method">
<dt id="rfa.GPRRFA.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">hyp</em>, <em class="sig-param">X</em>, <em class="sig-param">y</em>, <em class="sig-param">Xs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-fileio"></span><dl class="function">
<dt id="fileio.alphanum_key">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">alphanum_key</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#alphanum_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.alphanum_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.create_mask">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">create_mask</code><span class="sig-paren">(</span><em class="sig-param">data_array</em>, <em class="sig-param">mask</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#create_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.create_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.file_extension">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">file_extension</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_extension"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.file_extension" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.file_stem">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">file_stem</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_stem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.file_stem" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.file_type">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">file_type</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.file_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.load">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">text=False</em>, <em class="sig-param">vol=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.load_ascii">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load_ascii</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_ascii"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load_ascii" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.load_cifti">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load_cifti</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">vol=False</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">rmtmp=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_cifti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load_cifti" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.load_nifti">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load_nifti</code><span class="sig-paren">(</span><em class="sig-param">datafile</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">vol=False</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_nifti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load_nifti" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.load_pd">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load_pd</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_pd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load_pd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.save">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">filename</em>, <em class="sig-param">example=None</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">text=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.save_ascii">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save_ascii</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_ascii"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save_ascii" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.save_cifti">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save_cifti</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">filename</em>, <em class="sig-param">example</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">vol=True</em>, <em class="sig-param">volatlas=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_cifti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save_cifti" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<dl class="function">
<dt id="fileio.save_nifti">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save_nifti</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">filename</em>, <em class="sig-param">examplenii</em>, <em class="sig-param">mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_nifti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save_nifti" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<dl class="function">
<dt id="fileio.save_pd">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save_pd</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_pd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save_pd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.sort_nicely">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">sort_nicely</code><span class="sig-paren">(</span><em class="sig-param">l</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#sort_nicely"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.sort_nicely" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.tryint">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">tryint</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#tryint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.tryint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fileio.vol2vec">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">vol2vec</code><span class="sig-paren">(</span><em class="sig-param">dat</em>, <em class="sig-param">mask</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#vol2vec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.vol2vec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-utils"></span><dl class="class">
<dt id="utils.CustomCV">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">CustomCV</code><span class="sig-paren">(</span><em class="sig-param">train</em>, <em class="sig-param">test</em>, <em class="sig-param">X=None</em>, <em class="sig-param">y=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#CustomCV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.CustomCV" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Custom cross-validation approach. This function does not do much, it
merely provides a wrapper designed to be compatible with
scikit-learn (e.g. sklearn.model_selection…)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> – a list of indices of training splits (each itself a list)</p></li>
<li><p><strong>test</strong> – a list of indices of test splits (each itself a list)</p></li>
</ul>
</dd>
<dt class="field-even">Returns tr</dt>
<dd class="field-even"><p>Indices for training set</p>
</dd>
<dt class="field-odd">Returns te</dt>
<dd class="field-odd"><p>Indices for test set</p>
</dd>
</dl>
<dl class="method">
<dt id="utils.CustomCV.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">y=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#CustomCV.split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.CustomCV.split" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="utils.FDR">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">FDR</code><span class="sig-paren">(</span><em class="sig-param">p_values</em>, <em class="sig-param">alpha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#FDR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.FDR" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the false discovery rate in all voxels for a subject.</p>
</dd></dl>

<dl class="class">
<dt id="utils.WarpAffine">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpAffine</code><a class="reference internal" href="_modules/utils.html#WarpAffine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpAffine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Affine warp
y = a + b*x</p>
<dl class="method">
<dt id="utils.WarpAffine.df">
<code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpAffine.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpAffine.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpAffine.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpAffine.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpAffine.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpAffine.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpAffine.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpAffine.invf">
<code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpAffine.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpAffine.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpAffine.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param">mu, s2, param, percentiles=[0.025, 0.975]</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpAffine.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="utils.WarpBase">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpBase</code><a class="reference internal" href="_modules/utils.html#WarpBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for likelihood warping following:
Rios and Torab (2019) Compositionally-warped Gaussian processes
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0893608019301856">https://www.sciencedirect.com/science/article/pii/S0893608019301856</a></p>
<p>All Warps must define the following methods:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Warp.get_n_params() - return number of parameters
Warp.f() - warping function (Non-Gaussian field -&gt; Gaussian)
Warp.invf() - inverse warp
Warp.df() - derivatives
Warp.warp_predictions() - compute predictive distribution
</pre></div>
</div>
<dl class="method">
<dt id="utils.WarpBase.df">
<em class="property">abstract </em><code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">param</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpBase.f">
<em class="property">abstract </em><code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">param</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpBase.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.get_n_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpBase.invf">
<em class="property">abstract </em><code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">param</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpBase.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param">mu, s2, param, percentiles=[0.025, 0.975]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.warp_predictions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="utils.WarpBoxCox">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpBoxCox</code><a class="reference internal" href="_modules/utils.html#WarpBoxCox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBoxCox" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Box cox transform having a single parameter (lambda), i.e.</p>
<p>y = (sign(x) * abs(x) ** lamda - 1) / lambda</p>
<p>This follows the generalization in Bicken and Doksum (1981) JASA 76
and allows x to assume negative values.</p>
<dl class="method">
<dt id="utils.WarpBoxCox.df">
<code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBoxCox.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBoxCox.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpBoxCox.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBoxCox.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBoxCox.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpBoxCox.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpBoxCox.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpBoxCox.invf">
<code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBoxCox.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBoxCox.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpBoxCox.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param">mu, s2, param, percentiles=[0.025, 0.975]</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpBoxCox.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="utils.WarpCompose">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpCompose</code><span class="sig-paren">(</span><em class="sig-param">warpnames=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpCompose" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Composition of warps. These are passed in as an array and
intialised automatically. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>W = WarpCompose((&#39;WarpBoxCox&#39;, &#39;WarpAffine&#39;))
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="method">
<dt id="utils.WarpCompose.df">
<code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpCompose.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpCompose.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpCompose.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpCompose.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpCompose.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpCompose.invf">
<code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpCompose.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpCompose.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param">mu, s2, param, percentiles=[0.025, 0.975]</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpCompose.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="utils.WarpSinArcsinh">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpSinArcsinh</code><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpSinArcsinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Sin-hyperbolic arcsin warp having two parameters (a, b) and defined by</p>
<p>y = sinh(b *  arcsinh(x) - a)</p>
<p>see Jones and Pewsey A (2009) Biometrika, 96 (4) (2009)</p>
<dl class="method">
<dt id="utils.WarpSinArcsinh.df">
<code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpSinArcsinh.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpSinArcsinh.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpSinArcsinh.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpSinArcsinh.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpSinArcsinh.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpSinArcsinh.invf">
<code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpSinArcsinh.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="method">
<dt id="utils.WarpSinArcsinh.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param">mu, s2, param, percentiles=[0.025, 0.975]</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpSinArcsinh.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="utils.bashwrap">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">bashwrap</code><span class="sig-paren">(</span><em class="sig-param">processing_dir</em>, <em class="sig-param">python_path</em>, <em class="sig-param">script_command</em>, <em class="sig-param">job_name</em>, <em class="sig-param">bash_environment=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#bashwrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.bashwrap" title="Permalink to this definition">¶</a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<dl>
<dt>** Input:</dt><dd><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><p>command to execute -&gt; python command to execute</p></li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>bash_environment   -&gt; A file containing the necessary commands</dt><dd><p>for your bash environment to work</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>A bash.sh file containing the commands for normative modelling saved</p></li>
</ul>
<p>to the processing directory</p>
</dd>
</dl>
<p>witten by Thomas Wolfers</p>
</dd></dl>

<dl class="function">
<dt id="utils.calibration_error">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">calibration_error</code><span class="sig-paren">(</span><em class="sig-param">Y</em>, <em class="sig-param">m</em>, <em class="sig-param">s</em>, <em class="sig-param">cal_levels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#calibration_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.calibration_error" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="utils.compute_MSLL">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">compute_MSLL</code><span class="sig-paren">(</span><em class="sig-param">ytrue</em>, <em class="sig-param">ypred</em>, <em class="sig-param">ypred_var</em>, <em class="sig-param">train_mean=None</em>, <em class="sig-param">train_var=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_MSLL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compute_MSLL" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the MSLL or MLL (not standardized) if ‘train_mean’ and ‘train_var’ are None.</p>
<p>Basic usage:</p>
<p>MSLL = compute_MSLL(ytrue, ypred, ytrue_sig, noise_variance, train_mean, train_var)</p>
<p>where</p>
<dl class="simple">
<dt>:ytrue<span class="classifier">n*p matrix of true values where n is the number of samples</span></dt><dd><p>and p is the number of features.</p>
</dd>
<dt>:ypred<span class="classifier">n*p matrix of predicted values where n is the number of samples</span></dt><dd><p>and p is the number of features.</p>
</dd>
<dt>:ypred_var<span class="classifier">n*p matrix of summed noise variances and prediction variances where n is the number of samples</span></dt><dd><p>and p is the number of features.</p>
</dd>
</dl>
<p>:train_mean     : p dimensional vector of mean values of the training data for each feature.
:train_var      : p dimensional vector of covariances of the training data for each feature.</p>
<p>:returns loss   : p dimensional vector of MSLL or MLL for each feature.</p>
</dd></dl>

<dl class="function">
<dt id="utils.compute_pearsonr">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">compute_pearsonr</code><span class="sig-paren">(</span><em class="sig-param">A</em>, <em class="sig-param">B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_pearsonr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compute_pearsonr" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually computes the Pearson correlation between two matrices.</p>
<p>Basic usage:</p>
<p>compute_pearsonr(A, B)</p>
<p>where</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – an N * M data array</p></li>
<li><p><strong>cov</strong> – an N * M array</p></li>
</ul>
</dd>
<dt class="field-even">Returns Rho</dt>
<dd class="field-even"><p>N dimensional vector of correlation coefficients</p>
</dd>
<dt class="field-odd">Returns ys2</dt>
<dd class="field-odd"><p>N dimensional vector of p-values</p>
</dd>
</dl>
<p>Notes:</p>
<p>This function is useful when M is large and only the diagonal entries
of the resulting correlation matrix are of interest. This function
does not compute the full correlation matrix as an intermediate step</p>
</dd></dl>

<dl class="function">
<dt id="utils.create_bspline_basis">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">create_bspline_basis</code><span class="sig-paren">(</span><em class="sig-param">xmin</em>, <em class="sig-param">xmax</em>, <em class="sig-param">p=3</em>, <em class="sig-param">nknots=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_bspline_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.create_bspline_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a Bspline basis set where:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – order of spline (3 = cubic)</p></li>
<li><p><strong>nknots</strong> – number of knots (endpoints only counted once)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.create_poly_basis">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">create_poly_basis</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">dimpoly</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_poly_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.create_poly_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a polynomial basis expansion of the specified order</p>
</dd></dl>

<dl class="function">
<dt id="utils.divergence_plot">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">divergence_plot</code><span class="sig-paren">(</span><em class="sig-param">nm</em>, <em class="sig-param">ylim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#divergence_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.divergence_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="utils.explained_var">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">explained_var</code><span class="sig-paren">(</span><em class="sig-param">ytrue</em>, <em class="sig-param">ypred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#explained_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.explained_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the explained variance of predicted values.</p>
<p>Basic usage:</p>
<p>exp_var = explained_var(ytrue, ypred)</p>
<p>where</p>
<dl class="field-list simple">
<dt class="field-odd">Ytrue</dt>
<dd class="field-odd"><p>n*p matrix of true values where n is the number of samples
and p is the number of features.</p>
</dd>
<dt class="field-even">Ypred</dt>
<dd class="field-even"><p>n*p matrix of predicted values where n is the number of samples
and p is the number of features.</p>
</dd>
<dt class="field-odd">Returns exp_var</dt>
<dd class="field-odd"><p>p dimentional vector of explained variances for each feature.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.extreme_value_prob">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">extreme_value_prob</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">NPM</em>, <em class="sig-param">perc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#extreme_value_prob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.extreme_value_prob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="utils.extreme_value_prob_fit">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">extreme_value_prob_fit</code><span class="sig-paren">(</span><em class="sig-param">NPM</em>, <em class="sig-param">perc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#extreme_value_prob_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.extreme_value_prob_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="utils.qsub">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">qsub</code><span class="sig-paren">(</span><em class="sig-param">job_path</em>, <em class="sig-param">memory</em>, <em class="sig-param">duration</em>, <em class="sig-param">logdir=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#qsub"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.qsub" title="Permalink to this definition">¶</a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<dl class="simple">
<dt>** Input:</dt><dd><ul class="simple">
<li><p>job_path      -&gt; Full path to the job.sh file</p></li>
<li><dl class="simple">
<dt>memory        -&gt; Memory requirements written as string for example</dt><dd><p>4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duration       -&gt; The approximate duration of the job, a string with</dt><dd><p>HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>Submission of the job to the (torque) cluster</p></li>
</ul>
</dd>
</dl>
<p>witten by Thomas Wolfers</p>
</dd></dl>

<dl class="function">
<dt id="utils.ravel_2D">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">ravel_2D</code><span class="sig-paren">(</span><em class="sig-param">a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#ravel_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.ravel_2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="utils.simulate_data">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">simulate_data</code><span class="sig-paren">(</span><em class="sig-param">method='linear'</em>, <em class="sig-param">n_samples=100</em>, <em class="sig-param">n_features=1</em>, <em class="sig-param">n_grps=1</em>, <em class="sig-param">working_dir=None</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">random_state=None</em>, <em class="sig-param">noise=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#simulate_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.simulate_data" title="Permalink to this definition">¶</a></dt>
<dd><p>This function simulates linear synthetic data for testing pcntoolkit methods.</p>
<ul>
<li><p>Inputs:</p>
<blockquote>
<div><ul class="simple">
<li><p>method: simulate ‘linear’ or ‘non-linear’ function.</p></li>
<li><p>n_samples: number of samples in each group of the training and test sets.</p></li>
</ul>
<p>If it is an int then the same sample number will be used for all groups.
It can be also a list of size of n_grps that decides the number of samples
in each group (default=100).</p>
<ul class="simple">
<li><p>n_features: A positive integer that decides the number of features</p></li>
</ul>
<p>(default=1).</p>
<ul class="simple">
<li><p>n_grps: A positive integer that decides the number of groups in data</p></li>
</ul>
<p>(default=1).</p>
<ul class="simple">
<li><p>working_dir: Directory to save data (default=None).</p></li>
<li><p>plot: Boolean to plot the simulated training data (default=False).</p></li>
<li><p>random_state: random state for generating random numbers (Default=None).</p></li>
<li><p>noise: Type of added noise to the data. The options are ‘gaussian’,</p></li>
</ul>
<p>‘exponential’, and ‘hetero_gaussian’ (The defauls is None.).</p>
</div></blockquote>
</li>
<li><p>Outputs:</p>
<blockquote>
<div><ul class="simple">
<li><p>X_train, Y_train, grp_id_train, X_test, Y_test, grp_id_test, coef</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="utils.squared_dist">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">squared_dist</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">z=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#squared_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.squared_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>compute sum((x-z) ** 2) for all vectors in a 2d array</p>
</dd></dl>

<dl class="function">
<dt id="utils.threshold_NPM">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">threshold_NPM</code><span class="sig-paren">(</span><em class="sig-param">NPMs</em>, <em class="sig-param">fdr_thr=0.05</em>, <em class="sig-param">npm_thr=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#threshold_NPM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.threshold_NPM" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute voxels with significant NPMs.</p>
</dd></dl>

<dl class="function">
<dt id="utils.unravel_2D">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">unravel_2D</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#unravel_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.unravel_2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pages/updates.html" class="btn btn-neutral float-right" title="Updates" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pages/pcntoolkit_background.html" class="btn btn-neutral float-left" title="PCNtoolkit Background" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Andre F. Marquand

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>