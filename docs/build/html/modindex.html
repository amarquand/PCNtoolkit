

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Module Index &mdash; Predictive Clinical Neuroscience Toolkit 0.20 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/pcntoolkit_tabs.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/pcntoolkit.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/pcntoolkit_nomaxwidth.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Predictive Clinical Neuroscience toolkit" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Predictive Clinical Neuroscience Toolkit
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Module Index</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Predictive Clinical Neuroscience Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Module Index</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/modindex.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-bayesreg">
<span id="module-index"></span><h1>Module Index<a class="headerlink" href="#module-bayesreg" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="bayesreg.BLR">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">bayesreg.</span></span><span class="sig-name descname"><span class="pre">BLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bayesian linear regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>B = BLR()
hyp = B.estimate(hyp0, X, y)
ys,s2 = B.predict(hyp, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = ( log(beta), log(alpha) )  # hyp is a list or numpy array
</pre></div>
</div>
<p>The implementation and notation mostly follows Bishop (2006).
The hyperparameter beta is the noise precision and alpha is the precision
over lengthscale parameters. This can be either a scalar variable (a
common lengthscale for all input variables), or a vector of length D (a
different lengthscale for each input variable, derived using an automatic
relevance determination formulation). These are estimated using conjugate
gradient optimisation of the marginal likelihood.</p>
<p>Reference:
Bishop (2006) Pattern Recognition and Machine Learning, Springer</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.dloglik">
<span class="sig-name descname"><span class="pre">dloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.dloglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.loglik">
<span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma_a) and precision (Lambda_a).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayesreg.BLR.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_groups_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayesreg.BLR.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-gp"></span><dl class="py class">
<dt class="sig sig-object py" id="gp.CovBase">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for covariance functions.</p>
<p>All covariance functions must define the following methods:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CovFunction.get_n_params()
CovFunction.cov()
CovFunction.xcov()
CovFunction.dcov()
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovBase.cov">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovBase.dcov">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovBase.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.get_n_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovBase.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovLin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovLin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovLin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Linear covariance function (no hyperparameters)</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovLin.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovLin.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovLin.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovLin.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovLin.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovLin.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovSqExp">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovSqExp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Ordinary squared exponential covariance function.
The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = ( log(ell), log(sf) )
</pre></div>
</div>
<p>where ell is a lengthscale parameter and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExp.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExp.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExp.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExp.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExp.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExp.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovSqExpARD">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovSqExpARD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExpARD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Squared exponential covariance function with ARD
The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = (log(ell_1, ..., log_ell_D), log(sf))
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExpARD.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExpARD.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExpARD.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSqExpARD.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSqExpARD.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExpARD.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.CovSum">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">CovSum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfuncnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Sum of covariance functions. These are passed in as a cell array and
intialised automatically. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C = CovSum(x,(CovLin, CovSqExpARD))
C = CovSum.cov(x, )
</pre></div>
</div>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>theta = ( log(ell_1, ..., log_ell_D), log(sf2) )
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSum.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSum.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSum.dcov">
<span class="sig-name descname"><span class="pre">dcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.dcov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.CovSum.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.CovSum.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSum.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gp.GPR">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gp.</span></span><span class="sig-name descname"><span class="pre">GPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gaussian process regression</p>
<p>Estimation and prediction of Gaussian process regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>G = GPR()
hyp = B.estimate(hyp0, cov, X, y)
ys, ys2 = B.predict(hyp, cov, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters</p></li>
<li><p><strong>cov</strong> – covariance function</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = ( log(sn), (cov function params) )  # hyp is a list or array
</pre></div>
</div>
<p>The implementation and notation  follows Rasmussen and Williams (2006).
As in the gpml toolbox, these parameters are estimated using conjugate
gradient optimisation of the marginal likelihood. Note that there is no
explicit mean function, thus the gpr routines are limited to modelling
zero-mean processes.</p>
<p>Reference:
C. Rasmussen and C. Williams (2006) Gaussian Processes for Machine Learning</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.dloglik">
<span class="sig-name descname"><span class="pre">dloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.dloglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cg'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.loglik">
<span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gp.GPR.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gp.GPR.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-normative_parallel"></span><dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.bashwrap_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">bashwrap_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normative_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#bashwrap_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.bashwrap_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><p>normative_path     -&gt; Full path to the normative.py</p></li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><p>alg                -&gt; which algorithm to use</p></li>
<li><p>configparam        -&gt; configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><ul class="simple">
<li><p>A bash.sh file containing the commands for normative modelling saved
to the processing directory (written to disk)</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.collect_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">collect_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputsuffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_estimate'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#collect_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.collect_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function checks and collects all batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir        -&gt; Full path to the processing directory</p></li>
<li><dl class="simple">
<dt>collect               -&gt; If True data is checked for failed batches</dt><dd><p>and collected; if False data is just checked</p>
</dd>
</dl>
</li>
<li><p>binary                -&gt; Results in pkl format?</p></li>
</ul>
</dd>
<dt class="field-even">Ouptuts</dt>
<dd class="field-even"><ul class="simple">
<li><p>Text files containing all results accross all batches the combined
output (written to disk)</p></li>
<li><p>returns 0 if batches fail, 1 otherwise</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.delete_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">delete_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#delete_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.delete_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function deletes all processing for normative modelling and just
keeps the combined output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir        -&gt; Full path to the processing directory</p></li>
<li><p>binary                -&gt; Results in pkl format?</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.execute_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">execute_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normative_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#execute_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.execute_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is a mother function that executes all parallel normative
modelling routines. Different specifications are possible using the sub-
functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><dl class="simple">
<dt>normative_path     -&gt; Full path to the normative.py. If None (default)</dt><dd><p>then it will automatically retrieves the path from
the installed packeage.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>batch_size         -&gt; Number of features in each batch</p></li>
<li><dl class="simple">
<dt>memory             -&gt; Memory requirements written as string</dt><dd><p>for example 4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duation            -&gt; The approximate duration of the job, a string</dt><dd><p>with HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><p>log_path           -&gt; Pathfor saving log files</p></li>
<li><dl class="simple">
<dt>binary             -&gt; If True uses binary format for response file</dt><dd><p>otherwise it is text</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.qsub_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">qsub_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#qsub_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.qsub_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<dl class="simple">
<dt>** Input:</dt><dd><ul class="simple">
<li><p>job_path      -&gt; Full path to the job.sh file</p></li>
<li><dl class="simple">
<dt>memory        -&gt; Memory requirements written as string for example</dt><dd><p>4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duation       -&gt; The approximate duration of the job, a string with</dt><dd><p>HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>Submission of the job to the (torque) cluster</p></li>
</ul>
</dd>
</dl>
<p>witten by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.rerun_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">rerun_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#rerun_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.rerun_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function reruns all failed batched in processing_dir after collect_nm
has identified he failed batches</p>
<ul class="simple">
<li><dl class="simple">
<dt>Input:</dt><dd><ul>
<li><p>processing_dir        -&gt; Full path to the processing directory</p></li>
<li><dl class="simple">
<dt>memory                -&gt; Memory requirements written as string</dt><dd><p>for example 4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duration               -&gt; The approximate duration of the job, a</dt><dd><p>string with HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.sbatch_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">sbatch_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#sbatch_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.sbatch_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<dl class="simple">
<dt>** Input:</dt><dd><ul class="simple">
<li><p>job_path      -&gt; Full path to the job.sh file</p></li>
<li><p>log_path      -&gt; The logs are currently stored in the working dir</p></li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>Submission of the job to the (torque) cluster</p></li>
</ul>
</dd>
</dl>
<p>witten by (primarily) T Wolfers</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.sbatchwrap_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">sbatchwrap_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normative_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'estimate'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#sbatchwrap_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.sbatchwrap_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><p>normative_path     -&gt; Full path to the normative.py</p></li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><p>alg                -&gt; which algorithm to use</p></li>
<li><p>configparam        -&gt; configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><ul class="simple">
<li><p>A bash.sh file containing the commands for normative modelling saved
to the processing directory (written to disk)</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normative_parallel.split_nm">
<span class="sig-prename descclassname"><span class="pre">normative_parallel.</span></span><span class="sig-name descname"><span class="pre">split_nm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respfile_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#split_nm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normative_parallel.split_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function prepares the input files for normative_parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir    -&gt; Full path to the folder of processing</p></li>
<li><dl class="simple">
<dt>respfile_path     -&gt; Full path to the responsefile.txt</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>batch_size        -&gt; Number of features in each batch</p></li>
<li><dl class="simple">
<dt>testrespfile_path -&gt; Full path to the test responsefile.txt</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>binary            -&gt; If True binary file</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><ul class="simple">
<li><p>The creation of a folder struture for batch-wise processing</p></li>
</ul>
</dd>
</dl>
<p>witten by (primarily) T Wolfers (adapted) SM Kia</p>
</dd></dl>

<span class="target" id="module-trendsurf"></span><dl class="py function">
<dt class="sig sig-object py" id="trendsurf.create_basis">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">create_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#create_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.create_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a (polynomial) basis set</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.estimate">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveoutput</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate a trend surface model</p>
<p>This will estimate a trend surface model, independently for each subject.
This is currently fit using a polynomial model of a specified degree.
The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (currently nifti only). Ascii data should be in
tab or space delimited format with the number of voxels in rows and the
number of subjects in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>estimate(filename, maskfile, basis)
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – 4-d nifti file containing the images to be estimated</p></li>
<li><p><strong>maskfile</strong> – nifti mask used to apply to the data</p></li>
<li><p><strong>basis</strong> – model order for the interpolating polynomial</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>yhat - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
<li><p>trendcoeff - coefficients from the trend surface model</p></li>
<li><p>negloglik - Negative log marginal likelihood</p></li>
<li><p>hyp - hyperparameters</p></li>
<li><p>explainedvar - explained variance</p></li>
<li><p>rmse - standardised mean squared error</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.get_args">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">get_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#get_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.get_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.load_data">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>load 4d nifti data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.main">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="trendsurf.write_nii">
<span class="sig-prename descclassname"><span class="pre">trendsurf.</span></span><span class="sig-name descname"><span class="pre">write_nii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">examplenii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#write_nii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trendsurf.write_nii" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<span class="target" id="module-rfa"></span><dl class="py class">
<dt class="sig sig-object py" id="rfa.GPRRFA">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rfa.</span></span><span class="sig-name descname"><span class="pre">GPRRFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Random Feature Approximation for Gaussian Process Regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>R = GPRRFA()
hyp = R.estimate(hyp0, X, y)
ys,s2 = R.predict(hyp, X, y, Xs)
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hyp = [ log(sn), log(ell), log(sf) ]  # hyp is a numpy array
</pre></div>
</div>
<p>where sn^2 is the noise variance, ell are lengthscale parameters and
sf^2 is the signal variance. This provides an approximation to the
covariance function:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>k(x,z) = x&#39;*z + sn2*exp(0.5*(x-z)&#39;*Lambda*(x-z))
</pre></div>
</div>
<p>where Lambda = diag((ell_1^2, … ell_D^2))</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.dloglik">
<span class="sig-name descname"><span class="pre">dloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.dloglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lbfgs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.get_n_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.loglik">
<span class="sig-name descname"><span class="pre">loglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.loglik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma) and precision (iSigma).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rfa.GPRRFA.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rfa.GPRRFA.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-fileio"></span><dl class="py function">
<dt class="sig sig-object py" id="fileio.alphanum_key">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">alphanum_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#alphanum_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.alphanum_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.create_mask">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">create_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#create_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.create_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.file_extension">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">file_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_extension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.file_extension" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.file_stem">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">file_stem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_stem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.file_stem" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.file_type">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">file_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.file_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_ascii">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_ascii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_ascii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_ascii" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_cifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_cifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmtmp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_cifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_cifti" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_nifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_nifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_nifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_nifti" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.load_pd">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">load_pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_pd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.load_pd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.predictive_interval">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">predictive_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s2_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#predictive_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.predictive_interval" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_ascii">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_ascii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_ascii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_ascii" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_cifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_cifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volatlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_cifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_cifti" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_nifti">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_nifti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">examplenii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_nifti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_nifti" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.save_pd">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">save_pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_pd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.save_pd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.sort_nicely">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">sort_nicely</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#sort_nicely"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.sort_nicely" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.tryint">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">tryint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#tryint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.tryint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fileio.vol2vec">
<span class="sig-prename descclassname"><span class="pre">fileio.</span></span><span class="sig-name descname"><span class="pre">vol2vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#vol2vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fileio.vol2vec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-utils"></span><dl class="py class">
<dt class="sig sig-object py" id="utils.CustomCV">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">CustomCV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#CustomCV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.CustomCV" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Custom cross-validation approach. This function does not do much, it
merely provides a wrapper designed to be compatible with
scikit-learn (e.g. sklearn.model_selection…)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> – a list of indices of training splits (each itself a list)</p></li>
<li><p><strong>test</strong> – a list of indices of test splits (each itself a list)</p></li>
</ul>
</dd>
<dt class="field-even">Returns tr</dt>
<dd class="field-even"><p>Indices for training set</p>
</dd>
<dt class="field-odd">Returns te</dt>
<dd class="field-odd"><p>Indices for test set</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="utils.CustomCV.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#CustomCV.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.CustomCV.split" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.FDR">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">FDR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#FDR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.FDR" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the false discovery rate in all voxels for a subject.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.WarpAffine">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">WarpAffine</span></span><a class="reference internal" href="_modules/utils.html#WarpAffine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpAffine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Affine warp
y = a + b*x</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpAffine.df">
<span class="sig-name descname"><span class="pre">df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpAffine.df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpAffine.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpAffine.f">
<span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpAffine.f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpAffine.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpAffine.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpAffine.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpAffine.invf">
<span class="sig-name descname"><span class="pre">invf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpAffine.invf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpAffine.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpAffine.warp_predictions">
<span class="sig-name descname"><span class="pre">warp_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.025,</span> <span class="pre">0.975]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpAffine.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.WarpBase">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">WarpBase</span></span><a class="reference internal" href="_modules/utils.html#WarpBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for likelihood warping following:
Rios and Torab (2019) Compositionally-warped Gaussian processes
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0893608019301856">https://www.sciencedirect.com/science/article/pii/S0893608019301856</a></p>
<p>All Warps must define the following methods:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Warp.get_n_params() - return number of parameters
Warp.f() - warping function (Non-Gaussian field -&gt; Gaussian)
Warp.invf() - inverse warp
Warp.df() - derivatives
Warp.warp_predictions() - compute predictive distribution
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBase.df">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBase.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBase.f">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBase.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBase.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.get_n_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBase.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBase.invf">
<em class="property"><span class="pre">abstract</span> </em><span class="sig-name descname"><span class="pre">invf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.invf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBase.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBase.warp_predictions">
<span class="sig-name descname"><span class="pre">warp_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.025,</span> <span class="pre">0.975]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.warp_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBase.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.WarpBoxCox">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">WarpBoxCox</span></span><a class="reference internal" href="_modules/utils.html#WarpBoxCox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBoxCox" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Box cox transform having a single parameter (lambda), i.e.</p>
<p>y = (sign(x) * abs(x) ** lamda - 1) / lambda</p>
<p>This follows the generalization in Bicken and Doksum (1981) JASA 76
and allows x to assume negative values.</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBoxCox.df">
<span class="sig-name descname"><span class="pre">df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBoxCox.df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBoxCox.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBoxCox.f">
<span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBoxCox.f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBoxCox.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBoxCox.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpBoxCox.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBoxCox.invf">
<span class="sig-name descname"><span class="pre">invf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBoxCox.invf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpBoxCox.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpBoxCox.warp_predictions">
<span class="sig-name descname"><span class="pre">warp_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.025,</span> <span class="pre">0.975]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpBoxCox.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.WarpCompose">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">WarpCompose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warpnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpCompose" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Composition of warps. These are passed in as an array and
intialised automatically. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>W = WarpCompose((&#39;WarpBoxCox&#39;, &#39;WarpAffine&#39;))
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpCompose.df">
<span class="sig-name descname"><span class="pre">df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose.df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpCompose.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpCompose.f">
<span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose.f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpCompose.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpCompose.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpCompose.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpCompose.invf">
<span class="sig-name descname"><span class="pre">invf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose.invf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpCompose.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpCompose.warp_predictions">
<span class="sig-name descname"><span class="pre">warp_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.025,</span> <span class="pre">0.975]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpCompose.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.WarpSinArcsinh">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">WarpSinArcsinh</span></span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpSinArcsinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Sin-hyperbolic arcsin warp having two parameters (a, b) and defined by</p>
<p>y = sinh(b *  arcsinh(x) - a)</p>
<p>Using the parametrisation of Rios et al, Neural Networks 118 (2017)
where a controls skew and b controls kurtosis, such that:</p>
<blockquote>
<div><p>a = 0 : symmetric
a &gt; 0 : positive skew
a &lt; 0 : negative skew
b = 1 : mesokurtic
b &gt; 1 : leptokurtic
b &lt; 1 : platykurtic</p>
</div></blockquote>
<p>where b &gt; 0. However, it is more convenentent to use an alternative
parameterisation, where</p>
<p>y = sinh(b * arcsinh(x) + epsilon * b)</p>
<p>and a = -epsilon*b</p>
<p>see Jones and Pewsey A (2009) Biometrika, 96 (4) (2009)</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpSinArcsinh.df">
<span class="sig-name descname"><span class="pre">df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh.df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpSinArcsinh.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpSinArcsinh.f">
<span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh.f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpSinArcsinh.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpSinArcsinh.get_n_params">
<span class="sig-name descname"><span class="pre">get_n_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpSinArcsinh.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpSinArcsinh.invf">
<span class="sig-name descname"><span class="pre">invf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh.invf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.WarpSinArcsinh.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.WarpSinArcsinh.warp_predictions">
<span class="sig-name descname"><span class="pre">warp_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.025,</span> <span class="pre">0.975]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpSinArcsinh.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.bashwrap">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">bashwrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processing_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">script_command</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bash_environment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#bashwrap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.bashwrap" title="Permalink to this definition">¶</a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>python_path</strong> – Full path to the python distribution</p></li>
<li><p><strong>script_command</strong> – python command to execute</p></li>
<li><p><strong>job_name</strong> – Name for the bash script output by this function</p></li>
<li><p><strong>covfile_path</strong> – Full path to covariates</p></li>
<li><p><strong>respfile_path</strong> – Full path to response variables</p></li>
<li><p><strong>cv_folds</strong> – Number of cross validations</p></li>
<li><p><strong>testcovfile_path</strong> – Full path to test covariates</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to tes responses</p></li>
<li><p><strong>bash_environment</strong> – A file containing enviornment specific commands</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A .sh file containing the commands for normative modelling</p>
</dd>
</dl>
<p>witten by Thomas Wolfers</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.calibration_error">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">calibration_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_levels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#calibration_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.calibration_error" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.compute_MSLL">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">compute_MSLL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_MSLL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.compute_MSLL" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the MSLL or MLL (not standardized) if ‘train_mean’ and ‘train_var’ are None.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MSLL = compute_MSLL(ytrue, ypred, ytrue_sig, noise_variance, train_mean, train_var)
</pre></div>
</div>
<p>where</p>
<dl class="simple">
<dt>:param ytrue<span class="classifier">n*p matrix of true values where n is the number of samples</span></dt><dd><p>and p is the number of features.</p>
</dd>
<dt>:param ypred<span class="classifier">n*p matrix of predicted values where n is the number of samples</span></dt><dd><p>and p is the number of features.</p>
</dd>
<dt>:param ypred_var<span class="classifier">n*p matrix of summed noise variances and prediction variances where n is the number of samples</span></dt><dd><p>and p is the number of features.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>train_mean</strong> – p dimensional vector of mean values of the training data for each feature.</p>
</dd>
</dl>
<p>:param train_var : p dimensional vector of covariances of the training data for each feature.</p>
<p>:returns loss    : p dimensional vector of MSLL or MLL for each feature.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.compute_pearsonr">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">compute_pearsonr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_pearsonr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.compute_pearsonr" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually computes the Pearson correlation between two matrices.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>compute_pearsonr(A, B)
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – an N * M data array</p></li>
<li><p><strong>cov</strong> – an N * M array</p></li>
</ul>
</dd>
<dt class="field-even">Returns Rho</dt>
<dd class="field-even"><p>N dimensional vector of correlation coefficients</p>
</dd>
<dt class="field-odd">Returns ys2</dt>
<dd class="field-odd"><p>N dimensional vector of p-values</p>
</dd>
</dl>
<p>Notes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>This function is useful when M is large and only the diagonal entries
of the resulting correlation matrix are of interest. This function
does not compute the full correlation matrix as an intermediate step
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.create_bspline_basis">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">create_bspline_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nknots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_bspline_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.create_bspline_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a Bspline basis set where:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – order of spline (3 = cubic)</p></li>
<li><p><strong>nknots</strong> – number of knots (endpoints only counted once)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.create_poly_basis">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">create_poly_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimpoly</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_poly_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.create_poly_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a polynomial basis expansion of the specified order</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.divergence_plot">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">divergence_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#divergence_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.divergence_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.explained_var">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">explained_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ytrue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ypred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#explained_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.explained_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the explained variance of predicted values.</p>
<p>Basic usage:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>exp_var = explained_var(ytrue, ypred)
</pre></div>
</div>
<p>where</p>
<dl class="field-list simple">
<dt class="field-odd">Ytrue</dt>
<dd class="field-odd"><p>n*p matrix of true values where n is the number of samples
and p is the number of features.</p>
</dd>
<dt class="field-even">Ypred</dt>
<dd class="field-even"><p>n*p matrix of predicted values where n is the number of samples
and p is the number of features.</p>
</dd>
<dt class="field-odd">Returns exp_var</dt>
<dd class="field-odd"><p>p dimentional vector of explained variances for each feature.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.extreme_value_prob">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">extreme_value_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NPM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#extreme_value_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.extreme_value_prob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.extreme_value_prob_fit">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">extreme_value_prob_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NPM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#extreme_value_prob_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.extreme_value_prob_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.load_freesurfer_measure">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">load_freesurfer_measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subjects_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#load_freesurfer_measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.load_freesurfer_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a utility function to load different Freesurfer measures in a pandas
Dataframe.</p>
<dl>
<dt>Inputs:</dt><dd><ul class="simple">
<li><p>measure: a string that defines the type of Freesurfer measure we want</p></li>
</ul>
<dl class="simple">
<dt>to load. The options include:</dt><dd><ul class="simple">
<li><p>‘NumVert’: Number of Vertices in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘SurfArea: Surface area for each cortical area based on Destrieux atlas.</p></li>
<li><p>‘GrayVol’: Gary matter volume in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘ThickAvg’: Average Cortical thinckness in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘ThickStd’: STD of Cortical thinckness in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘MeanCurv’: Integrated Rectified Mean Curvature in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘GausCurv’: Integrated Rectified Gaussian Curvature in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘FoldInd’: Folding Index in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘CurvInd’: Intrinsic Curvature Index in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘brain’: Brain Segmentation Statistics from aseg.stats file.</p></li>
<li><p>‘subcortical_volumes’: Subcortical areas volume.</p></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li><p>data_path: a string that specifies the path to the main Freesurfer folder.</p></li>
<li><p>subjects_list: A Pythin list containing the list of subject names to load the data for.</p></li>
</ul>
<p>The subject names should match the folder name for each subject’s Freesurfer data folder.</p>
</dd>
<dt>Outputs:</dt><dd><ul class="simple">
<li><p>df: A pandas datafrmae containing the subject names as Index and target Freesurfer measures.</p></li>
<li><p>missing_subs: A Python list of subject names that miss the target Freesurefr measures.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.qsub">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">qsub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#qsub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.qsub" title="Permalink to this definition">¶</a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<dl class="simple">
<dt>** Input:</dt><dd><ul class="simple">
<li><p>job_path      -&gt; Full path to the job.sh file</p></li>
<li><dl class="simple">
<dt>memory        -&gt; Memory requirements written as string for example</dt><dd><p>4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duration       -&gt; The approximate duration of the job, a string with</dt><dd><p>HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>Submission of the job to the (torque) cluster</p></li>
</ul>
</dd>
</dl>
<p>witten by Thomas Wolfers</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.ravel_2D">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">ravel_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#ravel_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.ravel_2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.scaler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">scaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaler_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standardize'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#scaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.scaler.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#scaler.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.scaler.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.scaler.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust_outliers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#scaler.fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.scaler.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.scaler.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#scaler.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.scaler.inverse_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.scaler.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust_outliers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#scaler.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.scaler.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.simulate_data">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">simulate_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_grps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#simulate_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.simulate_data" title="Permalink to this definition">¶</a></dt>
<dd><p>This function simulates linear synthetic data for testing pcntoolkit methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> – simulate ‘linear’ or ‘non-linear’ function.</p></li>
<li><p><strong>n_samples</strong> – number of samples in each group of the training and test sets.
If it is an int then the same sample number will be used for all groups.
It can be also a list of size of n_grps that decides the number of samples
in each group (default=100).</p></li>
<li><p><strong>n_features</strong> – A positive integer that decides the number of features
(default=1).</p></li>
<li><p><strong>n_grps</strong> – A positive integer that decides the number of groups in data
(default=1).</p></li>
<li><p><strong>working_dir</strong> – Directory to save data (default=None).</p></li>
<li><p><strong>plot</strong> – Boolean to plot the simulated training data (default=False).</p></li>
<li><p><strong>random_state</strong> – random state for generating random numbers (Default=None).</p></li>
<li><p><strong>noise</strong> – Type of added noise to the data. The options are ‘gaussian’,
‘exponential’, and ‘hetero_gaussian’ (The defauls is None.).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X_train, Y_train, grp_id_train, X_test, Y_test, grp_id_test, coef</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.squared_dist">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">squared_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#squared_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.squared_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>compute sum((x-z) ** 2) for all vectors in a 2d array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.threshold_NPM">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">threshold_NPM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NPMs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdr_thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npm_thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#threshold_NPM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.threshold_NPM" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute voxels with significant NPMs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.unravel_2D">
<span class="sig-prename descclassname"><span class="pre">utils.</span></span><span class="sig-name descname"><span class="pre">unravel_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#unravel_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.unravel_2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="index.html" class="btn btn-neutral float-left" title="Predictive Clinical Neuroscience toolkit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Andre F. Marquand.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>