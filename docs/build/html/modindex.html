

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Module Index &#8212; Predictive Clinical Neuroscience Toolkit 0.17 documentation</title>
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Predictive Clinical Neuroscience toolkit" href="index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Predictive Clinical Neuroscience toolkit"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Predictive Clinical Neuroscience Toolkit 0.17 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Module Index</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-bayesreg">
<span id="module-index"></span><h1>Module Index<a class="headerlink" href="#module-bayesreg" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="bayesreg.BLR">
<em class="property">class </em><code class="sig-prename descclassname">bayesreg.</code><code class="sig-name descname">BLR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_iter</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">var_groups</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">warp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bayesian linear regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">BLR</span><span class="p">()</span>
<span class="n">hyp</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">hyp0</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ys</span><span class="p">,</span><span class="n">s2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">hyp</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Xs</span><span class="p">)</span>
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hyp</span> <span class="o">=</span> <span class="p">(</span> <span class="n">log</span><span class="p">(</span><span class="n">beta</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="p">)</span>  <span class="c1"># hyp is a list or numpy array</span>
</pre></div>
</div>
<p>The implementation and notation mostly follows Bishop (2006).
The hyperparameter beta is the noise precision and alpha is the precision
over lengthscale parameters. This can be either a scalar variable (a
common lengthscale for all input variables), or a vector of length D (a
different lengthscale for each input variable, derived using an automatic
relevance determination formulation). These are estimated using conjugate
gradient optimisation of the marginal likelihood.</p>
<p>Reference:
Bishop (2006) Pattern Recognition and Machine Learning, Springer</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt id="bayesreg.BLR.dloglik">
<code class="sig-name descname">dloglik</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.dloglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt id="bayesreg.BLR.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp0</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">'cg'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt id="bayesreg.BLR.loglik">
<code class="sig-name descname">loglik</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.loglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt id="bayesreg.BLR.post">
<code class="sig-name descname">post</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma_a) and precision (Lambda_a).</p>
</dd></dl>

<dl class="py method">
<dt id="bayesreg.BLR.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">Xs</span></em>, <em class="sig-param"><span class="n">var_groups_test</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayesreg.html#BLR.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bayesreg.BLR.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-gp"></span><dl class="py class">
<dt id="gp.CovBase">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for covariance functions.</p>
<p>All covariance functions must define the following methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CovFunction</span><span class="o">.</span><span class="n">get_n_params</span><span class="p">()</span>
<span class="n">CovFunction</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
<span class="n">CovFunction</span><span class="o">.</span><span class="n">xcov</span><span class="p">()</span>
<span class="n">CovFunction</span><span class="o">.</span><span class="n">dcov</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="gp.CovBase.cov">
<em class="property">abstract </em><code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovBase.dcov">
<em class="property">abstract </em><code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">i</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovBase.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovBase.get_n_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovBase.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gp.CovLin">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovLin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovLin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Linear covariance function (no hyperparameters)</p>
<dl class="py method">
<dt id="gp.CovLin.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovLin.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovLin.dcov">
<code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">i</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovLin.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovLin.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovLin.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovLin.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gp.CovSqExp">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovSqExp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Ordinary squared exponential covariance function.
The hyperparameters are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="p">(</span> <span class="n">log</span><span class="p">(</span><span class="n">ell</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>where ell is a lengthscale parameter and sf2 is the signal variance</p>
<dl class="py method">
<dt id="gp.CovSqExp.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExp.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovSqExp.dcov">
<code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">i</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExp.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExp.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovSqExp.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExp.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gp.CovSqExpARD">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovSqExpARD</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExpARD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Squared exponential covariance function with ARD
The hyperparameters are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">ell_1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">log_ell_D</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">sf</span><span class="p">))</span>
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt id="gp.CovSqExpARD.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExpARD.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovSqExpARD.dcov">
<code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">i</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSqExpARD.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSqExpARD.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovSqExpARD.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSqExpARD.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gp.CovSum">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">CovSum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">covfuncnames</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gp.CovBase" title="gp.CovBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">gp.CovBase</span></code></a></p>
<p>Sum of covariance functions. These are passed in as a cell array and
intialised automatically. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">CovSum</span><span class="p">(</span><span class="n">x</span><span class="p">,(</span><span class="n">CovLin</span><span class="p">,</span> <span class="n">CovSqExpARD</span><span class="p">))</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">CovSum</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
<p>The hyperparameters are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="p">(</span> <span class="n">log</span><span class="p">(</span><span class="n">ell_1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">log_ell_D</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">sf2</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt id="gp.CovSum.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSum.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full covariance (or cross-covariance if z is given)</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovSum.dcov">
<code class="sig-name descname">dcov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">i</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#CovSum.dcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.CovSum.dcov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the covariance function with respect to
the i-th hyperparameter</p>
</dd></dl>

<dl class="py method">
<dt id="gp.CovSum.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gp.CovSum.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="gp.GPR">
<em class="property">class </em><code class="sig-prename descclassname">gp.</code><code class="sig-name descname">GPR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">covfunc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_iter</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">warp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gaussian process regression</p>
<p>Estimation and prediction of Gaussian process regression models</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">GPR</span><span class="p">()</span>
<span class="n">hyp</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">hyp0</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ys</span><span class="p">,</span> <span class="n">ys2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">hyp</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Xs</span><span class="p">)</span>
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters</p></li>
<li><p><strong>cov</strong> – covariance function</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hyp</span> <span class="o">=</span> <span class="p">(</span> <span class="n">log</span><span class="p">(</span><span class="n">sn</span><span class="p">),</span> <span class="p">(</span><span class="n">cov</span> <span class="n">function</span> <span class="n">params</span><span class="p">)</span> <span class="p">)</span>  <span class="c1"># hyp is a list or array</span>
</pre></div>
</div>
<p>The implementation and notation  follows Rasmussen and Williams (2006).
As in the gpml toolbox, these parameters are estimated using conjugate
gradient optimisation of the marginal likelihood. Note that there is no
explicit mean function, thus the gpr routines are limited to modelling
zero-mean processes.</p>
<p>Reference:
C. Rasmussen and C. Williams (2006) Gaussian Processes for Machine Learning</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt id="gp.GPR.dloglik">
<code class="sig-name descname">dloglik</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">covfunc</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.dloglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt id="gp.GPR.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp0</span></em>, <em class="sig-param"><span class="n">covfunc</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">'cg'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt id="gp.GPR.loglik">
<code class="sig-name descname">loglik</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">covfunc</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.loglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt id="gp.GPR.post">
<code class="sig-name descname">post</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">covfunc</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
</dd></dl>

<dl class="py method">
<dt id="gp.GPR.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">Xs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gp.html#GPR.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gp.GPR.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-normative"></span><dl class="py function">
<dt id="normative.estimate">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">covfile</span></em>, <em class="sig-param"><span class="n">respfile</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate a normative model</p>
<p>This will estimate a model in one of two settings according to theparticular parameters specified (see below)</p>
<ul class="simple">
<li><p>under k-fold cross-validation.
requires respfile, covfile and cvfolds&gt;=2</p></li>
<li><p>estimating a training dataset then applying to a second test dataset.
requires respfile, covfile, testcov and testresp.</p></li>
<li><p>estimating on a training dataset ouput of forward maps mean and se. 
requires respfile, covfile and testcov</p></li>
</ul>
<p>The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (nifti or cifti). Ascii data should be in
tab or space delimited format with the number of subjects in rows and the
number of variables in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimate</span><span class="p">(</span><span class="n">covfile</span><span class="p">,</span> <span class="n">respfile</span><span class="p">,</span> <span class="p">[</span><span class="n">extra_arguments</span><span class="p">])</span>
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>respfile</strong> – response variables for the normative model</p></li>
<li><p><strong>covfile</strong> – covariates used to predict the response variable</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>cvfolds</strong> – Number of cross-validation folds</p></li>
<li><p><strong>testcov</strong> – Test covariates</p></li>
<li><p><strong>testresp</strong> – Test responses</p></li>
<li><p><strong>alg</strong> – Algorithm for normative model</p></li>
<li><p><strong>configparam</strong> – Parameters controlling the estimation algorithm</p></li>
<li><p><strong>saveoutput</strong> – Save the output to disk? Otherwise returned as arrays</p></li>
<li><p><strong>outputsuffix</strong> – Text string to add to the output filenames</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>yhat - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
<li><p>nm - normative model</p></li>
<li><p>Z - deviance scores</p></li>
<li><p>Rho - Pearson correlation between true and predicted responses</p></li>
<li><p>pRho - parametric p-value for this correlation</p></li>
<li><p>rmse - root mean squared error between true/predicted responses</p></li>
<li><p>smse - standardised mean squared error</p></li>
</ul>
</dd>
</dl>
<p>The outputsuffix may be useful to estimate multiple normative models in the
same directory (e.g. for custom cross-validation schemes)</p>
</dd></dl>

<dl class="py function">
<dt id="normative.evaluate">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Y</span></em>, <em class="sig-param"><span class="n">Yhat</span></em>, <em class="sig-param"><span class="n">S2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mY</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sY</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metrics</span><span class="o">=</span><span class="default_value">['Rho', 'RMSE', 'SMSE', 'EXPV', 'MSLL']</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute error metrics
This function will compute error metrics based on a set of predictions Yhat
and a set of true response variables Y, namely:</p>
<ul class="simple">
<li><p>Rho: Pearson correlation</p></li>
<li><p>RMSE: root mean squared error</p></li>
<li><p>SMSE: standardized mean squared error</p></li>
<li><p>EXPV: explained variance</p></li>
</ul>
<p>If the predictive variance is also specified the log loss will be computed
(which also takes into account the predictive variance). If the mean and 
standard deviation are also specified these will be used to standardize 
this, yielding the mean standardized log loss</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y</strong> – N x P array of true response variables</p></li>
<li><p><strong>Yhat</strong> – N x P array of predicted response variables</p></li>
<li><p><strong>S2</strong> – predictive variance</p></li>
<li><p><strong>mY</strong> – mean of the training set</p></li>
<li><p><strong>sY</strong> – standard deviation of the training set</p></li>
</ul>
</dd>
<dt class="field-even">Returns metrics</dt>
<dd class="field-even"><p>evaluation metrics</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="normative.extend">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">extend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">covfile</span></em>, <em class="sig-param"><span class="n">respfile</span></em>, <em class="sig-param"><span class="n">maskfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#extend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.extend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="normative.fit">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">covfile</span></em>, <em class="sig-param"><span class="n">respfile</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="normative.get_args">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">get_args</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.get_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse command line arguments</p>
</dd></dl>

<dl class="py function">
<dt id="normative.load_response_vars">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">load_response_vars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">datafile</span></em>, <em class="sig-param"><span class="n">maskfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vol</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#load_response_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.load_response_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>load response variables (of any data type)</p>
</dd></dl>

<dl class="py function">
<dt id="normative.main">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse arguments and estimate model</p>
</dd></dl>

<dl class="py function">
<dt id="normative.predict">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">covfile</span></em>, <em class="sig-param"><span class="n">respfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">maskfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make predictions on the basis of a pre-estimated normative model 
If only the covariates are specified then only predicted mean and variance 
will be returned. If the test responses are also specified then quantities
That depend on those will also be returned (Z scores and error metrics)</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">predict</span><span class="p">(</span><span class="n">covfile</span><span class="p">,</span> <span class="p">[</span><span class="n">extra_arguments</span><span class="p">])</span>
</pre></div>
</div>
<p>where the variables are defined below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covfile</strong> – test covariates used to predict the response variable</p></li>
<li><p><strong>respfile</strong> – test response variables for the normative model</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>model_path</strong> – Directory containing the normative model and metadata.
When using parallel prediction, do not pass the model path. It will be automatically
decided.</p></li>
<li><p><strong>output_path</strong> – Directory to store the results</p></li>
<li><p><strong>outputsuffix</strong> – Text string to add to the output filenames</p></li>
<li><p><strong>batch_size</strong> – batch size (for use with normative_parallel)</p></li>
<li><p><strong>job_id</strong> – batch id</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>Yhat - predictive mean</p></li>
<li><p>S2 - predictive variance</p></li>
<li><p>Z - Z scores</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="normative.save_results">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">save_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">respfile</span></em>, <em class="sig-param"><span class="n">Yhat</span></em>, <em class="sig-param"><span class="n">S2</span></em>, <em class="sig-param"><span class="n">maskvol</span></em>, <em class="sig-param"><span class="n">Z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outputsuffix</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">results</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_path</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#save_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.save_results" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="normative.transfer">
<code class="sig-prename descclassname">normative.</code><code class="sig-name descname">transfer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">covfile</span></em>, <em class="sig-param"><span class="n">respfile</span></em>, <em class="sig-param"><span class="n">testcov</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">testresp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">maskfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative.html#transfer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative.transfer" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfer learning on the basis of a pre-estimated normative model by using 
the posterior distribution over the parameters as an informed prior for 
new data. currently only supported for HBR.</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">transfer</span><span class="p">(</span><span class="n">covfile</span><span class="p">,</span> <span class="n">respfile</span> <span class="p">[</span><span class="n">extra_arguments</span><span class="p">])</span>
</pre></div>
</div>
<p>where the variables are defined below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covfile</strong> – test covariates used to predict the response variable</p></li>
<li><p><strong>respfile</strong> – test response variables for the normative model</p></li>
<li><p><strong>maskfile</strong> – mask used to apply to the data (nifti only)</p></li>
<li><p><strong>testcov</strong> – Test covariates</p></li>
<li><p><strong>testresp</strong> – Test responses</p></li>
<li><p><strong>model_path</strong> – Directory containing the normative model and metadata</p></li>
<li><p><strong>trbefile</strong> – Training batch effects file</p></li>
<li><p><strong>batch_size</strong> – batch size (for use with normative_parallel)</p></li>
<li><p><strong>job_id</strong> – batch id</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>Yhat - predictive mean</p></li>
<li><p>S2 - predictive variance</p></li>
<li><p>Z - Z scores</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-normative_parallel"></span><dl class="py function">
<dt id="normative_parallel.bashwrap_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">bashwrap_nm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">processing_dir</span></em>, <em class="sig-param"><span class="n">python_path</span></em>, <em class="sig-param"><span class="n">normative_path</span></em>, <em class="sig-param"><span class="n">job_name</span></em>, <em class="sig-param"><span class="n">covfile_path</span></em>, <em class="sig-param"><span class="n">respfile_path</span></em>, <em class="sig-param"><span class="n">func</span><span class="o">=</span><span class="default_value">'estimate'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#bashwrap_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.bashwrap_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><p>normative_path     -&gt; Full path to the normative.py</p></li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><p>alg                -&gt; which algorithm to use</p></li>
<li><p>configparam        -&gt; configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><ul class="simple">
<li><p>A bash.sh file containing the commands for normative modelling saved
to the processing directory (written to disk)</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers</p>
</dd></dl>

<dl class="py function">
<dt id="normative_parallel.collect_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">collect_nm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">processing_dir</span></em>, <em class="sig-param"><span class="n">job_name</span></em>, <em class="sig-param"><span class="n">func</span><span class="o">=</span><span class="default_value">'estimate'</span></em>, <em class="sig-param"><span class="n">collect</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">binary</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outputsuffix</span><span class="o">=</span><span class="default_value">'_estimate'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#collect_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.collect_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function checks and collects all batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir        -&gt; Full path to the processing directory</p></li>
<li><dl class="simple">
<dt>collect               -&gt; If True data is checked for failed batches</dt><dd><p>and collected; if False data is just checked</p>
</dd>
</dl>
</li>
<li><p>binary                -&gt; Results in pkl format?</p></li>
</ul>
</dd>
<dt class="field-even">Ouptuts</dt>
<dd class="field-even"><ul class="simple">
<li><p>Text files containing all results accross all batches the combined
output (written to disk)</p></li>
<li><p>returns 0 if batches fail, 1 otherwise</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt id="normative_parallel.delete_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">delete_nm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">processing_dir</span></em>, <em class="sig-param"><span class="n">binary</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#delete_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.delete_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function deletes all processing for normative modelling and just
keeps the combined output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir        -&gt; Full path to the processing directory</p></li>
<li><p>binary                -&gt; Results in pkl format?</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt id="normative_parallel.execute_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">execute_nm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">processing_dir</span></em>, <em class="sig-param"><span class="n">python_path</span></em>, <em class="sig-param"><span class="n">job_name</span></em>, <em class="sig-param"><span class="n">covfile_path</span></em>, <em class="sig-param"><span class="n">respfile_path</span></em>, <em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">memory</span></em>, <em class="sig-param"><span class="n">duration</span></em>, <em class="sig-param"><span class="n">normative_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">func</span><span class="o">=</span><span class="default_value">'estimate'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#execute_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.execute_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is a mother function that executes all parallel normative
modelling routines. Different specifications are possible using the sub-
functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><dl class="simple">
<dt>normative_path     -&gt; Full path to the normative.py. If None (default)</dt><dd><p>then it will automatically retrieves the path from 
the installed packeage.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>batch_size         -&gt; Number of features in each batch</p></li>
<li><dl class="simple">
<dt>memory             -&gt; Memory requirements written as string</dt><dd><p>for example 4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duation            -&gt; The approximate duration of the job, a string</dt><dd><p>with HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><p>log_path           -&gt; Pathfor saving log files</p></li>
<li><dl class="simple">
<dt>binary             -&gt; If True uses binary format for response file</dt><dd><p>otherwise it is text</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt id="normative_parallel.qsub_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">qsub_nm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">job_path</span></em>, <em class="sig-param"><span class="n">log_path</span></em>, <em class="sig-param"><span class="n">memory</span></em>, <em class="sig-param"><span class="n">duration</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#qsub_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.qsub_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<dl class="simple">
<dt>** Input:</dt><dd><ul class="simple">
<li><p>job_path      -&gt; Full path to the job.sh file</p></li>
<li><dl class="simple">
<dt>memory        -&gt; Memory requirements written as string for example</dt><dd><p>4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duation       -&gt; The approximate duration of the job, a string with</dt><dd><p>HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>Submission of the job to the (torque) cluster</p></li>
</ul>
</dd>
</dl>
<p>witten by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt id="normative_parallel.rerun_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">rerun_nm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">processing_dir</span></em>, <em class="sig-param"><span class="n">log_path</span></em>, <em class="sig-param"><span class="n">memory</span></em>, <em class="sig-param"><span class="n">duration</span></em>, <em class="sig-param"><span class="n">binary</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#rerun_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.rerun_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function reruns all failed batched in processing_dir after collect_nm
has identified he failed batches</p>
<ul class="simple">
<li><dl class="simple">
<dt>Input:</dt><dd><ul>
<li><p>processing_dir        -&gt; Full path to the processing directory</p></li>
<li><dl class="simple">
<dt>memory                -&gt; Memory requirements written as string</dt><dd><p>for example 4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duration               -&gt; The approximate duration of the job, a</dt><dd><p>string with HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>written by (primarily) T Wolfers, (adapted) SM Kia</p>
</dd></dl>

<dl class="py function">
<dt id="normative_parallel.sbatch_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">sbatch_nm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">job_path</span></em>, <em class="sig-param"><span class="n">log_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#sbatch_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.sbatch_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<dl class="simple">
<dt>** Input:</dt><dd><ul class="simple">
<li><p>job_path      -&gt; Full path to the job.sh file</p></li>
<li><p>log_path      -&gt; The logs are currently stored in the working dir</p></li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>Submission of the job to the (torque) cluster</p></li>
</ul>
</dd>
</dl>
<p>witten by (primarily) T Wolfers</p>
</dd></dl>

<dl class="py function">
<dt id="normative_parallel.sbatchwrap_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">sbatchwrap_nm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">processing_dir</span></em>, <em class="sig-param"><span class="n">python_path</span></em>, <em class="sig-param"><span class="n">normative_path</span></em>, <em class="sig-param"><span class="n">job_name</span></em>, <em class="sig-param"><span class="n">covfile_path</span></em>, <em class="sig-param"><span class="n">respfile_path</span></em>, <em class="sig-param"><span class="n">memory</span></em>, <em class="sig-param"><span class="n">duration</span></em>, <em class="sig-param"><span class="n">func</span><span class="o">=</span><span class="default_value">'estimate'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#sbatchwrap_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.sbatchwrap_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir     -&gt; Full path to the processing dir</p></li>
<li><p>python_path        -&gt; Full path to the python distribution</p></li>
<li><p>normative_path     -&gt; Full path to the normative.py</p></li>
<li><dl class="simple">
<dt>job_name           -&gt; Name for the bash script that is the output of</dt><dd><p>this function</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>covfile_path       -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
responsefile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>respfile_path      -&gt; Full path to a .txt that contains all features</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>cv_folds           -&gt; Number of cross validations</p></li>
<li><dl class="simple">
<dt>testcovfile_path   -&gt; Full path to a .txt file that contains all</dt><dd><p>covariats (subjects x covariates) for the
testresponse file</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>testrespfile_path  -&gt; Full path to a .txt file that contains all</dt><dd><p>test features</p>
</dd>
</dl>
</li>
<li><p>alg                -&gt; which algorithm to use</p></li>
<li><p>configparam        -&gt; configuration parameters for this algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><ul class="simple">
<li><p>A bash.sh file containing the commands for normative modelling saved
to the processing directory (written to disk)</p></li>
</ul>
</dd>
</dl>
<p>written by (primarily) T Wolfers</p>
</dd></dl>

<dl class="py function">
<dt id="normative_parallel.split_nm">
<code class="sig-prename descclassname">normative_parallel.</code><code class="sig-name descname">split_nm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">processing_dir</span></em>, <em class="sig-param"><span class="n">respfile_path</span></em>, <em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">binary</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/normative_parallel.html#split_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#normative_parallel.split_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>This function prepares the input files for normative_parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>processing_dir    -&gt; Full path to the folder of processing</p></li>
<li><dl class="simple">
<dt>respfile_path     -&gt; Full path to the responsefile.txt</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>batch_size        -&gt; Number of features in each batch</p></li>
<li><dl class="simple">
<dt>testrespfile_path -&gt; Full path to the test responsefile.txt</dt><dd><p>(subjects x features)</p>
</dd>
</dl>
</li>
<li><p>binary            -&gt; If True binary file</p></li>
</ul>
</dd>
<dt class="field-even">Outputs</dt>
<dd class="field-even"><ul class="simple">
<li><p>The creation of a folder struture for batch-wise processing</p></li>
</ul>
</dd>
</dl>
<p>witten by (primarily) T Wolfers (adapted) SM Kia</p>
</dd></dl>

<span class="target" id="module-trendsurf"></span><dl class="py function">
<dt id="trendsurf.create_basis">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">create_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">basis</span></em>, <em class="sig-param"><span class="n">mask</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#create_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.create_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a (polynomial) basis set</p>
</dd></dl>

<dl class="py function">
<dt id="trendsurf.estimate">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">maskfile</span></em>, <em class="sig-param"><span class="n">basis</span></em>, <em class="sig-param"><span class="n">ard</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">outputall</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">saveoutput</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate a trend surface model</p>
<p>This will estimate a trend surface model, independently for each subject.
This is currently fit using a polynomial model of a specified degree.
The models are estimated on the basis of data stored on disk in ascii or
neuroimaging data formats (currently nifti only). Ascii data should be in
tab or space delimited format with the number of voxels in rows and the
number of subjects in columns. Neuroimaging data will be reshaped
into the appropriate format</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">estimate</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">maskfile</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
<p>where the variables are defined below. Note that either the cfolds
parameter or (testcov, testresp) should be specified, but not both.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – 4-d nifti file containing the images to be estimated</p></li>
<li><p><strong>maskfile</strong> – nifti mask used to apply to the data</p></li>
<li><p><strong>basis</strong> – model order for the interpolating polynomial</p></li>
</ul>
</dd>
</dl>
<p>All outputs are written to disk in the same format as the input. These are:</p>
<dl class="field-list simple">
<dt class="field-odd">Outputs</dt>
<dd class="field-odd"><ul class="simple">
<li><p>yhat - predictive mean</p></li>
<li><p>ys2 - predictive variance</p></li>
<li><p>trendcoeff - coefficients from the trend surface model</p></li>
<li><p>negloglik - Negative log marginal likelihood</p></li>
<li><p>hyp - hyperparameters</p></li>
<li><p>explainedvar - explained variance</p></li>
<li><p>rmse - standardised mean squared error</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="trendsurf.get_args">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">get_args</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.get_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="trendsurf.load_data">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">load_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">datafile</span></em>, <em class="sig-param"><span class="n">maskfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>load 4d nifti data</p>
</dd></dl>

<dl class="py function">
<dt id="trendsurf.main">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="trendsurf.write_nii">
<code class="sig-prename descclassname">trendsurf.</code><code class="sig-name descname">write_nii</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">examplenii</span></em>, <em class="sig-param"><span class="n">mask</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/trendsurf.html#write_nii"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#trendsurf.write_nii" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<span class="target" id="module-rfa"></span><dl class="py class">
<dt id="rfa.GPRRFA">
<em class="property">class </em><code class="sig-prename descclassname">rfa.</code><code class="sig-name descname">GPRRFA</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_feat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_iter</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Random Feature Approximation for Gaussian Process Regression</p>
<p>Estimation and prediction of Bayesian linear regression models</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">GPRRFA</span><span class="p">()</span>
<span class="n">hyp</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">hyp0</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ys</span><span class="p">,</span><span class="n">s2</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">hyp</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Xs</span><span class="p">)</span>
</pre></div>
</div>
<p>where the variables are</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyp</strong> – vector of hyperparmaters.</p></li>
<li><p><strong>X</strong> – N x D data array</p></li>
<li><p><strong>y</strong> – 1D Array of targets (length N)</p></li>
<li><p><strong>Xs</strong> – Nte x D array of test cases</p></li>
<li><p><strong>hyp0</strong> – starting estimates for hyperparameter optimisation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>ys - predictive mean</p></li>
<li><p>s2 - predictive variance</p></li>
</ul>
</p>
</dd>
</dl>
<p>The hyperparameters are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hyp</span> <span class="o">=</span> <span class="p">[</span> <span class="n">log</span><span class="p">(</span><span class="n">sn</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">ell</span><span class="p">),</span> <span class="n">log</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="p">]</span>  <span class="c1"># hyp is a numpy array</span>
</pre></div>
</div>
<p>where sn^2 is the noise variance, ell are lengthscale parameters and 
sf^2 is the signal variance. This provides an approximation to the
covariance function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="s1">&#39;*z + sn2*exp(0.5*(x-z)&#39;</span><span class="o">*</span><span class="n">Lambda</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
</pre></div>
</div>
<p>where Lambda = diag((ell_1^2, … ell_D^2))</p>
<p>Written by A. Marquand</p>
<dl class="py method">
<dt id="rfa.GPRRFA.dloglik">
<code class="sig-name descname">dloglik</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.dloglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.dloglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute derivatives</p>
</dd></dl>

<dl class="py method">
<dt id="rfa.GPRRFA.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp0</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">'lbfgs'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the model</p>
</dd></dl>

<dl class="py method">
<dt id="rfa.GPRRFA.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.get_n_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="rfa.GPRRFA.loglik">
<code class="sig-name descname">loglik</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.loglik"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.loglik" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute compute log (marginal) likelihood</p>
</dd></dl>

<dl class="py method">
<dt id="rfa.GPRRFA.post">
<code class="sig-name descname">post</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to compute posterior distribution.</p>
<p>This function will save the posterior mean and precision matrix as
self.m and self.A and will also update internal parameters (e.g.
N, D and the prior covariance (Sigma) and precision (iSigma).</p>
</dd></dl>

<dl class="py method">
<dt id="rfa.GPRRFA.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hyp</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">Xs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rfa.html#GPRRFA.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rfa.GPRRFA.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make predictions from the model</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-fileio"></span><dl class="py function">
<dt id="fileio.alphanum_key">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">alphanum_key</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#alphanum_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.alphanum_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.create_mask">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">create_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_array</span></em>, <em class="sig-param"><span class="n">mask</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#create_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.create_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.file_extension">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">file_extension</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_extension"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.file_extension" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.file_stem">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">file_stem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_stem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.file_stem" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.file_type">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">file_type</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#file_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.file_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.load">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">text</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">vol</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.load_ascii">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load_ascii</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_ascii"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load_ascii" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.load_cifti">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load_cifti</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">vol</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rmtmp</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_cifti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load_cifti" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.load_nifti">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load_nifti</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">datafile</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vol</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_nifti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load_nifti" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.load_pd">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">load_pd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#load_pd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.load_pd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.predictive_interval">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">predictive_interval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s2_forward</span></em>, <em class="sig-param"><span class="n">cov_forward</span></em>, <em class="sig-param"><span class="n">multiplicator</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#predictive_interval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.predictive_interval" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.save">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">example</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">text</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.save_ascii">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save_ascii</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_ascii"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save_ascii" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.save_cifti">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save_cifti</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">example</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vol</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">volatlas</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_cifti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save_cifti" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<dl class="py function">
<dt id="fileio.save_nifti">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save_nifti</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">examplenii</span></em>, <em class="sig-param"><span class="n">mask</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_nifti"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save_nifti" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to nifti</p>
</dd></dl>

<dl class="py function">
<dt id="fileio.save_pd">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">save_pd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#save_pd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.save_pd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.sort_nicely">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">sort_nicely</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">l</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#sort_nicely"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.sort_nicely" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.tryint">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">tryint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#tryint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.tryint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="fileio.vol2vec">
<code class="sig-prename descclassname">fileio.</code><code class="sig-name descname">vol2vec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dat</span></em>, <em class="sig-param"><span class="n">mask</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fileio.html#vol2vec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fileio.vol2vec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-utils"></span><dl class="py class">
<dt id="utils.CustomCV">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">CustomCV</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">train</span></em>, <em class="sig-param"><span class="n">test</span></em>, <em class="sig-param"><span class="n">X</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#CustomCV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.CustomCV" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Custom cross-validation approach. This function does not do much, it
merely provides a wrapper designed to be compatible with
scikit-learn (e.g. sklearn.model_selection…)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> – a list of indices of training splits (each itself a list)</p></li>
<li><p><strong>test</strong> – a list of indices of test splits (each itself a list)</p></li>
</ul>
</dd>
<dt class="field-even">Returns tr</dt>
<dd class="field-even"><p>Indices for training set</p>
</dd>
<dt class="field-odd">Returns te</dt>
<dd class="field-odd"><p>Indices for test set</p>
</dd>
</dl>
<dl class="py method">
<dt id="utils.CustomCV.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#CustomCV.split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.CustomCV.split" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="utils.FDR">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">FDR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p_values</span></em>, <em class="sig-param"><span class="n">alpha</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#FDR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.FDR" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the false discovery rate in all voxels for a subject.</p>
</dd></dl>

<dl class="py class">
<dt id="utils.WarpAffine">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpAffine</code><a class="reference internal" href="_modules/utils.html#WarpAffine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpAffine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Affine warp
y = a + b*x</p>
<dl class="py method">
<dt id="utils.WarpAffine.df">
<code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpAffine.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpAffine.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpAffine.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpAffine.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpAffine.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone 
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpAffine.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpAffine.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpAffine.invf">
<code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpAffine.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpAffine.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables 
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpAffine.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">s2</span></em>, <em class="sig-param"><span class="n">param</span></em>, <em class="sig-param"><span class="n">percentiles</span><span class="o">=</span><span class="default_value">[0.025, 0.975]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpAffine.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="utils.WarpBase">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpBase</code><a class="reference internal" href="_modules/utils.html#WarpBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for likelihood warping following:
Rios and Torab (2019) Compositionally-warped Gaussian processes
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0893608019301856">https://www.sciencedirect.com/science/article/pii/S0893608019301856</a></p>
<p>All Warps must define the following methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Warp</span><span class="o">.</span><span class="n">get_n_params</span><span class="p">()</span> <span class="o">-</span> <span class="k">return</span> <span class="n">number</span> <span class="n">of</span> <span class="n">parameters</span>
<span class="n">Warp</span><span class="o">.</span><span class="n">f</span><span class="p">()</span> <span class="o">-</span> <span class="n">warping</span> <span class="n">function</span> <span class="p">(</span><span class="n">Non</span><span class="o">-</span><span class="n">Gaussian</span> <span class="n">field</span> <span class="o">-&gt;</span> <span class="n">Gaussian</span><span class="p">)</span>
<span class="n">Warp</span><span class="o">.</span><span class="n">invf</span><span class="p">()</span> <span class="o">-</span> <span class="n">inverse</span> <span class="n">warp</span>
<span class="n">Warp</span><span class="o">.</span><span class="n">df</span><span class="p">()</span> <span class="o">-</span> <span class="n">derivatives</span>
<span class="n">Warp</span><span class="o">.</span><span class="n">warp_predictions</span><span class="p">()</span> <span class="o">-</span> <span class="n">compute</span> <span class="n">predictive</span> <span class="n">distribution</span>
</pre></div>
</div>
<dl class="py method">
<dt id="utils.WarpBase.df">
<em class="property">abstract </em><code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">param</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpBase.f">
<em class="property">abstract </em><code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">param</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone 
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpBase.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.get_n_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpBase.invf">
<em class="property">abstract </em><code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">param</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables 
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpBase.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">s2</span></em>, <em class="sig-param"><span class="n">param</span></em>, <em class="sig-param"><span class="n">percentiles</span><span class="o">=</span><span class="default_value">[0.025, 0.975]</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBase.warp_predictions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBase.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="utils.WarpBoxCox">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpBoxCox</code><a class="reference internal" href="_modules/utils.html#WarpBoxCox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBoxCox" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Box cox transform having a single parameter (lambda), i.e.</p>
<p>y = (sign(x) * abs(x) ** lamda - 1) / lambda</p>
<p>This follows the generalization in Bicken and Doksum (1981) JASA 76
and allows x to assume negative values.</p>
<dl class="py method">
<dt id="utils.WarpBoxCox.df">
<code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBoxCox.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBoxCox.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpBoxCox.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBoxCox.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBoxCox.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone 
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpBoxCox.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpBoxCox.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpBoxCox.invf">
<code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpBoxCox.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpBoxCox.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables 
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpBoxCox.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">s2</span></em>, <em class="sig-param"><span class="n">param</span></em>, <em class="sig-param"><span class="n">percentiles</span><span class="o">=</span><span class="default_value">[0.025, 0.975]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpBoxCox.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="utils.WarpCompose">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpCompose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">warpnames</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpCompose" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Composition of warps. These are passed in as an array and
intialised automatically. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">WarpCompose</span><span class="p">((</span><span class="s1">&#39;WarpBoxCox&#39;</span><span class="p">,</span> <span class="s1">&#39;WarpAffine&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>where ell_i are lengthscale parameters and sf2 is the signal variance</p>
<dl class="py method">
<dt id="utils.WarpCompose.df">
<code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">theta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpCompose.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpCompose.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">theta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpCompose.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone 
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpCompose.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpCompose.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpCompose.invf">
<code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">theta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpCompose.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpCompose.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables 
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpCompose.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">s2</span></em>, <em class="sig-param"><span class="n">param</span></em>, <em class="sig-param"><span class="n">percentiles</span><span class="o">=</span><span class="default_value">[0.025, 0.975]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpCompose.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="utils.WarpSinArcsinh">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">WarpSinArcsinh</code><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpSinArcsinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.WarpBase" title="utils.WarpBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.WarpBase</span></code></a></p>
<p>Sin-hyperbolic arcsin warp having two parameters (a, b) and defined by</p>
<p>y = sinh(b *  arcsinh(x) - a)</p>
<p>Using the parametrisation of Rios et al, Neural Networks 118 (2017)
where a controls skew and b controls kurtosis, such that:</p>
<blockquote>
<div><p>a = 0 : symmetric
a &gt; 0 : positive skew
a &lt; 0 : negative skew
b = 1 : mesokurtic
b &gt; 1 : leptokurtic
b &lt; 1 : platykurtic</p>
</div></blockquote>
<p>where b &gt; 0. However, it is more convenentent to use an alternative 
parameterisation, where</p>
<p>y = sinh(b * arcsinh(x) + epsilon * b)</p>
<p>and a = -epsilon*b</p>
<p>see Jones and Pewsey A (2009) Biometrika, 96 (4) (2009)</p>
<dl class="py method">
<dt id="utils.WarpSinArcsinh.df">
<code class="sig-name descname">df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh.df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpSinArcsinh.df" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the warp, dw(x)/dx</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpSinArcsinh.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpSinArcsinh.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping non-Gaussian respone 
variables to Gaussian variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpSinArcsinh.get_n_params">
<code class="sig-name descname">get_n_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpSinArcsinh.get_n_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the number of parameters required</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpSinArcsinh.invf">
<code class="sig-name descname">invf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#WarpSinArcsinh.invf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.WarpSinArcsinh.invf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the warping function (mapping Gaussian latent variables 
to non-Gaussian response variables)</p>
</dd></dl>

<dl class="py method">
<dt id="utils.WarpSinArcsinh.warp_predictions">
<code class="sig-name descname">warp_predictions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">s2</span></em>, <em class="sig-param"><span class="n">param</span></em>, <em class="sig-param"><span class="n">percentiles</span><span class="o">=</span><span class="default_value">[0.025, 0.975]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.WarpSinArcsinh.warp_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the warped predictions from a gaussian predictive
distribution, specifed by a mean (mu) and variance (s2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Gassian predictive mean</p></li>
<li><p><strong>s2</strong> – Predictive variance</p></li>
<li><p><strong>param</strong> – warping parameters</p></li>
<li><p><strong>percentiles</strong> – Desired percentiles of the warped likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>median - median of the predictive distribution</p></li>
<li><p>pred_interval - predictive interval(s)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="utils.bashwrap">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">bashwrap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">processing_dir</span></em>, <em class="sig-param"><span class="n">python_path</span></em>, <em class="sig-param"><span class="n">script_command</span></em>, <em class="sig-param"><span class="n">job_name</span></em>, <em class="sig-param"><span class="n">bash_environment</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#bashwrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.bashwrap" title="Permalink to this definition">¶</a></dt>
<dd><p>This function wraps normative modelling into a bash script to run it
on a torque cluster system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processing_dir</strong> – Full path to the processing dir</p></li>
<li><p><strong>python_path</strong> – Full path to the python distribution</p></li>
<li><p><strong>script_command</strong> – python command to execute</p></li>
<li><p><strong>job_name</strong> – Name for the bash script output by this function</p></li>
<li><p><strong>covfile_path</strong> – Full path to covariates</p></li>
<li><p><strong>respfile_path</strong> – Full path to response variables</p></li>
<li><p><strong>cv_folds</strong> – Number of cross validations</p></li>
<li><p><strong>testcovfile_path</strong> – Full path to test covariates</p></li>
<li><p><strong>testrespfile_path</strong> – Full path to tes responses</p></li>
<li><p><strong>bash_environment</strong> – A file containing enviornment specific commands</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A .sh file containing the commands for normative modelling</p>
</dd>
</dl>
<p>witten by Thomas Wolfers</p>
</dd></dl>

<dl class="py function">
<dt id="utils.calibration_error">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">calibration_error</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Y</span></em>, <em class="sig-param"><span class="n">m</span></em>, <em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">cal_levels</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#calibration_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.calibration_error" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="utils.compute_MSLL">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">compute_MSLL</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ytrue</span></em>, <em class="sig-param"><span class="n">ypred</span></em>, <em class="sig-param"><span class="n">ypred_var</span></em>, <em class="sig-param"><span class="n">train_mean</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">train_var</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_MSLL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compute_MSLL" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the MSLL or MLL (not standardized) if ‘train_mean’ and ‘train_var’ are None.</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MSLL</span> <span class="o">=</span> <span class="n">compute_MSLL</span><span class="p">(</span><span class="n">ytrue</span><span class="p">,</span> <span class="n">ypred</span><span class="p">,</span> <span class="n">ytrue_sig</span><span class="p">,</span> <span class="n">noise_variance</span><span class="p">,</span> <span class="n">train_mean</span><span class="p">,</span> <span class="n">train_var</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<dl class="simple">
<dt>:param ytrue<span class="classifier">n*p matrix of true values where n is the number of samples </span></dt><dd><p>and p is the number of features.</p>
</dd>
<dt>:param ypred<span class="classifier">n*p matrix of predicted values where n is the number of samples </span></dt><dd><p>and p is the number of features.</p>
</dd>
<dt>:param ypred_var<span class="classifier">n*p matrix of summed noise variances and prediction variances where n is the number of samples </span></dt><dd><p>and p is the number of features.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>train_mean</strong> – p dimensional vector of mean values of the training data for each feature.</p>
</dd>
</dl>
<p>:param train_var : p dimensional vector of covariances of the training data for each feature.</p>
<p>:returns loss    : p dimensional vector of MSLL or MLL for each feature.</p>
</dd></dl>

<dl class="py function">
<dt id="utils.compute_pearsonr">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">compute_pearsonr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span></em>, <em class="sig-param"><span class="n">B</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#compute_pearsonr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compute_pearsonr" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually computes the Pearson correlation between two matrices.</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">compute_pearsonr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – an N * M data array</p></li>
<li><p><strong>cov</strong> – an N * M array</p></li>
</ul>
</dd>
<dt class="field-even">Returns Rho</dt>
<dd class="field-even"><p>N dimensional vector of correlation coefficients</p>
</dd>
<dt class="field-odd">Returns ys2</dt>
<dd class="field-odd"><p>N dimensional vector of p-values</p>
</dd>
</dl>
<p>Notes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">function</span> <span class="ow">is</span> <span class="n">useful</span> <span class="n">when</span> <span class="n">M</span> <span class="ow">is</span> <span class="n">large</span> <span class="ow">and</span> <span class="n">only</span> <span class="n">the</span> <span class="n">diagonal</span> <span class="n">entries</span>
<span class="n">of</span> <span class="n">the</span> <span class="n">resulting</span> <span class="n">correlation</span> <span class="n">matrix</span> <span class="n">are</span> <span class="n">of</span> <span class="n">interest</span><span class="o">.</span> <span class="n">This</span> <span class="n">function</span>
<span class="n">does</span> <span class="ow">not</span> <span class="n">compute</span> <span class="n">the</span> <span class="n">full</span> <span class="n">correlation</span> <span class="n">matrix</span> <span class="k">as</span> <span class="n">an</span> <span class="n">intermediate</span> <span class="n">step</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="utils.create_bspline_basis">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">create_bspline_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xmin</span></em>, <em class="sig-param"><span class="n">xmax</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">nknots</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_bspline_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.create_bspline_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a Bspline basis set where:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – order of spline (3 = cubic)</p></li>
<li><p><strong>nknots</strong> – number of knots (endpoints only counted once)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="utils.create_poly_basis">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">create_poly_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">dimpoly</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#create_poly_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.create_poly_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a polynomial basis expansion of the specified order</p>
</dd></dl>

<dl class="py function">
<dt id="utils.divergence_plot">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">divergence_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nm</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#divergence_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.divergence_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="utils.explained_var">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">explained_var</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ytrue</span></em>, <em class="sig-param"><span class="n">ypred</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#explained_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.explained_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the explained variance of predicted values.</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">exp_var</span> <span class="o">=</span> <span class="n">explained_var</span><span class="p">(</span><span class="n">ytrue</span><span class="p">,</span> <span class="n">ypred</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<dl class="field-list simple">
<dt class="field-odd">Ytrue</dt>
<dd class="field-odd"><p>n*p matrix of true values where n is the number of samples 
and p is the number of features.</p>
</dd>
<dt class="field-even">Ypred</dt>
<dd class="field-even"><p>n*p matrix of predicted values where n is the number of samples 
and p is the number of features.</p>
</dd>
<dt class="field-odd">Returns exp_var</dt>
<dd class="field-odd"><p>p dimentional vector of explained variances for each feature.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="utils.extreme_value_prob">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">extreme_value_prob</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">NPM</span></em>, <em class="sig-param"><span class="n">perc</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#extreme_value_prob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.extreme_value_prob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="utils.extreme_value_prob_fit">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">extreme_value_prob_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">NPM</span></em>, <em class="sig-param"><span class="n">perc</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#extreme_value_prob_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.extreme_value_prob_fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="utils.load_freesurfer_measure">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">load_freesurfer_measure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">measure</span></em>, <em class="sig-param"><span class="n">data_path</span></em>, <em class="sig-param"><span class="n">subjects_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#load_freesurfer_measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.load_freesurfer_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a utility function to load different Freesurfer measures in a pandas
Dataframe.</p>
<dl>
<dt>Inputs:</dt><dd><ul class="simple">
<li><p>measure: a string that defines the type of Freesurfer measure we want</p></li>
</ul>
<dl class="simple">
<dt>to load. The options include:</dt><dd><ul class="simple">
<li><p>‘NumVert’: Number of Vertices in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘SurfArea: Surface area for each cortical area based on Destrieux atlas.</p></li>
<li><p>‘GrayVol’: Gary matter volume in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘ThickAvg’: Average Cortical thinckness in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘ThickStd’: STD of Cortical thinckness in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘MeanCurv’: Integrated Rectified Mean Curvature in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘GausCurv’: Integrated Rectified Gaussian Curvature in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘FoldInd’: Folding Index in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘CurvInd’: Intrinsic Curvature Index in each cortical area based on Destrieux atlas.</p></li>
<li><p>‘brain’: Brain Segmentation Statistics from aseg.stats file.</p></li>
<li><p>‘subcortical_volumes’: Subcortical areas volume.</p></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li><p>data_path: a string that specifies the path to the main Freesurfer folder.</p></li>
<li><p>subjects_list: A Pythin list containing the list of subject names to load the data for.</p></li>
</ul>
<p>The subject names should match the folder name for each subject’s Freesurfer data folder.</p>
</dd>
<dt>Outputs:</dt><dd><ul class="simple">
<li><p>df: A pandas datafrmae containing the subject names as Index and target Freesurfer measures.</p></li>
<li><p>missing_subs: A Python list of subject names that miss the target Freesurefr measures.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="utils.qsub">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">qsub</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">job_path</span></em>, <em class="sig-param"><span class="n">memory</span></em>, <em class="sig-param"><span class="n">duration</span></em>, <em class="sig-param"><span class="n">logdir</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#qsub"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.qsub" title="Permalink to this definition">¶</a></dt>
<dd><p>This function submits a job.sh scipt to the torque custer using the qsub
command.</p>
<dl class="simple">
<dt>** Input:</dt><dd><ul class="simple">
<li><p>job_path      -&gt; Full path to the job.sh file</p></li>
<li><dl class="simple">
<dt>memory        -&gt; Memory requirements written as string for example</dt><dd><p>4gb or 500mb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>duration       -&gt; The approximate duration of the job, a string with</dt><dd><p>HH:MM:SS for example 01:01:01</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>** Output:</dt><dd><ul class="simple">
<li><p>Submission of the job to the (torque) cluster</p></li>
</ul>
</dd>
</dl>
<p>witten by Thomas Wolfers</p>
</dd></dl>

<dl class="py function">
<dt id="utils.ravel_2D">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">ravel_2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#ravel_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.ravel_2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="utils.simulate_data">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">simulate_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'linear'</span></em>, <em class="sig-param"><span class="n">n_samples</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">n_features</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">n_grps</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">working_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">random_state</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">noise</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#simulate_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.simulate_data" title="Permalink to this definition">¶</a></dt>
<dd><p>This function simulates linear synthetic data for testing pcntoolkit methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> – simulate ‘linear’ or ‘non-linear’ function.</p></li>
<li><p><strong>n_samples</strong> – number of samples in each group of the training and test sets. 
If it is an int then the same sample number will be used for all groups. 
It can be also a list of size of n_grps that decides the number of samples 
in each group (default=100).</p></li>
<li><p><strong>n_features</strong> – A positive integer that decides the number of features 
(default=1).</p></li>
<li><p><strong>n_grps</strong> – A positive integer that decides the number of groups in data
(default=1).</p></li>
<li><p><strong>working_dir</strong> – Directory to save data (default=None).</p></li>
<li><p><strong>plot</strong> – Boolean to plot the simulated training data (default=False).</p></li>
<li><p><strong>random_state</strong> – random state for generating random numbers (Default=None).</p></li>
<li><p><strong>noise</strong> – Type of added noise to the data. The options are ‘gaussian’, 
‘exponential’, and ‘hetero_gaussian’ (The defauls is None.).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X_train, Y_train, grp_id_train, X_test, Y_test, grp_id_test, coef</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="utils.squared_dist">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">squared_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#squared_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.squared_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>compute sum((x-z) ** 2) for all vectors in a 2d array</p>
</dd></dl>

<dl class="py function">
<dt id="utils.threshold_NPM">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">threshold_NPM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">NPMs</span></em>, <em class="sig-param"><span class="n">fdr_thr</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">npm_thr</span><span class="o">=</span><span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#threshold_NPM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.threshold_NPM" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute voxels with significant NPMs.</p>
</dd></dl>

<dl class="py function">
<dt id="utils.unravel_2D">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">unravel_2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils.html#unravel_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.unravel_2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Predictive Clinical Neuroscience toolkit</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/modindex.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Predictive Clinical Neuroscience toolkit"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Predictive Clinical Neuroscience Toolkit 0.17 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Module Index</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Andre F. Marquand.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>